{"ast":null,"code":"import _toConsumableArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{NitroRectangle,TextureUtils}from'@nitrots/nitro-renderer';import{useCallback,useRef}from'react';import{GetRoomEngine,GetRoomSession,LocalizeText,NotificationUtilities,PlaySound,SoundNames}from'../../../../api';import{Column,DraggableWindow,Flex}from'../../../../common';import{useCameraWidgetContext}from'../../CameraWidgetContext';import{CameraPicture}from'../../common/CameraPicture';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CAMERA_ROLL_LIMIT=5;export var CameraWidgetCaptureView=function CameraWidgetCaptureView(props){var _props$onClose=props.onClose,onClose=_props$onClose===void 0?null:_props$onClose,_props$onEdit=props.onEdit,onEdit=_props$onEdit===void 0?null:_props$onEdit,_props$onDelete=props.onDelete,onDelete=_props$onDelete===void 0?null:_props$onDelete;var _useCameraWidgetConte=useCameraWidgetContext(),_useCameraWidgetConte2=_useCameraWidgetConte.cameraRoll,cameraRoll=_useCameraWidgetConte2===void 0?null:_useCameraWidgetConte2,_useCameraWidgetConte3=_useCameraWidgetConte.setCameraRoll,setCameraRoll=_useCameraWidgetConte3===void 0?null:_useCameraWidgetConte3,_useCameraWidgetConte4=_useCameraWidgetConte.selectedPictureIndex,selectedPictureIndex=_useCameraWidgetConte4===void 0?-1:_useCameraWidgetConte4,_useCameraWidgetConte5=_useCameraWidgetConte.setSelectedPictureIndex,setSelectedPictureIndex=_useCameraWidgetConte5===void 0?null:_useCameraWidgetConte5;var elementRef=useRef();var selectedPicture=selectedPictureIndex>-1?cameraRoll[selectedPictureIndex]:null;var getCameraBounds=useCallback(function(){if(!elementRef||!elementRef.current)return null;var frameBounds=elementRef.current.getBoundingClientRect();return new NitroRectangle(Math.floor(frameBounds.x),Math.floor(frameBounds.y),Math.floor(frameBounds.width),Math.floor(frameBounds.height));},[]);var takePicture=useCallback(function(){if(selectedPictureIndex>-1){setSelectedPictureIndex(-1);return;}var texture=GetRoomEngine().createTextureFromRoom(GetRoomSession().roomId,1,getCameraBounds());var clone=_toConsumableArray(cameraRoll);if(clone.length>=CAMERA_ROLL_LIMIT){NotificationUtilities.simpleAlert(LocalizeText('camera.full.body'));clone.pop();}PlaySound(SoundNames.CAMERA_SHUTTER);clone.push(new CameraPicture(texture,TextureUtils.generateImageUrl(texture)));setCameraRoll(clone);},[cameraRoll,selectedPictureIndex,getCameraBounds,setCameraRoll,setSelectedPictureIndex]);return/*#__PURE__*/_jsx(DraggableWindow,{uniqueKey:\"nitro-camera-capture\",children:/*#__PURE__*/_jsxs(Column,{center:true,className:\"nitro-camera-capture\",gap:0,children:[selectedPicture&&/*#__PURE__*/_jsx(\"img\",{alt:\"\",className:\"camera-area\",src:selectedPicture.imageUrl}),/*#__PURE__*/_jsxs(\"div\",{className:\"camera-canvas drag-handler\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute header-close\",onClick:onClose,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\"})}),!selectedPicture&&/*#__PURE__*/_jsx(\"div\",{ref:elementRef,className:\"camera-area camera-view-finder\"}),selectedPicture&&/*#__PURE__*/_jsx(\"div\",{className:\"camera-area camera-frame\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success me-3\",title:LocalizeText('camera.editor.button.tooltip'),onClick:onEdit,children:LocalizeText('camera.editor.button.text')}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:onDelete,children:LocalizeText('camera.delete.button.text')})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"camera-button\",title:LocalizeText('camera.take.photo.button.tooltip'),onClick:takePicture})})]}),cameraRoll.length>0&&/*#__PURE__*/_jsx(Flex,{gap:2,justifyContent:\"center\",className:\"camera-roll d-flex justify-content-center py-2\",children:cameraRoll.map(function(picture,index){return/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:picture.imageUrl,onClick:function onClick(event){return setSelectedPictureIndex(index);}},index);})})]})});};","map":null,"metadata":{},"sourceType":"module"}