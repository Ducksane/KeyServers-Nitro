{"ast":null,"code":"import _classCallCheck from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{Vector3d}from'../../../room/utils/Vector3d';export var LegacyWallGeometry=/*#__PURE__*/function(){function LegacyWallGeometry(){_classCallCheck(this,LegacyWallGeometry);this._isDisposed=void 0;this._scale=void 0;this._heightMap=void 0;this._width=void 0;this._height=void 0;this._floorHeight=void 0;this._isDisposed=false;this._scale=64;this._heightMap=[];this._width=0;this._height=0;this._floorHeight=0;}_createClass(LegacyWallGeometry,[{key:\"disposed\",get:function get(){return this._isDisposed;}},{key:\"scale\",get:function get(){return this._scale;},set:function set(k){this._scale=k;}},{key:\"dispose\",value:function dispose(){this.reset();this._isDisposed=true;}},{key:\"initialize\",value:function initialize(width,height,floorHeight){if(width<=this._width&&height<=this._height){this._width=width;this._height=height;this._floorHeight=floorHeight;return;}this.reset();var y=0;while(y<height){var heights=[];this._heightMap.push(heights);var x=0;while(x<width){heights.push(0);x++;}y++;}this._width=width;this._height=height;this._floorHeight=floorHeight;}},{key:\"reset\",value:function reset(){this._heightMap=[];}},{key:\"setHeight\",value:function setHeight(x,y,height){if(x<0||x>=this._width||y<0||y>=this._height)return false;var heightMap=this._heightMap[y];if(!heightMap)return false;heightMap[x]=height;return true;}},{key:\"getHeight\",value:function getHeight(x,y){if(x<0||x>=this._width||y<0||y>=this._height)return 0;var heightMap=this._heightMap[y];if(!heightMap)return 0;return heightMap[x];}},{key:\"getLocation\",value:function getLocation(k,_arg_2,_arg_3,_arg_4,_arg_5){var _local_12;var _local_6;var _local_7;if(k==0&&_arg_2==0){k=this._width;_arg_2=this._height;_local_12=Math.round(this.scale/10);if(_arg_5==LegacyWallGeometry.R){_local_7=this._width-1;while(_local_7>=0){_local_6=1;while(_local_6<this._height){if(this.getHeight(_local_7,_local_6)<=this._floorHeight){if(_local_6-1<_arg_2){k=_local_7;_arg_2=_local_6-1;}break;}_local_6++;}_local_7--;}_arg_4=_arg_4+(this.scale/4-_local_12/2);_arg_3=_arg_3+this.scale/2;}else{_local_6=this._height-1;while(_local_6>=0){_local_7=1;while(_local_7<this._width){if(this.getHeight(_local_7,_local_6)<=this._floorHeight){if(_local_7-1<k){k=_local_7-1;_arg_2=_local_6;}break;}_local_7++;}_local_6--;}_arg_4=_arg_4+(this.scale/4-_local_12/2);_arg_3=_arg_3-_local_12;}}var _local_8=k;var _local_9=_arg_2;var _local_10=this.getHeight(k,_arg_2);if(_arg_5==LegacyWallGeometry.R){_local_8=_local_8+(_arg_3/(this._scale/2)-0.5);_local_9=_local_9+0.5;_local_10=_local_10-(_arg_4-_arg_3/2)/(this._scale/2);}else{_local_9=_local_9+((this._scale/2-_arg_3)/(this._scale/2)-0.5);_local_8=_local_8+0.5;_local_10=_local_10-(_arg_4-(this._scale/2-_arg_3)/2)/(this._scale/2);}var _local_11=new Vector3d(_local_8,_local_9,_local_10);return _local_11;}},{key:\"getLocationOldFormat\",value:function getLocationOldFormat(k,_arg_2,_arg_3){var _local_4;var _local_5;var _local_6=0;var _local_7=0;_local_5=Math.ceil(k);_local_6=_local_5-k;var _local_8;var _local_9;var _local_11;var _local_12=0;_local_4=0;while(_local_4<this._width){if(_local_5>=0&&_local_5<this._height){if(this.getHeight(_local_4,_local_5)<=this._floorHeight){_local_8=_local_4-1;_local_9=_local_5;_local_7=_local_4;_arg_3=LegacyWallGeometry.L;break;}if(this.getHeight(_local_4,_local_5+1)<=this._floorHeight){_local_8=_local_4;_local_9=_local_5;_local_7=_local_9-k;_arg_3=LegacyWallGeometry.R;break;}}_local_5++;_local_4++;}var _local_10=this.scale/2*_local_6;var _local_13=-_local_7*this.scale/2;_local_13=_local_13+-_arg_2*18/32*this.scale/2;_local_12=this.getHeight(_local_8,_local_9);_local_11=_local_12*this.scale/2+_local_13;if(_arg_3==LegacyWallGeometry.R){_local_11=_local_11+_local_6*this.scale/4;}else{_local_11=_local_11+(1-_local_6)*this.scale/4;}return this.getLocation(_local_8,_local_9,_local_10,_local_11,_arg_3);}},{key:\"getOldLocation\",value:function getOldLocation(k,_arg_2){if(k==null){return null;}var _local_3=0;var _local_4=0;var _local_5=0;var _local_6=0;var _local_7='';var _local_8=0;if(_arg_2==90){_local_3=Math.floor(k.x-0.5);_local_4=Math.floor(k.y+0.5);_local_8=this.getHeight(_local_3,_local_4);_local_5=this._scale/2-(k.y-_local_4+0.5)*(this._scale/2);_local_6=(_local_8-k.z)*(this._scale/2)+(this._scale/2-_local_5)/2;_local_7=LegacyWallGeometry.L;}else{if(_arg_2==180){_local_3=Math.floor(k.x+0.5);_local_4=Math.floor(k.y-0.5);_local_8=this.getHeight(_local_3,_local_4);_local_5=(k.x+0.5-_local_3)*(this._scale/2);_local_6=(_local_8-k.z)*(this._scale/2)+_local_5/2;_local_7=LegacyWallGeometry.R;}else{return null;}}return[_local_3,_local_4,_local_5,_local_6,_local_7];}},{key:\"getOldLocationString\",value:function getOldLocationString(k,_arg_2){var _local_3=this.getOldLocation(k,_arg_2);if(_local_3==null){return null;}var _local_4=Math.trunc(_local_3[0]);var _local_5=Math.trunc(_local_3[1]);var _local_6=Math.trunc(_local_3[2]);var _local_7=Math.trunc(_local_3[3]);var _local_8=_local_3[4];var _local_9=':w='+_local_4+','+_local_5+' l='+_local_6+','+_local_7+' '+_local_8;return _local_9;}},{key:\"getDirection\",value:function getDirection(k){if(k==LegacyWallGeometry.R){return 180;}return 90;}},{key:\"getFloorAltitude\",value:function getFloorAltitude(k,_arg_2){var _local_3=this.getHeight(k,_arg_2);var _local_4=_local_3+1;return _local_3+(Math.trunc(this.getHeight(k-1,_arg_2-1))==_local_4||Math.trunc(this.getHeight(k,_arg_2-1))==_local_4||Math.trunc(this.getHeight(k+1,_arg_2-1))==_local_4||Math.trunc(this.getHeight(k-1,_arg_2))==_local_4||Math.trunc(this.getHeight(k+1,_arg_2))==_local_4||Math.trunc(this.getHeight(k-1,_arg_2+1))==_local_4||Math.trunc(this.getHeight(k,_arg_2+1))==_local_4||Math.trunc(this.getHeight(k+1,_arg_2+1))==_local_4?0.5:0);}},{key:\"isRoomTile\",value:function isRoomTile(k,_arg_2){return k>=0&&k<this._width&&_arg_2>=0&&_arg_2<this._height&&this._heightMap[_arg_2][k]>=0;}}]);return LegacyWallGeometry;}();LegacyWallGeometry.DEFAULT_SCALE=32;LegacyWallGeometry.L='l';LegacyWallGeometry.R='r';","map":null,"metadata":{},"sourceType":"module"}