{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _objectSpread from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{CanCreateRoomEventEvent,CantConnectMessageParser,FollowFriendMessageComposer,GenericErrorEvent,GetGuestRoomResultEvent,HabboWebTools,LegacyExternalInterface,NavigatorCategoriesComposer,NavigatorCategoriesEvent,NavigatorHomeRoomEvent,NavigatorMetadataEvent,NavigatorOpenRoomCreatorEvent,NavigatorSearchEvent,NavigatorSettingsComposer,RoomCreatedEvent,RoomDataParser,RoomDoorbellAcceptedEvent,RoomDoorbellEvent,RoomDoorbellRejectedEvent,RoomEnterErrorEvent,RoomEntryInfoMessageEvent,RoomForwardEvent,RoomInfoComposer,RoomScoreEvent,RoomSettingsUpdatedEvent,SecurityLevel,UserInfoEvent,UserPermissionsEvent}from'@nitrots/nitro-renderer';import{useCallback}from'react';import{CreateLinkEvent,CreateRoomSession,DoorStateType,GetConfiguration,GetSessionDataManager,LocalizeText,NotificationAlertType,NotificationUtilities,SendMessageComposer,TryVisitRoom,VisitDesktop}from'../../api';import{UseMessageEventHook}from'../../hooks';import{useNavigatorContext}from'./NavigatorContext';export var NavigatorMessageHandler=function NavigatorMessageHandler(props){var _useNavigatorContext=useNavigatorContext(),_useNavigatorContext$=_useNavigatorContext.setCategories,setCategories=_useNavigatorContext$===void 0?null:_useNavigatorContext$,_useNavigatorContext$2=_useNavigatorContext.setTopLevelContext,setTopLevelContext=_useNavigatorContext$2===void 0?null:_useNavigatorContext$2,_useNavigatorContext$3=_useNavigatorContext.topLevelContexts,topLevelContexts=_useNavigatorContext$3===void 0?null:_useNavigatorContext$3,_useNavigatorContext$4=_useNavigatorContext.setTopLevelContexts,setTopLevelContexts=_useNavigatorContext$4===void 0?null:_useNavigatorContext$4,_useNavigatorContext$5=_useNavigatorContext.setNavigatorData,setNavigatorData=_useNavigatorContext$5===void 0?null:_useNavigatorContext$5,_useNavigatorContext$6=_useNavigatorContext.setDoorData,setDoorData=_useNavigatorContext$6===void 0?null:_useNavigatorContext$6,_useNavigatorContext$7=_useNavigatorContext.setSearchResult,setSearchResult=_useNavigatorContext$7===void 0?null:_useNavigatorContext$7;var onRoomSettingsUpdatedEvent=useCallback(function(event){var parser=event.getParser();SendMessageComposer(new RoomInfoComposer(parser.roomId,false,false));},[]);UseMessageEventHook(RoomSettingsUpdatedEvent,onRoomSettingsUpdatedEvent);var onCanCreateRoomEventEvent=useCallback(function(event){var parser=event.getParser();if(parser.canCreate){// show room event cvreate\nreturn;}NotificationUtilities.simpleAlert(LocalizeText(\"navigator.cannotcreateevent.error.\".concat(parser.errorCode)),null,null,null,LocalizeText('navigator.cannotcreateevent.title'));},[]);UseMessageEventHook(CanCreateRoomEventEvent,onCanCreateRoomEventEvent);var onUserInfoEvent=useCallback(function(event){SendMessageComposer(new NavigatorCategoriesComposer());SendMessageComposer(new NavigatorSettingsComposer());},[]);var onUserPermissionsEvent=useCallback(function(event){var parser=event.getParser();setNavigatorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.eventMod=parser.securityLevel>=SecurityLevel.MODERATOR;newValue.roomPicker=parser.securityLevel>=SecurityLevel.COMMUNITY;return newValue;});},[setNavigatorData]);var onRoomForwardEvent=useCallback(function(event){var parser=event.getParser();TryVisitRoom(parser.roomId);},[]);var onRoomEntryInfoMessageEvent=useCallback(function(event){var parser=event.getParser();setNavigatorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.enteredGuestRoom=null;newValue.currentRoomOwner=parser.isOwner;newValue.currentRoomId=parser.roomId;return newValue;});// close room info\n// close room settings\n// close room filter\nSendMessageComposer(new RoomInfoComposer(parser.roomId,true,false));if(LegacyExternalInterface.available)LegacyExternalInterface.call('legacyTrack','navigator','private',[parser.roomId]);},[setNavigatorData]);var onGetGuestRoomResultEvent=useCallback(function(event){var parser=event.getParser();if(parser.roomEnter){setDoorData({roomInfo:null,state:DoorStateType.NONE});setNavigatorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.enteredGuestRoom=parser.data;newValue.currentRoomIsStaffPick=parser.staffPick;var isCreated=newValue.createdFlatId===parser.data.roomId;if(!isCreated&&parser.data.displayRoomEntryAd){if(GetConfiguration('roomenterad.habblet.enabled',false))HabboWebTools.openRoomEnterAd();}newValue.createdFlatId=0;if(newValue.enteredGuestRoom&&newValue.enteredGuestRoom.habboGroupId>0){// close event info\n}return newValue;});}else if(parser.roomForward){if(parser.data.ownerName!==GetSessionDataManager().userName&&!parser.isGroupMember){switch(parser.data.doorMode){case RoomDataParser.DOORBELL_STATE:setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.roomInfo=parser.data;newValue.state=DoorStateType.START_DOORBELL;return newValue;});return;case RoomDataParser.PASSWORD_STATE:setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.roomInfo=parser.data;newValue.state=DoorStateType.START_PASSWORD;return newValue;});return;}}if(parser.data.doorMode===RoomDataParser.NOOB_STATE&&!GetSessionDataManager().isAmbassador&&!GetSessionDataManager().isRealNoob&&!GetSessionDataManager().isModerator)return;CreateRoomSession(parser.data.roomId);}else{setNavigatorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.enteredGuestRoom=parser.data;newValue.currentRoomIsStaffPick=parser.staffPick;return newValue;});}},[setNavigatorData,setDoorData]);var onRoomScoreEvent=useCallback(function(event){var parser=event.getParser();setNavigatorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.currentRoomRating=parser.totalLikes;newValue.canRate=parser.canLike;return newValue;});},[setNavigatorData]);var onRoomDoorbellEvent=useCallback(function(event){var parser=event.getParser();if(!parser.userName||parser.userName.length===0){setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.state=DoorStateType.STATE_WAITING;return newValue;});}},[setDoorData]);var onRoomDoorbellAcceptedEvent=useCallback(function(event){var parser=event.getParser();if(!parser.userName||parser.userName.length===0){setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.state=DoorStateType.STATE_ACCEPTED;return newValue;});}},[setDoorData]);var onRoomDoorbellRejectedEvent=useCallback(function(event){var parser=event.getParser();if(!parser.userName||parser.userName.length===0){setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.state=DoorStateType.STATE_NO_ANSWER;return newValue;});}},[setDoorData]);var onGenericErrorEvent=useCallback(function(event){var parser=event.getParser();switch(parser.errorCode){case-100002:setDoorData(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.state=DoorStateType.STATE_WRONG_PASSWORD;return newValue;});return;case 4009:NotificationUtilities.simpleAlert(LocalizeText('navigator.alert.need.to.be.vip'),NotificationAlertType.DEFAULT,null,null,LocalizeText('generic.alert.title'));return;case 4010:NotificationUtilities.simpleAlert(LocalizeText('navigator.alert.invalid_room_name'),NotificationAlertType.DEFAULT,null,null,LocalizeText('generic.alert.title'));return;case 4011:NotificationUtilities.simpleAlert(LocalizeText('navigator.alert.cannot_perm_ban'),NotificationAlertType.DEFAULT,null,null,LocalizeText('generic.alert.title'));return;case 4013:NotificationUtilities.simpleAlert(LocalizeText('navigator.alert.room_in_maintenance'),NotificationAlertType.DEFAULT,null,null,LocalizeText('generic.alert.title'));return;}},[setDoorData]);var onNavigatorMetadataEvent=useCallback(function(event){var parser=event.getParser();setTopLevelContexts(parser.topLevelContexts);setTopLevelContext(parser.topLevelContexts.length?parser.topLevelContexts[0]:null);},[setTopLevelContexts,setTopLevelContext]);var onNavigatorSearchEvent=useCallback(function(event){var parser=event.getParser();setTopLevelContext(function(prevValue){var newValue=prevValue;if(!newValue)newValue=topLevelContexts&&topLevelContexts.length&&topLevelContexts[0]||null;if(!newValue)return null;if(parser.result.code!==newValue.code&&topLevelContexts&&topLevelContexts.length){var _iterator=_createForOfIteratorHelper(topLevelContexts),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var context=_step.value;if(context.code!==parser.result.code)continue;newValue=context;}}catch(err){_iterator.e(err);}finally{_iterator.f();}}var _iterator2=_createForOfIteratorHelper(topLevelContexts),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _context=_step2.value;if(_context.code!==parser.result.code)continue;newValue=_context;}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return newValue;});setSearchResult(parser.result);},[topLevelContexts,setTopLevelContext,setSearchResult]);var onNavigatorCategoriesEvent=useCallback(function(event){var parser=event.getParser();setCategories(parser.categories);},[setCategories]);var onRoomCreatedEvent=useCallback(function(event){var parser=event.getParser();CreateRoomSession(parser.roomId);},[]);var onNavigatorHomeRoomEvent=useCallback(function(event){var parser=event.getParser();var prevSettingsReceived=false;setNavigatorData(function(prevValue){prevSettingsReceived=prevValue.settingsReceived;var newValue=_objectSpread({},prevValue);newValue.homeRoomId=parser.homeRoomId;newValue.settingsReceived=true;return newValue;});if(prevSettingsReceived){// refresh room info window\nreturn;}var forwardType=-1;var forwardId=-1;if(GetConfiguration('friend.id')!==undefined&&parseInt(GetConfiguration('friend.id'))>0){forwardType=0;SendMessageComposer(new FollowFriendMessageComposer(parseInt(GetConfiguration('friend.id'))));}if(GetConfiguration('forward.type')!==undefined&&GetConfiguration('forward.id')!==undefined){forwardType=parseInt(GetConfiguration('forward.type'));forwardId=parseInt(GetConfiguration('forward.id'));}if(forwardType===2){TryVisitRoom(forwardId);}else if(forwardType===-1&&parser.roomIdToEnter>0){CreateLinkEvent('navigator/close');if(parser.roomIdToEnter!==parser.homeRoomId){CreateRoomSession(parser.roomIdToEnter);}else{CreateRoomSession(parser.homeRoomId);}}},[setNavigatorData]);var onRoomEnterErrorEvent=useCallback(function(event){var parser=event.getParser();switch(parser.reason){case CantConnectMessageParser.REASON_FULL:NotificationUtilities.simpleAlert(LocalizeText('navigator.guestroomfull.text'),NotificationAlertType.DEFAULT,null,null,LocalizeText('navigator.guestroomfull.title'));break;case CantConnectMessageParser.REASON_QUEUE_ERROR:NotificationUtilities.simpleAlert(LocalizeText(\"room.queue.error.\".concat(parser.parameter)),NotificationAlertType.DEFAULT,null,null,LocalizeText('room.queue.error.title'));break;case CantConnectMessageParser.REASON_BANNED:NotificationUtilities.simpleAlert(LocalizeText('navigator.banned.text'),NotificationAlertType.DEFAULT,null,null,LocalizeText('navigator.banned.title'));break;default:NotificationUtilities.simpleAlert(LocalizeText('room.queue.error.title'),NotificationAlertType.DEFAULT,null,null,LocalizeText('room.queue.error.title'));break;}VisitDesktop();},[]);var onRoomCreatorEvent=useCallback(function(event){CreateLinkEvent('navigator/show');},[]);UseMessageEventHook(UserInfoEvent,onUserInfoEvent);UseMessageEventHook(UserPermissionsEvent,onUserPermissionsEvent);UseMessageEventHook(RoomForwardEvent,onRoomForwardEvent);UseMessageEventHook(RoomEntryInfoMessageEvent,onRoomEntryInfoMessageEvent);UseMessageEventHook(GetGuestRoomResultEvent,onGetGuestRoomResultEvent);UseMessageEventHook(RoomScoreEvent,onRoomScoreEvent);UseMessageEventHook(RoomDoorbellEvent,onRoomDoorbellEvent);UseMessageEventHook(RoomDoorbellAcceptedEvent,onRoomDoorbellAcceptedEvent);UseMessageEventHook(RoomDoorbellRejectedEvent,onRoomDoorbellRejectedEvent);UseMessageEventHook(GenericErrorEvent,onGenericErrorEvent);UseMessageEventHook(NavigatorMetadataEvent,onNavigatorMetadataEvent);UseMessageEventHook(NavigatorSearchEvent,onNavigatorSearchEvent);UseMessageEventHook(NavigatorCategoriesEvent,onNavigatorCategoriesEvent);UseMessageEventHook(RoomCreatedEvent,onRoomCreatedEvent);UseMessageEventHook(NavigatorHomeRoomEvent,onNavigatorHomeRoomEvent);UseMessageEventHook(RoomEnterErrorEvent,onRoomEnterErrorEvent);UseMessageEventHook(NavigatorOpenRoomCreatorEvent,onRoomCreatorEvent);return null;};","map":null,"metadata":{},"sourceType":"module"}