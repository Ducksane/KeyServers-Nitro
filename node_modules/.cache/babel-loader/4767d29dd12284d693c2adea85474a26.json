{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{Texture}from'@pixi/core';import{Graphics}from'@pixi/graphics';import{Matrix,Point,Rectangle}from'@pixi/math';import{TextureUtils}from'../../../../../room/utils/TextureUtils';import{Vector3d}from'../../../../../room/utils/Vector3d';import{PlaneDrawingData}from'./PlaneDrawingData';import{RoomPlaneBitmapMask}from'./RoomPlaneBitmapMask';import{RoomPlaneRectangleMask}from'./RoomPlaneRectangleMask';import{RoomVisualization}from'./RoomVisualization';import{PlaneBitmapData}from'./utils/PlaneBitmapData';import{Randomizer}from'./utils/Randomizer';export var RoomPlane=/*#__PURE__*/function(){function RoomPlane(origin,location,leftSide,rightSide,type,usesMask,secondaryNormals,randomSeed){var textureOffsetX=arguments.length>8&&arguments[8]!==undefined?arguments[8]:0;var textureOffsetY=arguments.length>9&&arguments[9]!==undefined?arguments[9]:0;var textureMaxX=arguments.length>10&&arguments[10]!==undefined?arguments[10]:0;var textureMaxY=arguments.length>11&&arguments[11]!==undefined?arguments[11]:0;_classCallCheck(this,RoomPlane);this._disposed=void 0;this._randomSeed=void 0;this._origin=void 0;this._location=void 0;this._leftSide=void 0;this._rightSide=void 0;this._normal=void 0;this._secondaryNormals=void 0;this._geometryUpdateId=void 0;this._type=void 0;this._isVisible=void 0;this._bitmapTexture=void 0;this._bitmapData=void 0;this._hasTexture=void 0;this._offset=void 0;this._relativeDepth=void 0;this._color=void 0;this._rasterizer=void 0;this._maskManager=null;this._id=void 0;this._uniqueId=void 0;this._textureOffsetX=void 0;this._textureOffsetY=void 0;this._textureMaxX=void 0;this._textureMaxY=void 0;this._textures=void 0;this._activeTexture=void 0;this._useMask=void 0;this._bitmapMasks=void 0;this._rectangleMasks=void 0;this._maskChanged=void 0;this._maskBitmapData=void 0;this._bitmapMasksOld=void 0;this._rectangleMasksOld=void 0;this._cornerA=void 0;this._cornerB=void 0;this._cornerC=void 0;this._cornerD=void 0;this._width=0;this._height=0;this._canBeVisible=void 0;this._secondaryNormals=[];this._bitmapMasks=[];this._rectangleMasks=[];this._bitmapMasksOld=[];this._rectangleMasksOld=[];this._randomSeed=randomSeed;this._bitmapData=null;this._maskBitmapData=null;this._maskChanged=false;this._activeTexture=null;this._origin=new Vector3d();this._origin.assign(origin);this._location=new Vector3d();this._location.assign(location);this._leftSide=new Vector3d();this._leftSide.assign(leftSide);this._rightSide=new Vector3d();this._rightSide.assign(rightSide);this._normal=Vector3d.crossProduct(this._leftSide,this._rightSide);if(this._normal.length>0){this._normal.multiply(1/this._normal.length);}if(secondaryNormals!=null){var _iterator=_createForOfIteratorHelper(secondaryNormals),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var entry=_step.value;if(!entry)continue;var vector=new Vector3d();vector.assign(entry);this._secondaryNormals.push(vector);}}catch(err){_iterator.e(err);}finally{_iterator.f();}}this._disposed=false;this._isVisible=false;this._id=null;this._hasTexture=true;this._geometryUpdateId=-1;this._offset=new Point();this._relativeDepth=0;this._type=type;this._color=0;this._rasterizer=null;this._canBeVisible=true;this._textures=new Map();this._cornerA=new Vector3d();this._cornerB=new Vector3d();this._cornerC=new Vector3d();this._cornerD=new Vector3d();this._width=0;this._height=0;this._textureOffsetX=textureOffsetX;this._textureOffsetY=textureOffsetY;this._textureMaxX=textureMaxX;this._textureMaxY=textureMaxY;this._useMask=usesMask;this._uniqueId=++RoomPlane._uniqueIdCounter;}_createClass(RoomPlane,[{key:\"canBeVisible\",get:function get(){return this._canBeVisible;},set:function set(k){if(k!==this._canBeVisible){if(!this._canBeVisible)this.resetTextureCache();this._canBeVisible=k;}}},{key:\"bitmapData\",get:function get(){if(!this.visible||!this._bitmapData)return null;var texture=RoomVisualization.getTextureCache(this._bitmapData);if(!texture){texture=TextureUtils.generateTexture(this._bitmapData,new Rectangle(0,0,this._width,this._height));RoomVisualization.addTextureCache(this._bitmapData,texture);}return texture;}},{key:\"visible\",get:function get(){return this._isVisible&&this._canBeVisible;}},{key:\"offset\",get:function get(){return this._offset;}},{key:\"relativeDepth\",get:function get(){return this._relativeDepth;}},{key:\"color\",get:function get(){return this._color;},set:function set(k){this._color=k;}},{key:\"type\",get:function get(){return this._type;}},{key:\"leftSide\",get:function get(){return this._leftSide;}},{key:\"rightSide\",get:function get(){return this._rightSide;}},{key:\"location\",get:function get(){return this._location;}},{key:\"normal\",get:function get(){return this._normal;}},{key:\"hasTexture\",get:function get(){return this._hasTexture;},set:function set(k){this._hasTexture=k;}},{key:\"rasterizer\",set:function set(k){this._rasterizer=k;}},{key:\"maskManager\",set:function set(k){this._maskManager=k;}},{key:\"id\",set:function set(k){if(k===this._id)return;this.resetTextureCache();this._id=k;}},{key:\"uniqueId\",get:function get(){return this._uniqueId;}},{key:\"dispose\",value:function dispose(){if(this._bitmapData){this._bitmapData.destroy();this._bitmapData=null;}if(this._textures){var _iterator2=_createForOfIteratorHelper(this._textures.values()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var bitmap=_step2.value;if(!bitmap)continue;if(bitmap.bitmap)bitmap.bitmap.destroy();bitmap.dispose();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}this._textures=null;}this._activeTexture=null;this._location=null;this._origin=null;this._leftSide=null;this._rightSide=null;this._normal=null;this._rasterizer=null;this._cornerA=null;this._cornerB=null;this._cornerC=null;this._cornerD=null;this._bitmapMasks=null;this._rectangleMasks=null;if(this._maskBitmapData){this._maskBitmapData.destroy();this._maskBitmapData=null;}this._disposed=true;}},{key:\"copyBitmapData\",value:function copyBitmapData(k){if(!this.visible||!this._bitmapData||!k)return null;if(this._bitmapData.width!==k.width||this._bitmapData.height!==k.height)return null;//k.copyPixels(this._bitmapData, this._bitmapData.rect, RoomPlane.ZERO_POINT);\nreturn k;}},{key:\"cacheTexture\",value:function cacheTexture(k,_arg_2){var existing=this._textures.get(k);if(existing){this._textures.delete(k);existing.dispose();}this._activeTexture=_arg_2;this._textures.set(k,_arg_2);return true;}},{key:\"resetTextureCache\",value:function resetTextureCache(){var k=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this._textures&&this._textures.size){var _iterator3=_createForOfIteratorHelper(this._textures.values()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var bitmap=_step3.value;if(!bitmap)continue;bitmap.dispose();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}this._textures.clear();}this._activeTexture=null;}},{key:\"getTextureIdentifier\",value:function getTextureIdentifier(k){if(this._rasterizer)return this._rasterizer.getTextureIdentifier(k,this.normal);return k.toString();}},{key:\"needsNewTexture\",value:function needsNewTexture(k,_arg_2){if(!k)return false;var planeBitmap=this._activeTexture;if(!planeBitmap){planeBitmap=this._textures.get(this.getTextureIdentifier(k.scale));}this.updateMaskChangeStatus();if(this._canBeVisible&&(!planeBitmap||planeBitmap.timeStamp>=0&&_arg_2>planeBitmap.timeStamp||this._maskChanged))return true;return false;}},{key:\"getTexture\",value:function getTexture(k,_arg_2){if(!k)return null;var _local_3=null;if(this.needsNewTexture(k,_arg_2)){var _local_4=this.getTextureIdentifier(k.scale);var _local_5=this._leftSide.length*k.scale;var _local_6=this._rightSide.length*k.scale;var _local_7=k.getCoordinatePosition(this._normal);if(this._activeTexture){_local_3=this._activeTexture;}else{_local_3=this._textures.get(_local_4);}var _local_8=null;if(_local_3)_local_8=_local_3.bitmap;if(this._rasterizer){_local_3=this._rasterizer.render(_local_8,this._id,_local_5,_local_6,k.scale,_local_7,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,_arg_2);if(_local_3){if(_local_8&&_local_3.bitmap!==_local_8)_local_8.destroy();}}else{var _local_9=new Graphics();_local_9.beginFill(0xFFFFFF);_local_9.drawRect(0,0,_local_5,_local_6);_local_9.endFill();_local_3=new PlaneBitmapData(_local_9,-1);}if(_local_3){this.updateMask(_local_3.bitmap,k);this.cacheTexture(_local_4,_local_3);}}else{if(this._activeTexture){_local_3=this._activeTexture;}else{_local_3=this._textures.get(this.getTextureIdentifier(k.scale));}}if(_local_3){this._activeTexture=_local_3;return _local_3.bitmap;}return null;}},{key:\"resolveMasks\",value:function resolveMasks(k){if(!this._useMask)return null;var _local_5=new PlaneDrawingData();var index=0;while(index<this._bitmapMasks.length){var mask=this._bitmapMasks[index];if(mask){var planeMask=this._maskManager.getMask(mask.type);if(planeMask){var assetName=planeMask.getAssetName(k.scale);if(assetName){var position=k.getCoordinatePosition(this._normal);var asset=planeMask.getGraphicAsset(k.scale,position);if(asset){var _local_3=this._maskBitmapData.width*(1-mask.leftSideLoc/this._leftSide.length);var _local_4=this._maskBitmapData.height*(1-mask.rightSideLoc/this._rightSide.length);var _local_11=new Point(_local_3+asset.offsetX,_local_4+asset.offsetY);_local_5.addMask(assetName,_local_11,asset.flipH,asset.flipV);}}}}}return _local_5;}},{key:\"screenWidth\",value:function screenWidth(k){var _local_2=k.getScreenPoint(new Vector3d(0,0,0));var _local_3=k.getScreenPoint(new Vector3d(0,1,0));return Math.round(this._leftSide.length*Math.abs(_local_2.x-_local_3.x));}},{key:\"getDrawingDatas\",value:function getDrawingDatas(geometry){var drawingDatas=[];if(this._isVisible){var maskData=this.resolveMasks(geometry);var layers=this._rasterizer.getLayers(this._id);var i=0;while(i<layers.length){var layer=layers[i];if(layer){if(this._hasTexture&&layer.getMaterial()){var normal=geometry.getCoordinatePosition(this._normal);var cm=layer.getMaterial().getMaterialCellMatrix(normal);//const data      = new PlaneDrawingData(maskData, blend(this._color, layer.getColor()), cm.isBottomAligned());\nvar data=new PlaneDrawingData(maskData,this._color,cm.isBottomAligned());Randomizer.setSeed(this._randomSeed);var _iterator4=_createForOfIteratorHelper(cm.getColumns(this.screenWidth(geometry))),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var column=_step4.value;var assetNames=[];var _iterator5=_createForOfIteratorHelper(column.getCells()),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var cell=_step5.value;var name=cell.getAssetName(normal);if(name)assetNames.push(name);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}if(assetNames.length>0){if(!column.isRepeated())assetNames.push('');data.addAssetColumn(assetNames);}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}if(data.assetNameColumns.length>0)drawingDatas.push(data);}else{//data = new PlaneDrawingData(maskData, blend(this._color, layer.getColor()));\nvar _data=new PlaneDrawingData(maskData,this._color);drawingDatas.push(_data);}}i++;}if(!drawingDatas.length)drawingDatas.push(new PlaneDrawingData(maskData,this._color));}return drawingDatas;}// private _Str_25956(k:PlaneBitmapData): void\n// {\n// }\n},{key:\"update\",value:function update(geometry,timeSinceStartMs){if(!geometry||this._disposed)return false;var geometryChanged=false;if(this._geometryUpdateId!=geometry.updateId)geometryChanged=true;if(!geometryChanged||!this._canBeVisible){if(!this.visible)return false;}if(geometryChanged){this._activeTexture=null;var cosAngle=0;cosAngle=Vector3d.cosAngle(geometry.directionAxis,this.normal);if(cosAngle>-0.001){if(this._isVisible){this._isVisible=false;return true;}return false;}var i=0;while(i<this._secondaryNormals.length){cosAngle=Vector3d.cosAngle(geometry.directionAxis,this._secondaryNormals[i]);if(cosAngle>-0.001){if(this._isVisible){this._isVisible=false;return true;}return false;}i++;}this.updateCorners(geometry);var originPos=geometry.getScreenPosition(this._origin);var originZ=originPos.z;var relativeDepth=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-originZ;if(this._type===RoomPlane.TYPE_FLOOR){relativeDepth=relativeDepth-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8;}if(this._type===RoomPlane.TYPE_LANDSCAPE){relativeDepth=relativeDepth+0.02;}this._relativeDepth=relativeDepth;this._isVisible=true;this._geometryUpdateId=geometry.updateId;}if(geometryChanged||this.needsNewTexture(geometry,timeSinceStartMs)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData){this._bitmapData.destroy();this._bitmapData=null;if(this._width<1||this._height<1)return true;}else{if(this._width<1||this._height<1)return false;}var graphic=new Graphics();graphic.beginFill(0xFFFFFF,0);graphic.drawRect(0,0,this._width,this._height);graphic.endFill();this._bitmapData=graphic;if(!this._bitmapData)return false;}else{//this._bitmapData.lock();\n//this._bitmapData.fillRect(this._bitmapData.rect, 0xFFFFFF);\n}Randomizer.setSeed(this._randomSeed);var texture=this.getTexture(geometry,timeSinceStartMs);if(texture){this.renderTexture(geometry,texture);}else{this.dispose();return false;}return texture!==null||geometryChanged;}return false;}},{key:\"updateCorners\",value:function updateCorners(k){this._cornerA.assign(k.getScreenPosition(this._location));this._cornerB.assign(k.getScreenPosition(Vector3d.sum(this._location,this._rightSide)));this._cornerC.assign(k.getScreenPosition(Vector3d.sum(Vector3d.sum(this._location,this._leftSide),this._rightSide)));this._cornerD.assign(k.getScreenPosition(Vector3d.sum(this._location,this._leftSide)));this._offset=k.getScreenPoint(this._origin);this._cornerA.x=Math.round(this._cornerA.x);this._cornerA.y=Math.round(this._cornerA.y);this._cornerB.x=Math.round(this._cornerB.x);this._cornerB.y=Math.round(this._cornerB.y);this._cornerC.x=Math.round(this._cornerC.x);this._cornerC.y=Math.round(this._cornerC.y);this._cornerD.x=Math.round(this._cornerD.x);this._cornerD.y=Math.round(this._cornerD.y);this._offset.x=Math.round(this._offset.x);this._offset.y=Math.round(this._offset.y);var _local_2=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x);var _local_3=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x);var _local_4=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y);var _local_5=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y);_local_3=_local_3-_local_2;this._offset.x=this._offset.x-_local_2;this._cornerA.x=this._cornerA.x-_local_2;this._cornerB.x=this._cornerB.x-_local_2;this._cornerC.x=this._cornerC.x-_local_2;this._cornerD.x=this._cornerD.x-_local_2;_local_5=_local_5-_local_4;this._offset.y=this._offset.y-_local_4;this._cornerA.y=this._cornerA.y-_local_4;this._cornerB.y=this._cornerB.y-_local_4;this._cornerC.y=this._cornerC.y-_local_4;this._cornerD.y=this._cornerD.y-_local_4;this._width=_local_3;this._height=_local_5;}},{key:\"renderTexture\",value:function renderTexture(k,_arg_2){if(this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||_arg_2==null||this._bitmapData==null){return;}var _local_3=this._cornerD.x-this._cornerC.x;var _local_4=this._cornerD.y-this._cornerC.y;var _local_5=this._cornerB.x-this._cornerC.x;var _local_6=this._cornerB.y-this._cornerC.y;if(this._type==RoomPlane.TYPE_WALL||this._type==RoomPlane.TYPE_LANDSCAPE){if(Math.abs(_local_5-_arg_2.width)<=1){_local_5=_arg_2.width;}if(Math.abs(_local_6-_arg_2.width)<=1){_local_6=_arg_2.width;}if(Math.abs(_local_3-_arg_2.height)<=1){_local_3=_arg_2.height;}if(Math.abs(_local_4-_arg_2.height)<=1){_local_4=_arg_2.height;}}var _local_7=_local_5/_arg_2.width;var _local_8=_local_6/_arg_2.width;var _local_9=_local_3/_arg_2.height;var _local_10=_local_4/_arg_2.height;var _local_11=new Matrix();_local_11.a=_local_7;_local_11.b=_local_8;_local_11.c=_local_9;_local_11.d=_local_10;_local_11.translate(this._cornerC.x,this._cornerC.y);this.draw(_arg_2,_local_11);}},{key:\"draw\",value:function draw(k,matrix){var clone=k.clone();clone.transform.setFromMatrix(matrix);this._bitmapData=clone;}},{key:\"resetBitmapMasks\",value:function resetBitmapMasks(){if(this._disposed||!this._useMask||!this._bitmapMasks.length)return;this._maskChanged=true;this._bitmapMasks=[];}},{key:\"addBitmapMask\",value:function addBitmapMask(k,_arg_2,_arg_3){if(!this._useMask)return false;var _local_5=0;while(_local_5<this._bitmapMasks.length){var _mask=this._bitmapMasks[_local_5];if(_mask){if(_mask.type===k&&_mask.leftSideLoc===_arg_2&&_mask.rightSideLoc===_arg_3)return false;}_local_5++;}var mask=new RoomPlaneBitmapMask(k,_arg_2,_arg_3);this._bitmapMasks.push(mask);this._maskChanged=true;return true;}},{key:\"resetRectangleMasks\",value:function resetRectangleMasks(){if(!this._useMask||!this._rectangleMasks.length)return;this._maskChanged=true;this._rectangleMasks=[];}},{key:\"addRectangleMask\",value:function addRectangleMask(k,_arg_2,_arg_3,_arg_4){if(this._useMask){var _iterator6=_createForOfIteratorHelper(this._rectangleMasks),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var mask=_step6.value;if(!mask)continue;if(mask.leftSideLoc===k&&mask.rightSideLoc===_arg_2&&mask.leftSideLength===_arg_3&&mask.rightSideLength===_arg_4)return false;}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}var _local_5=new RoomPlaneRectangleMask(k,_arg_2,_arg_3,_arg_4);this._rectangleMasks.push(_local_5);this._maskChanged=true;return true;}return false;}},{key:\"updateMaskChangeStatus\",value:function updateMaskChangeStatus(){if(!this._maskChanged)return;var _local_3=true;var _local_6;if(this._bitmapMasks.length===this._bitmapMasksOld.length){var _iterator7=_createForOfIteratorHelper(this._bitmapMasks),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var mask=_step7.value;if(!mask)continue;_local_6=false;var _iterator8=_createForOfIteratorHelper(this._bitmapMasksOld),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var plane=_step8.value;if(!plane)continue;if(plane.type===mask.type&&plane.leftSideLoc===mask.leftSideLoc&&plane.rightSideLoc===mask.rightSideLoc){_local_6=true;break;}}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}if(!_local_6){_local_3=false;break;}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}else{_local_3=false;}if(this._rectangleMasks.length>this._rectangleMasksOld.length)_local_3=false;if(_local_3)this._maskChanged=false;}},{key:\"updateMask\",value:function updateMask(texture,geometry){if(!texture||!geometry)return;if(!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;var width=texture.width;var height=texture.height;this.updateMaskChangeStatus();if(!this._maskBitmapData||this._maskBitmapData.width!==width||this._maskBitmapData.height!==height){if(this._maskBitmapData){this._maskBitmapData.destroy();this._maskBitmapData=null;}var graphic=new Graphics();graphic.beginFill(0xFFFFFF,0).drawRect(0,0,width,height).endFill();this._maskBitmapData=graphic;this._maskChanged=true;}if(this._maskChanged){this._bitmapMasksOld=[];this._rectangleMasksOld=[];if(this._maskBitmapData){this._maskBitmapData.beginFill(0xFFFFFF,0).drawRect(0,0,width,height).endFill();}this.resetTextureCache(texture);var normal=geometry.getCoordinatePosition(this._normal);var type=null;var posX=0;var posY=0;var i=0;while(i<this._bitmapMasks.length){var mask=this._bitmapMasks[i];if(mask){type=mask.type;posX=this._maskBitmapData.width-this._maskBitmapData.width*mask.leftSideLoc/this._leftSide.length;posY=this._maskBitmapData.height-this._maskBitmapData.height*mask.rightSideLoc/this._rightSide.length;this._maskManager.updateMask(this._maskBitmapData,type,geometry.scale,normal,posX,posY);this._bitmapMasksOld.push(new RoomPlaneBitmapMask(type,mask.leftSideLoc,mask.rightSideLoc));}i++;}i=0;while(i<this._rectangleMasks.length){var rectMask=this._rectangleMasks[i];if(rectMask){posX=this._maskBitmapData.width-this._maskBitmapData.width*rectMask.leftSideLoc/this._leftSide.length;posY=this._maskBitmapData.height-this._maskBitmapData.height*rectMask.rightSideLoc/this._rightSide.length;var wd=this._maskBitmapData.width*rectMask.leftSideLength/this._leftSide.length;var ht=this._maskBitmapData.height*rectMask.rightSideLength/this._rightSide.length;this._maskBitmapData.beginFill(0xFF0000).drawRect(posX-wd,posY-ht,wd,ht).endFill();this._rectangleMasksOld.push(new RoomPlaneRectangleMask(rectMask.leftSideLength,rectMask.rightSideLoc,rectMask.leftSideLength,rectMask.rightSideLength));}i++;}this._maskChanged=false;}this.combineTextureMask(texture,this._maskBitmapData);}},{key:\"combineTextureMask\",value:function combineTextureMask(texture,mask){if(!texture||!mask)return;var maskCanvas=TextureUtils.generateCanvas(mask);var textureCanvas=TextureUtils.generateCanvas(texture);var textureCtx=textureCanvas.getContext('2d');textureCtx.drawImage(maskCanvas,0,0);var textureImageData=textureCtx.getImageData(0,0,textureCanvas.width,textureCanvas.height);var data=textureImageData.data;for(var i=0;i<data.length;i+=4){var red=data[i];var green=data[i+1];var blue=data[i+2];var alpha=data[i+3];if(!red&&!green&&!blue)data[i+3]=0;}textureCtx.putImageData(textureImageData,0,0);var newTexture=Texture.from(textureCanvas);if(!newTexture)return;texture.clear().beginTextureFill({texture:newTexture}).drawRect(0,0,newTexture.width,newTexture.height).endFill();}}],[{key:\"blend\",value:function blend(k,_arg_2){return 0;//return Canvas.colorize(_arg_2, (k | 0xFF000000)) & 0xFFFFFF;\n}}]);return RoomPlane;}();RoomPlane.ZERO_POINT=new Point(0,0);RoomPlane.TYPE_UNDEFINED=0;RoomPlane.TYPE_WALL=1;RoomPlane.TYPE_FLOOR=2;RoomPlane.TYPE_LANDSCAPE=3;RoomPlane._uniqueIdCounter=1;","map":null,"metadata":{},"sourceType":"module"}