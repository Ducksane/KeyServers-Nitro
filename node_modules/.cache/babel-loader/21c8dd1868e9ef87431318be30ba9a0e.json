{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{AvatarEditorUtilities}from'./AvatarEditorUtilities';export var CategoryBaseModel=/*#__PURE__*/function(){function CategoryBaseModel(){_classCallCheck(this,CategoryBaseModel);this._categories=void 0;this._isInitalized=void 0;this._maxPaletteCount=void 0;this._disposed=void 0;this._isInitalized=false;this._maxPaletteCount=0;}_createClass(CategoryBaseModel,[{key:\"dispose\",value:function dispose(){this._categories=null;this._disposed=true;}},{key:\"disposed\",get:function get(){return this._disposed;}},{key:\"init\",value:function init(){if(!this._categories)this._categories=new Map();}},{key:\"reset\",value:function reset(){this._isInitalized=false;if(this._categories){var _iterator=_createForOfIteratorHelper(this._categories.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var category=_step.value;category&&category.dispose();}}catch(err){_iterator.e(err);}finally{_iterator.f();}}this._categories=new Map();}},{key:\"addCategory\",value:function addCategory(name){var existing=this._categories.get(name);if(existing)return;existing=AvatarEditorUtilities.createCategory(this,name);if(!existing)return;this._categories.set(name,existing);this.updateSelectionsFromFigure(name);}},{key:\"updateSelectionsFromFigure\",value:function updateSelectionsFromFigure(figure){var category=this._categories.get(figure);if(!category)return;var setId=AvatarEditorUtilities.CURRENT_FIGURE.getPartSetId(figure);var colorIds=AvatarEditorUtilities.CURRENT_FIGURE.getColorIds(figure);if(!colorIds)colorIds=[];category.selectPartId(setId);category.selectColorIds(colorIds);}},{key:\"hasClubSelectionsOverLevel\",value:function hasClubSelectionsOverLevel(level){if(!this._categories)return false;var _iterator2=_createForOfIteratorHelper(this._categories.values()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var category=_step2.value;if(!category)continue;if(category.hasClubSelectionsOverLevel(level))return true;}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return false;}},{key:\"hasInvalidSelectedItems\",value:function hasInvalidSelectedItems(ownedItems){if(!this._categories)return false;var _iterator3=_createForOfIteratorHelper(this._categories.values()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var category=_step3.value;if(category.hasInvalidSelectedItems(ownedItems))return true;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return false;}},{key:\"stripClubItemsOverLevel\",value:function stripClubItemsOverLevel(level){if(!this._categories)return false;var didStrip=false;var _iterator4=_createForOfIteratorHelper(this._categories.entries()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),name=_step4$value[0],category=_step4$value[1];var isValid=false;if(category.stripClubItemsOverLevel(level))isValid=true;if(category.stripClubColorsOverLevel(level))isValid=true;if(isValid){var partItem=category.getCurrentPart();if(partItem&&AvatarEditorUtilities.CURRENT_FIGURE){AvatarEditorUtilities.CURRENT_FIGURE.savePartData(name,partItem.id,category.getSelectedColorIds(),true);}didStrip=true;}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}return didStrip;}},{key:\"stripInvalidSellableItems\",value:function stripInvalidSellableItems(){if(!this._categories)return false;var didStrip=false;var _iterator5=_createForOfIteratorHelper(this._categories.entries()),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),name=_step5$value[0],category=_step5$value[1];var isValid=false;// if(category._Str_8360(this._Str_2278.manager.inventory)) _local_6 = true;\nif(isValid){var partItem=category.getCurrentPart();if(partItem&&AvatarEditorUtilities.CURRENT_FIGURE){AvatarEditorUtilities.CURRENT_FIGURE.savePartData(name,partItem.id,category.getSelectedColorIds(),true);}didStrip=true;}}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}return didStrip;}},{key:\"selectPart\",value:function selectPart(category,partIndex){var categoryData=this._categories.get(category);if(!categoryData)return;var selectedPartIndex=categoryData.selectedPartIndex;categoryData.selectPartIndex(partIndex);var partItem=categoryData.getCurrentPart();if(!partItem)return;if(partItem.isDisabled){categoryData.selectPartIndex(selectedPartIndex);// open hc window\nreturn;}this._maxPaletteCount=partItem.maxColorIndex;AvatarEditorUtilities.CURRENT_FIGURE.savePartData(category,partItem.id,categoryData.getSelectedColorIds(),true);}},{key:\"selectColor\",value:function selectColor(category,colorIndex,paletteId){var categoryData=this._categories.get(category);if(!categoryData)return;var paletteIndex=categoryData.getCurrentColorIndex(paletteId);categoryData.selectColorIndex(colorIndex,paletteId);var colorItem=categoryData.getSelectedColor(paletteId);if(colorItem.isDisabled){categoryData.selectColorIndex(paletteIndex,paletteId);// open hc window\nreturn;}AvatarEditorUtilities.CURRENT_FIGURE.savePartSetColourId(category,categoryData.getSelectedColorIds(),true);}},{key:\"getCategoryData\",value:function getCategoryData(category){if(!this._isInitalized)this.init();if(!this._categories)return null;return this._categories.get(category);}},{key:\"categories\",get:function get(){return this._categories;}},{key:\"canSetGender\",get:function get(){return false;}},{key:\"maxPaletteCount\",get:function get(){return this._maxPaletteCount||1;},set:function set(count){this._maxPaletteCount=count;}},{key:\"name\",get:function get(){return null;}}]);return CategoryBaseModel;}();","map":null,"metadata":{},"sourceType":"module"}