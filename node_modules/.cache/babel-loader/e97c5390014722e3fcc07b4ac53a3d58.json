{"ast":null,"code":"import _classCallCheck from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Vector3d}from'../../../../../room/utils/Vector3d';import{ObjectDataUpdateMessage}from'../../../messages/ObjectDataUpdateMessage';import{ObjectMoveUpdateMessage}from'../../../messages/ObjectMoveUpdateMessage';import{LegacyDataType}from'../../data/type/LegacyDataType';import{MovingObjectLogic}from'../MovingObjectLogic';import{FurnitureMultiStateLogic}from'./FurnitureMultiStateLogic';export var FurniturePushableLogic=/*#__PURE__*/function(_FurnitureMultiStateL){_inherits(FurniturePushableLogic,_FurnitureMultiStateL);var _super=_createSuper(FurniturePushableLogic);function FurniturePushableLogic(){var _this;_classCallCheck(this,FurniturePushableLogic);_this=_super.call(this);_this._oldLocation=void 0;_this.updateInterval=MovingObjectLogic.DEFAULT_UPDATE_INTERVAL;_this._oldLocation=new Vector3d();return _this;}_createClass(FurniturePushableLogic,[{key:\"processUpdateMessage\",value:function processUpdateMessage(message){if(!message)return;var isMoveMessage=message instanceof ObjectMoveUpdateMessage;if(this.object&&!isMoveMessage&&message.location){var location=this.object.getLocation();var difference=Vector3d.dif(message.location,location);if(difference){if(Math.abs(difference.x)<2&&Math.abs(difference.y)<2){var prevLocation=location;if(Math.abs(difference.x)>1||Math.abs(difference.y)>1){prevLocation=Vector3d.sum(location,Vector3d.product(difference,0.5));}_get(_getPrototypeOf(FurniturePushableLogic.prototype),\"processUpdateMessage\",this).call(this,new ObjectMoveUpdateMessage(prevLocation,message.location,message.direction));return;}}}if(message.location&&!isMoveMessage)_get(_getPrototypeOf(FurniturePushableLogic.prototype),\"processUpdateMessage\",this).call(this,new ObjectMoveUpdateMessage(message.location,message.location,message.direction));if(message instanceof ObjectDataUpdateMessage){if(message.state>0){this.updateInterval=MovingObjectLogic.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(message.state);}else{this.updateInterval=1;}this.handleDataUpdate(message);return;}if(isMoveMessage&&message.isSlide)this.updateInterval=MovingObjectLogic.DEFAULT_UPDATE_INTERVAL;_get(_getPrototypeOf(FurniturePushableLogic.prototype),\"processUpdateMessage\",this).call(this,message);}},{key:\"getUpdateIntervalValue\",value:function getUpdateIntervalValue(value){return value/FurniturePushableLogic.MAX_ANIMATION_COUNT;}},{key:\"getAnimationValue\",value:function getAnimationValue(value){return value%FurniturePushableLogic.MAX_ANIMATION_COUNT;}},{key:\"handleDataUpdate\",value:function handleDataUpdate(message){var animation=this.getAnimationValue(message.state);if(animation!==message.state){var legacyStuff=new LegacyDataType();legacyStuff.setString(animation.toString());message=new ObjectDataUpdateMessage(animation,legacyStuff,message.extra);}_get(_getPrototypeOf(FurniturePushableLogic.prototype),\"processUpdateMessage\",this).call(this,message);}},{key:\"update\",value:function update(time){if(!this.object)return;this._oldLocation.assign(this.object.getLocation());_get(_getPrototypeOf(FurniturePushableLogic.prototype),\"update\",this).call(this,time);if(Vector3d.dif(this.object.getLocation(),this._oldLocation).length!==0)return;if(this.object.getState(0)!==FurniturePushableLogic.ANIMATION_NOT_MOVING)this.object.setState(FurniturePushableLogic.ANIMATION_NOT_MOVING,0);}}]);return FurniturePushableLogic;}(FurnitureMultiStateLogic);FurniturePushableLogic.ANIMATION_NOT_MOVING=0;FurniturePushableLogic.ANIMATION_MOVING=1;FurniturePushableLogic.MAX_ANIMATION_COUNT=10;","map":null,"metadata":{},"sourceType":"module"}