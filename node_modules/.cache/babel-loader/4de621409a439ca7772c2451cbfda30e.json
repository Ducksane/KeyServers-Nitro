{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _toConsumableArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{BadgeReceivedEvent,BadgesEvent,RequestBadgesComposer,SetActivatedBadgesComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{useBetween}from'use-between';import{UseMessageEventHook}from'..';import{GetConfiguration,SendMessageComposer,UnseenItemCategory}from'../../api';import{useSharedVisibility}from'../useSharedVisibility';import{useInventoryUnseenTracker}from'./useInventoryUnseenTracker';var useInventoryBadgesState=function useInventoryBadgesState(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),needsUpdate=_useState2[0],setNeedsUpdate=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),badgeCodes=_useState4[0],setBadgeCodes=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),badgeIds=_useState6[0],setBadgeIds=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),activeBadgeCodes=_useState8[0],setActiveBadgeCodes=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedBadgeCode=_useState10[0],setSelectedBadgeCode=_useState10[1];var _useSharedVisibility=useSharedVisibility(),_useSharedVisibility$=_useSharedVisibility.isVisible,isVisible=_useSharedVisibility$===void 0?false:_useSharedVisibility$,_useSharedVisibility$2=_useSharedVisibility.activate,activate=_useSharedVisibility$2===void 0?null:_useSharedVisibility$2,_useSharedVisibility$3=_useSharedVisibility.deactivate,deactivate=_useSharedVisibility$3===void 0?null:_useSharedVisibility$3;var _useInventoryUnseenTr=useInventoryUnseenTracker(),_useInventoryUnseenTr2=_useInventoryUnseenTr.isUnseen,isUnseen=_useInventoryUnseenTr2===void 0?null:_useInventoryUnseenTr2,_useInventoryUnseenTr3=_useInventoryUnseenTr.resetCategory,resetCategory=_useInventoryUnseenTr3===void 0?null:_useInventoryUnseenTr3;var maxBadgeCount=GetConfiguration('user.badges.max.slots',5);var isWearingBadge=function isWearingBadge(badgeCode){return activeBadgeCodes.indexOf(badgeCode)>=0;};var canWearBadges=function canWearBadges(){return activeBadgeCodes.length<maxBadgeCount;};var toggleBadge=function toggleBadge(badgeCode){setActiveBadgeCodes(function(prevValue){var newValue=_toConsumableArray(prevValue);var index=newValue.indexOf(badgeCode);if(index===-1){if(!canWearBadges())return prevValue;newValue.push(badgeCode);}else{newValue.splice(index,1);}var composer=new SetActivatedBadgesComposer();for(var i=0;i<maxBadgeCount;i++){composer.addActivatedBadge(newValue[i]||null);}SendMessageComposer(composer);return newValue;});};var getBadgeId=function getBadgeId(badgeCode){var index=badgeCodes.indexOf(badgeCode);if(index===-1)return 0;return badgeIds[index]||0;};var onBadgesEvent=useCallback(function(event){var parser=event.getParser();var newBadgeCodes=parser.getAllBadgeCodes();var newBadgeIds=[];var _iterator=_createForOfIteratorHelper(newBadgeCodes),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var newBadgeCode=_step.value;newBadgeIds.push(parser.getBadgeId(newBadgeCode));}}catch(err){_iterator.e(err);}finally{_iterator.f();}setBadgeCodes(newBadgeCodes);setBadgeIds(newBadgeIds);setActiveBadgeCodes(parser.getActiveBadgeCodes());},[]);UseMessageEventHook(BadgesEvent,onBadgesEvent);var onBadgeReceivedEvent=useCallback(function(event){var parser=event.getParser();var unseen=isUnseen(UnseenItemCategory.BADGE,parser.badgeId);setBadgeCodes(function(prevValue){var newValue=_toConsumableArray(prevValue);if(unseen)newValue.unshift(parser.badgeCode);else newValue.push(parser.badgeCode);return newValue;});setBadgeIds(function(prevValue){var newValue=_toConsumableArray(prevValue);if(unseen)newValue.unshift(parser.badgeId);else newValue.push(parser.badgeId);return newValue;});},[isUnseen]);UseMessageEventHook(BadgeReceivedEvent,onBadgeReceivedEvent);useEffect(function(){if(!badgeCodes||!badgeCodes.length)return;setSelectedBadgeCode(function(prevValue){var newValue=prevValue;if(newValue&&badgeCodes.indexOf(newValue)===-1)newValue=null;if(!newValue)newValue=badgeCodes[0];return newValue;});},[badgeCodes]);useEffect(function(){if(!isVisible)return;return function(){resetCategory(UnseenItemCategory.BADGE);};},[isVisible,resetCategory]);useEffect(function(){if(!isVisible||!needsUpdate)return;SendMessageComposer(new RequestBadgesComposer());setNeedsUpdate(false);},[isVisible,needsUpdate]);return{badgeCodes:badgeCodes,activeBadgeCodes:activeBadgeCodes,selectedBadgeCode:selectedBadgeCode,setSelectedBadgeCode:setSelectedBadgeCode,isWearingBadge:isWearingBadge,canWearBadges:canWearBadges,toggleBadge:toggleBadge,getBadgeId:getBadgeId,activate:activate,deactivate:deactivate};};export var useInventoryBadges=function useInventoryBadges(){return useBetween(useInventoryBadgesState);};","map":null,"metadata":{},"sourceType":"module"}