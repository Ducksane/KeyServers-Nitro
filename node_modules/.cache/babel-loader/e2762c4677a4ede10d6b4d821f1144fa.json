{"ast":null,"code":"import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{RoomObjectSamplePlaybackEvent}from'../../../events/RoomObjectSamplePlaybackEvent';import{ObjectDataUpdateMessage}from'../../../messages/ObjectDataUpdateMessage';import{RoomObjectVariable}from'../../RoomObjectVariable';import{FurnitureMultiStateLogic}from'./FurnitureMultiStateLogic';export var FurnitureSoundBlockLogic=/*#__PURE__*/function(_FurnitureMultiStateL){_inherits(FurnitureSoundBlockLogic,_FurnitureMultiStateL);var _super=_createSuper(FurnitureSoundBlockLogic);function FurnitureSoundBlockLogic(){var _this;_classCallCheck(this,FurnitureSoundBlockLogic);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this._state=-1;_this._sampleId=-1;_this._noPitch=false;_this._lastLocZ=0;return _this;}_createClass(FurnitureSoundBlockLogic,[{key:\"getEventTypes\",value:function getEventTypes(){var types=[RoomObjectSamplePlaybackEvent.ROOM_OBJECT_INITIALIZED,RoomObjectSamplePlaybackEvent.ROOM_OBJECT_DISPOSED,RoomObjectSamplePlaybackEvent.PLAY_SAMPLE,RoomObjectSamplePlaybackEvent.CHANGE_PITCH];return this.mergeTypes(_get(_getPrototypeOf(FurnitureSoundBlockLogic.prototype),\"getEventTypes\",this).call(this),types);}},{key:\"initialize\",value:function initialize(asset){_get(_getPrototypeOf(FurnitureSoundBlockLogic.prototype),\"initialize\",this).call(this,asset);if(asset.logic){if(asset.logic.soundSample){this._sampleId=asset.logic.soundSample.id;this._noPitch=asset.logic.soundSample.noPitch;}}this.object.model.setValue(RoomObjectVariable.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1);}},{key:\"onDispose\",value:function onDispose(){if(this._state!==FurnitureSoundBlockLogic.STATE_UNINITIALIZED){this.eventDispatcher.dispatchEvent(new RoomObjectSamplePlaybackEvent(RoomObjectSamplePlaybackEvent.ROOM_OBJECT_DISPOSED,this.object,this._sampleId));}_get(_getPrototypeOf(FurnitureSoundBlockLogic.prototype),\"onDispose\",this).call(this);}},{key:\"processUpdateMessage\",value:function processUpdateMessage(message){_get(_getPrototypeOf(FurnitureSoundBlockLogic.prototype),\"processUpdateMessage\",this).call(this,message);if(message instanceof ObjectDataUpdateMessage)this.updateSoundBlockMessage(message);}},{key:\"updateSoundBlockMessage\",value:function updateSoundBlockMessage(message){if(!message)return;var model=this.object&&this.object.model;var location=this.object&&this.object.location;if(!model||!location)return;if(this._state===FurnitureSoundBlockLogic.STATE_UNINITIALIZED&&model.getValue(RoomObjectVariable.FURNITURE_REAL_ROOM_OBJECT)===1){this._lastLocZ=location.z;this.eventDispatcher.dispatchEvent(new RoomObjectSamplePlaybackEvent(RoomObjectSamplePlaybackEvent.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(location.z)));}if(this._state!==FurnitureSoundBlockLogic.STATE_UNINITIALIZED&&model.getValue(RoomObjectVariable.FURNITURE_REAL_ROOM_OBJECT)===1){if(this._lastLocZ!==location.z){this._lastLocZ=location.z;this.eventDispatcher.dispatchEvent(new RoomObjectSamplePlaybackEvent(RoomObjectSamplePlaybackEvent.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(location.z)));}}if(this._state!==FurnitureSoundBlockLogic.STATE_UNINITIALIZED&&message.state!==this._state){this.playSoundAt(location.z);}this._state=message.state;}},{key:\"playSoundAt\",value:function playSoundAt(height){if(!this.object)return;var pitch=this.getPitchForHeight(height);this.object.model.setValue(RoomObjectVariable.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,pitch);this.eventDispatcher.dispatchEvent(new RoomObjectSamplePlaybackEvent(RoomObjectSamplePlaybackEvent.PLAY_SAMPLE,this.object,this._sampleId,pitch));}},{key:\"getPitchForHeight\",value:function getPitchForHeight(height){if(this._noPitch)return 1;var heightScaled=height*2;if(heightScaled>FurnitureSoundBlockLogic.HIGHEST_SEMITONE){heightScaled=Math.min(0,FurnitureSoundBlockLogic.LOWEST_SEMITONE+(heightScaled-FurnitureSoundBlockLogic.HIGHEST_SEMITONE-1));}return Math.pow(2,heightScaled/12);}}]);return FurnitureSoundBlockLogic;}(FurnitureMultiStateLogic);FurnitureSoundBlockLogic.HIGHEST_SEMITONE=12;FurnitureSoundBlockLogic.LOWEST_SEMITONE=-12;FurnitureSoundBlockLogic.STATE_UNINITIALIZED=-1;","map":null,"metadata":{},"sourceType":"module"}