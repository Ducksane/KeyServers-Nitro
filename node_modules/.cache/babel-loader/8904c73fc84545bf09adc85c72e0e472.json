{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{GroupAdminGiveComposer,GroupAdminTakeComposer,GroupConfirmMemberRemoveEvent,GroupConfirmRemoveMemberComposer,GroupMembersComposer,GroupMembersEvent,GroupMembershipAcceptComposer,GroupMembershipDeclineComposer,GroupRank,GroupRemoveMemberComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{AddEventLinkTracker,GetSessionDataManager,GetUserProfile,LocalizeText,NotificationUtilities,RemoveLinkEventTracker,SendMessageComposer}from'../../../api';import{Base,Button,Column,Flex,Grid,LayoutAvatarImageView,LayoutBadgeImageView,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../common';import{UseMessageEventHook}from'../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var GroupMembersView=function GroupMembersView(props){var _useState=useState(-1),_useState2=_slicedToArray(_useState,2),groupId=_useState2[0],setGroupId=_useState2[1];var _useState3=useState(-1),_useState4=_slicedToArray(_useState3,2),levelId=_useState4[0],setLevelId=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),membersData=_useState6[0],setMembersData=_useState6[1];var _useState7=useState(-1),_useState8=_slicedToArray(_useState7,2),pageId=_useState8[0],setPageId=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),totalPages=_useState10[0],setTotalPages=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),searchQuery=_useState12[0],setSearchQuery=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),removingMemberName=_useState14[0],setRemovingMemberName=_useState14[1];var getRankDescription=function getRankDescription(member){if(member.rank===GroupRank.OWNER)return'group.members.owner';if(membersData.admin){if(member.rank===GroupRank.ADMIN)return'group.members.removerights';if(member.rank===GroupRank.MEMBER)return'group.members.giverights';}return'';};var refreshMembers=useCallback(function(){if(groupId===-1||levelId===-1||pageId===-1)return;SendMessageComposer(new GroupMembersComposer(groupId,pageId,searchQuery,levelId));},[groupId,levelId,pageId,searchQuery]);var toggleAdmin=function toggleAdmin(member){if(!membersData.admin||member.rank===GroupRank.OWNER)return;if(member.rank!==GroupRank.ADMIN)SendMessageComposer(new GroupAdminGiveComposer(membersData.groupId,member.id));else SendMessageComposer(new GroupAdminTakeComposer(membersData.groupId,member.id));refreshMembers();};var acceptMembership=function acceptMembership(member){if(!membersData.admin||member.rank!==GroupRank.REQUESTED)return;SendMessageComposer(new GroupMembershipAcceptComposer(membersData.groupId,member.id));refreshMembers();};var removeMemberOrDeclineMembership=function removeMemberOrDeclineMembership(member){if(!membersData.admin)return;if(member.rank===GroupRank.REQUESTED){SendMessageComposer(new GroupMembershipDeclineComposer(membersData.groupId,member.id));refreshMembers();return;}setRemovingMemberName(member.name);SendMessageComposer(new GroupConfirmRemoveMemberComposer(membersData.groupId,member.id));};var onGroupMembersEvent=useCallback(function(event){var parser=event.getParser();setMembersData(parser);setLevelId(parser.level);setTotalPages(Math.ceil(parser.totalMembersCount/parser.pageSize));},[]);UseMessageEventHook(GroupMembersEvent,onGroupMembersEvent);var onGroupConfirmMemberRemoveEvent=useCallback(function(event){var parser=event.getParser();NotificationUtilities.confirm(LocalizeText(parser.furnitureCount>0?'group.kickconfirm.desc':'group.kickconfirm_nofurni.desc',['user','amount'],[removingMemberName,parser.furnitureCount.toString()]),function(){SendMessageComposer(new GroupRemoveMemberComposer(membersData.groupId,parser.userId));refreshMembers();},null);setRemovingMemberName(null);},[membersData,removingMemberName,refreshMembers]);UseMessageEventHook(GroupConfirmMemberRemoveEvent,onGroupConfirmMemberRemoveEvent);var linkReceived=useCallback(function(url){var parts=url.split('/');if(parts.length<2)return;var groupId=parseInt(parts[1])||-1;var levelId=parseInt(parts[2])||3;setGroupId(groupId);setLevelId(levelId);},[]);useEffect(function(){var linkTracker={linkReceived:linkReceived,eventUrlPrefix:'group-members/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[linkReceived]);useEffect(function(){setPageId(0);},[groupId,levelId,searchQuery]);useEffect(function(){if(groupId===-1||levelId===-1||pageId===-1)return;SendMessageComposer(new GroupMembersComposer(groupId,pageId,searchQuery,levelId));},[groupId,levelId,pageId,searchQuery]);useEffect(function(){if(groupId===-1)return;setLevelId(-1);setMembersData(null);setTotalPages(0);setSearchQuery('');setRemovingMemberName(null);},[groupId]);if(groupId===-1||!membersData)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-group-members\",theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('group.members.title',['groupName'],[membersData?membersData.groupTitle:'']),onCloseClick:function onCloseClick(event){return setGroupId(-1);}}),/*#__PURE__*/_jsxs(NitroCardContentView,{overflow:\"hidden\",children:[/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(Flex,{center:true,className:\"group-badge\",children:/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:membersData.badge,isGroup:true,className:\"mx-auto d-block\"})}),/*#__PURE__*/_jsxs(Column,{fullWidth:true,gap:1,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm w-100\",placeholder:LocalizeText('group.members.searchinfo'),value:searchQuery,onChange:function onChange(event){return setSearchQuery(event.target.value);}}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm w-100\",value:levelId,onChange:function onChange(event){return setLevelId(parseInt(event.target.value));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:LocalizeText('group.members.search.all')}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:LocalizeText('group.members.search.admins')}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:LocalizeText('group.members.search.pending')})]})]})]}),/*#__PURE__*/_jsx(Grid,{columnCount:2,overflow:\"auto\",className:\"nitro-group-members-list-grid\",children:membersData.result.map(function(member,index){return/*#__PURE__*/_jsxs(Flex,{gap:2,alignItems:\"center\",overflow:\"hidden\",className:\"member-list-item bg-white rounded p-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar-head cursor-pointer\",onClick:function onClick(){return GetUserProfile(member.id);},children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:member.figure,headOnly:true,direction:2})}),/*#__PURE__*/_jsxs(Column,{grow:true,gap:1,children:[/*#__PURE__*/_jsx(Text,{bold:true,small:true,pointer:true,onClick:function onClick(event){return GetUserProfile(member.id);},children:member.name}),member.rank!==GroupRank.REQUESTED&&/*#__PURE__*/_jsx(Text,{small:true,italics:true,variant:\"muted\",children:LocalizeText('group.members.since',['date'],[member.joinedAt])})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[member.rank!==GroupRank.REQUESTED&&/*#__PURE__*/_jsx(Flex,{center:true,children:/*#__PURE__*/_jsx(Base,{pointer:membersData.admin,className:\"icon icon-group-small-\".concat(member.rank===GroupRank.OWNER?'owner':member.rank===GroupRank.ADMIN?'admin':membersData.admin&&member.rank===GroupRank.MEMBER?'not-admin':''),title:LocalizeText(getRankDescription(member)),onClick:function onClick(event){return toggleAdmin(member);}})}),membersData.admin&&member.rank===GroupRank.REQUESTED&&/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",children:/*#__PURE__*/_jsx(Base,{pointer:true,className:\"nitro-friends-spritesheet icon-accept\",title:LocalizeText('group.members.accept'),onClick:function onClick(event){return acceptMembership(member);}})}),membersData.admin&&member.rank!==GroupRank.OWNER&&member.id!==GetSessionDataManager().userId&&/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",children:/*#__PURE__*/_jsx(Base,{pointer:true,className:\"nitro-friends-spritesheet icon-deny\",title:LocalizeText(member.rank===GroupRank.REQUESTED?'group.members.reject':'group.members.kick'),onClick:function onClick(event){return removeMemberOrDeclineMembership(member);}})})]})]},index);})}),/*#__PURE__*/_jsxs(Flex,{gap:1,justifyContent:\"between\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Button,{disabled:membersData.pageIndex===0,onClick:function onClick(event){return setPageId(function(prevValue){return prevValue-1;});},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"chevron-left\"})}),/*#__PURE__*/_jsx(Text,{small:true,children:LocalizeText('group.members.pageinfo',['amount','page','totalPages'],[membersData.totalMembersCount.toString(),(membersData.pageIndex+1).toString(),totalPages.toString()])}),/*#__PURE__*/_jsx(Button,{disabled:membersData.pageIndex===totalPages-1,onClick:function onClick(event){return setPageId(function(prevValue){return prevValue+1;});},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"chevron-right\"})})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}