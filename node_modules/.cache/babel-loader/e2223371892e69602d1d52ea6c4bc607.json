{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _toConsumableArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{useCallback,useEffect,useState}from'react';import ReactSlider from'react-slider';import{LocalizeText,WiredFurniType}from'../../../../api';import{Button}from'../../../../common/Button';import{Column}from'../../../../common/Column';import{Flex}from'../../../../common/Flex';import{Text}from'../../../../common/Text';import{useWiredContext}from'../../WiredContext';import{WiredActionBaseView}from'./WiredActionBaseView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var WiredActionGiveRewardView=function WiredActionGiveRewardView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),limitEnabled=_useState2[0],setLimitEnabled=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),rewardTime=_useState4[0],setRewardTime=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),uniqueRewards=_useState6[0],setUniqueRewards=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),rewardsLimit=_useState8[0],setRewardsLimit=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),limitationInterval=_useState10[0],setLimitationInterval=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),rewards=_useState12[0],setRewards=_useState12[1];var _useWiredContext=useWiredContext(),_useWiredContext$trig=_useWiredContext.trigger,trigger=_useWiredContext$trig===void 0?null:_useWiredContext$trig,_useWiredContext$setI=_useWiredContext.setIntParams,setIntParams=_useWiredContext$setI===void 0?null:_useWiredContext$setI,_useWiredContext$setS=_useWiredContext.setStringParam,setStringParam=_useWiredContext$setS===void 0?null:_useWiredContext$setS;var addReward=useCallback(function(){setRewards(function(rewards){return[].concat(_toConsumableArray(rewards),[{isBadge:false,itemCode:'',probability:null}]);});},[setRewards]);var removeReward=useCallback(function(index){setRewards(function(prevValue){var newValues=Array.from(prevValue);newValues.splice(index,1);return newValues;});},[setRewards]);var updateReward=useCallback(function(index,isBadge,itemCode,probability){var rewardsClone=Array.from(rewards);var reward=rewardsClone[index];if(!reward)return;reward.isBadge=isBadge;reward.itemCode=itemCode;reward.probability=probability;setRewards(rewardsClone);},[rewards,setRewards]);var save=useCallback(function(){var stringRewards=[];var _iterator=_createForOfIteratorHelper(rewards),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var reward=_step.value;if(!reward.itemCode)continue;var rewardsString=[reward.isBadge?'0':'1',reward.itemCode,reward.probability.toString()];stringRewards.push(rewardsString.join(','));}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(stringRewards.length>0){setStringParam(stringRewards.join(';'));setIntParams([rewardTime,uniqueRewards?1:0,rewardsLimit,limitationInterval]);}},[rewardTime,uniqueRewards,rewardsLimit,limitationInterval,rewards,setIntParams,setStringParam]);useEffect(function(){var readRewards=[];if(trigger.stringData.length>0&&trigger.stringData.includes(';')){var splittedRewards=trigger.stringData.split(';');var _iterator2=_createForOfIteratorHelper(splittedRewards),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var rawReward=_step2.value;var reward=rawReward.split(',');if(reward.length!==3)continue;readRewards.push({isBadge:reward[0]==='0',itemCode:reward[1],probability:Number(reward[2])});}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}if(readRewards.length===0)readRewards.push({isBadge:false,itemCode:'',probability:null});setRewardTime(trigger.intData.length>0?trigger.intData[0]:0);setUniqueRewards(trigger.intData.length>1?trigger.intData[1]===1:false);setRewardsLimit(trigger.intData.length>2?trigger.intData[2]:0);setLimitationInterval(trigger.intData.length>3?trigger.intData[3]:0);setLimitEnabled(trigger.intData.length>3?trigger.intData[3]>0:false);setRewards(readRewards);},[trigger]);return/*#__PURE__*/_jsxs(WiredActionBaseView,{requiresFurni:WiredFurniType.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:true,save:save,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",id:\"limitEnabled\",onChange:function onChange(event){return setLimitEnabled(event.target.checked);}}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('wiredfurni.params.prizelimit',['amount'],[limitEnabled?rewardsLimit.toString():''])})]}),!limitEnabled&&/*#__PURE__*/_jsx(Text,{center:true,small:true,className:\"bg-muted rounded p-1\",children:\"Reward limit not set. Make sure rewards are badges or non-tradeable items.\"}),limitEnabled&&/*#__PURE__*/_jsx(ReactSlider,{className:'nitro-slider',min:1,max:1000,value:rewardsLimit,onChange:function onChange(event){return setRewardsLimit(event);}}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0 bg-dark\"}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{bold:true,children:\"How often can a user be rewarded?\"}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm w-100\",value:rewardTime,onChange:function onChange(e){return setRewardTime(Number(e.target.value));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Once\"}),/*#__PURE__*/_jsxs(\"option\",{value:\"3\",children:[\"Once every \",limitationInterval,\" minutes\"]}),/*#__PURE__*/_jsxs(\"option\",{value:\"2\",children:[\"Once every \",limitationInterval,\" hours\"]}),/*#__PURE__*/_jsxs(\"option\",{value:\"1\",children:[\"Once every \",limitationInterval,\" days\"]})]}),rewardTime>0&&/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control form-control-sm\",value:limitationInterval,onChange:function onChange(event){return setLimitationInterval(Number(event.target.value));}})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0 bg-dark\"}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",id:\"uniqueRewards\",checked:uniqueRewards,onChange:function onChange(e){return setUniqueRewards(e.target.checked);}}),/*#__PURE__*/_jsx(Text,{children:\"Unique rewards\"})]}),/*#__PURE__*/_jsx(Text,{center:true,small:true,className:\"bg-muted rounded p-1\",children:\"If checked each reward will be given once to each user. This will disable the probabilities option.\"}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0 bg-dark\"}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"between\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Text,{bold:true,children:\"Rewards\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:addReward,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"plus\"})})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:rewards&&rewards.map(function(reward,index){return/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:reward.isBadge,onChange:function onChange(e){return updateReward(index,e.target.checked,reward.itemCode,reward.probability);}}),/*#__PURE__*/_jsx(Text,{small:true,children:\"Badge?\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",value:reward.itemCode,onChange:function onChange(e){return updateReward(index,reward.isBadge,e.target.value,reward.probability);},placeholder:\"Item Code\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control form-control-sm\",value:reward.probability,onChange:function onChange(e){return updateReward(index,reward.isBadge,reward.itemCode,Number(e.target.value));},placeholder:\"Probability\"}),index>0&&/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:function onClick(event){return removeReward(index);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"trash\"})})]},index);})})]});};","map":null,"metadata":{},"sourceType":"module"}