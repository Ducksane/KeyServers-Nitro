{"ast":null,"code":"import _asyncToGenerator from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/regenerator/index.js\";import{NitroLogger}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{AddEventLinkTracker,GetConfiguration,NotificationUtilities,RemoveLinkEventTracker}from'../../api';import{Base,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../common';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NEW_LINE_REGEX=/\\n\\r|\\n|\\r/mg;export var NitropediaView=function NitropediaView(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),header=_useState4[0],setHeader=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),dimensions=_useState6[0],setDimensions=_useState6[1];var elementRef=useRef(null);var openPage=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(link){var response,text,splitData,line;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(link);case 3:response=_context.sent;if(response){_context.next=6;break;}return _context.abrupt(\"return\");case 6:_context.next=8;return response.text();case 8:text=_context.sent;splitData=text.split(NEW_LINE_REGEX);line=splitData.shift().split('|');setHeader(line[0]);setDimensions(function(prevValue){if(line[1]&&line[1].split(';').length===2){return{width:parseInt(line[1].split(';')[0]),height:parseInt(line[1].split(';')[1])};}return null;});setContent(splitData.join(''));_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);NitroLogger.error(\"Failed to fetch \".concat(link));case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,16]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var onLinkReceived=useCallback(function(link){var value=link.split('/');if(value.length<2)return;value.shift();openPage(GetConfiguration('habbopages.url')+value.join('/'));},[openPage]);useEffect(function(){var linkTracker={linkReceived:onLinkReceived,eventUrlPrefix:'habbopages/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[onLinkReceived]);useEffect(function(){var handle=function handle(event){if(!(event.target instanceof HTMLAnchorElement))return;event.preventDefault();var link=event.target.href;if(!link||!link.length)return;NotificationUtilities.openUrl(link);};document.addEventListener('click',handle);return function(){document.removeEventListener('click',handle);};},[]);if(!content)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitropedia\",theme:\"primary-slim\",style:dimensions?{width:dimensions.width,height:dimensions.height}:{},children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:header,onCloseClick:function onCloseClick(){return setContent(null);}}),/*#__PURE__*/_jsx(NitroCardContentView,{children:/*#__PURE__*/_jsx(Base,{fit:true,innerRef:elementRef,className:\"text-black\",dangerouslySetInnerHTML:{__html:content}})})]});};","map":null,"metadata":{},"sourceType":"module"}