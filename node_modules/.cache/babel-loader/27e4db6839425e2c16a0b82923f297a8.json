{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ColorConverter,TextureUtils}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{GetNitroInstance}from'../../api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var LayoutRoomPreviewerView=function LayoutRoomPreviewerView(props){var _props$roomPreviewer=props.roomPreviewer,roomPreviewer=_props$roomPreviewer===void 0?null:_props$roomPreviewer,_props$height=props.height,height=_props$height===void 0?0:_props$height,_props$children=props.children,children=_props$children===void 0?null:_props$children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),renderingCanvas=_useState2[0],setRenderingCanvas=_useState2[1];var elementRef=useRef();var onClick=function onClick(event){if(!roomPreviewer)return;if(event.shiftKey){roomPreviewer.changeRoomObjectDirection();}else{roomPreviewer.changeRoomObjectState();}};var update=useCallback(function(time){if(!roomPreviewer||!renderingCanvas||!elementRef.current)return;roomPreviewer.updatePreviewRoomView();if(!renderingCanvas.canvasUpdated)return;elementRef.current.style.backgroundImage=\"url(\".concat(TextureUtils.generateImageUrl(renderingCanvas.master),\")\");},[roomPreviewer,renderingCanvas,elementRef]);var setupPreviewer=useCallback(function(){if(!elementRef.current||!roomPreviewer)return;var computed=document.defaultView.getComputedStyle(elementRef.current,null);var backgroundColor=computed.backgroundColor;backgroundColor=ColorConverter.rgbStringToHex(backgroundColor);backgroundColor=backgroundColor.replace('#','0x');roomPreviewer.backgroundColor=parseInt(backgroundColor,16);var width=elementRef.current.parentElement.clientWidth;roomPreviewer.getRoomCanvas(width,height);var canvas=roomPreviewer.getRenderingCanvas();setRenderingCanvas(canvas);canvas.canvasUpdated=true;update(-1);},[elementRef,height,roomPreviewer,update]);useEffect(function(){if(!roomPreviewer)return;if(!renderingCanvas)setupPreviewer();GetNitroInstance().ticker.add(update);var resizeObserver=new ResizeObserver(function(){if(!roomPreviewer||!elementRef.current)return;var width=elementRef.current.parentElement.offsetWidth;roomPreviewer.modifyRoomCanvas(width,height);update(-1);});resizeObserver.observe(elementRef.current);return function(){resizeObserver.disconnect();GetNitroInstance().ticker.remove(update);};},[renderingCanvas,roomPreviewer,elementRef,height,setupPreviewer,update]);return/*#__PURE__*/_jsxs(\"div\",{className:\"room-preview-container\",children:[/*#__PURE__*/_jsx(\"div\",{ref:elementRef,className:\"room-preview-image\",style:{height:height},onClick:onClick}),children]});};","map":null,"metadata":{},"sourceType":"module"}