{"ast":null,"code":"import{useCallback}from'react';import{AutoSizer,CellMeasurer,CellMeasurerCache,List}from'react-virtualized';import{TryVisitRoom}from'../../../../api';import{Base,Button,Column,Flex,Grid,Text}from'../../../../common';import{ModToolsOpenUserInfoEvent}from'../../../../events';import{ModToolsOpenRoomInfoEvent}from'../../../../events/mod-tools/ModToolsOpenRoomInfoEvent';import{DispatchUiEvent}from'../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var ChatlogView=function ChatlogView(props){var _props$records=props.records,records=_props$records===void 0?null:_props$records;var rowRenderer=function rowRenderer(props){var chatlogEntry=records[0].chatlog[props.index];return/*#__PURE__*/_jsx(CellMeasurer,{cache:cache,columnIndex:0,parent:props.parent,rowIndex:props.index,children:/*#__PURE__*/_jsxs(Grid,{fullHeight:false,style:props.style,gap:1,alignItems:\"center\",className:\"log-entry py-1 border-bottom\",children:[/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",className:\"g-col-2\",children:chatlogEntry.timestamp}),/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",className:\"g-col-3\",bold:true,underline:true,pointer:true,onClick:function onClick(event){return DispatchUiEvent(new ModToolsOpenUserInfoEvent(chatlogEntry.userId));},children:chatlogEntry.userName}),/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",textBreak:true,wrap:true,className:\"g-col-7\",children:chatlogEntry.message})]},props.key)},props.key);};var advancedRowRenderer=function advancedRowRenderer(props){var chatlogEntry=null;var currentRecord=null;var isRoomInfo=false;var totalIndex=0;for(var i=0;i<records.length;i++){currentRecord=records[i];totalIndex++;// row for room info\ntotalIndex=totalIndex+currentRecord.chatlog.length;if(props.index>totalIndex-1)continue;if(props.index+1===totalIndex-currentRecord.chatlog.length){isRoomInfo=true;break;}var index=props.index-(totalIndex-currentRecord.chatlog.length);chatlogEntry=currentRecord.chatlog[index];break;}return/*#__PURE__*/_jsxs(CellMeasurer,{cache:cache,columnIndex:0,parent:props.parent,rowIndex:props.index,children:[isRoomInfo&&currentRecord&&/*#__PURE__*/_jsx(RoomInfo,{roomId:currentRecord.roomId,roomName:currentRecord.roomName,uniqueKey:props.key,style:props.style}),!isRoomInfo&&/*#__PURE__*/_jsxs(Grid,{fullHeight:false,style:props.style,gap:1,alignItems:\"center\",className:\"log-entry py-1 border-bottom\",children:[/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",className:\"g-col-2\",children:chatlogEntry.timestamp}),/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",className:\"g-col-3\",bold:true,underline:true,pointer:true,onClick:function onClick(event){return DispatchUiEvent(new ModToolsOpenUserInfoEvent(chatlogEntry.userId));},children:chatlogEntry.userName}),/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",textBreak:true,wrap:true,className:\"g-col-7\",children:chatlogEntry.message})]},props.key)]},props.key);};var getNumRowsForAdvanced=useCallback(function(){var count=0;for(var i=0;i<records.length;i++){count++;// add room info row\ncount=count+records[i].chatlog.length;}return count;},[records]);var RoomInfo=function RoomInfo(props){return/*#__PURE__*/_jsxs(Flex,{gap:2,alignItems:\"center\",justifyContent:\"between\",className:\"room-info bg-muted rounded p-1\",style:props.style,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Text,{bold:true,children:\"Room name:\"}),/*#__PURE__*/_jsx(Text,{children:props.roomName})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(event){return TryVisitRoom(props.roomId);},children:\"Visit Room\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(event){return DispatchUiEvent(new ModToolsOpenRoomInfoEvent(props.roomId));},children:\"Room Tools\"})]})]},props.uniqueKey);};var cache=new CellMeasurerCache({defaultHeight:25,fixedWidth:true});return/*#__PURE__*/_jsxs(_Fragment,{children:[records&&records.length===1&&/*#__PURE__*/_jsx(RoomInfo,{roomId:records[0].roomId,roomName:records[0].roomName,uniqueKey:null,style:{}}),/*#__PURE__*/_jsxs(Column,{fit:true,gap:0,overflow:\"hidden\",children:[/*#__PURE__*/_jsx(Column,{gap:2,children:/*#__PURE__*/_jsxs(Grid,{gap:1,className:\"text-black fw-bold border-bottom pb-1\",children:[/*#__PURE__*/_jsx(Base,{className:\"g-col-2\",children:\"Time\"}),/*#__PURE__*/_jsx(Base,{className:\"g-col-3\",children:\"User\"}),/*#__PURE__*/_jsx(Base,{className:\"g-col-7\",children:\"Message\"})]})}),records&&records.length>0&&/*#__PURE__*/_jsx(Column,{className:\"log-container striped-children\",overflow:\"auto\",gap:0,children:/*#__PURE__*/_jsx(AutoSizer,{defaultWidth:400,defaultHeight:200,children:function children(_ref){var height=_ref.height,width=_ref.width;cache.clearAll();return/*#__PURE__*/_jsx(List,{width:width,height:height,rowCount:records.length>1?getNumRowsForAdvanced():records[0].chatlog.length,rowHeight:cache.rowHeight,className:'log-entry-container',rowRenderer:records.length>1?advancedRowRenderer:rowRenderer,deferredMeasurementCache:cache});}})})]})]});};","map":null,"metadata":{},"sourceType":"module"}