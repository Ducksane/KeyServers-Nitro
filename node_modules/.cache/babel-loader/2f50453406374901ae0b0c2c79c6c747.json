{"ast":null,"code":"import _classCallCheck from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{RoomObjectDimmerStateUpdateEvent}from'../../../events/RoomObjectDimmerStateUpdateEvent';import{RoomObjectWidgetRequestEvent}from'../../../events/RoomObjectWidgetRequestEvent';import{ObjectDataUpdateMessage}from'../../../messages/ObjectDataUpdateMessage';import{RoomObjectVariable}from'../../RoomObjectVariable';import{FurnitureLogic}from'./FurnitureLogic';export var FurnitureRoomDimmerLogic=/*#__PURE__*/function(_FurnitureLogic){_inherits(FurnitureRoomDimmerLogic,_FurnitureLogic);var _super=_createSuper(FurnitureRoomDimmerLogic);function FurnitureRoomDimmerLogic(){var _this;_classCallCheck(this,FurnitureRoomDimmerLogic);_this=_super.call(this);_this._roomColorUpdated=void 0;_this._roomColorUpdated=false;return _this;}_createClass(FurnitureRoomDimmerLogic,[{key:\"getEventTypes\",value:function getEventTypes(){var types=[RoomObjectWidgetRequestEvent.DIMMER,RoomObjectWidgetRequestEvent.WIDGET_REMOVE_DIMMER,RoomObjectDimmerStateUpdateEvent.DIMMER_STATE];return this.mergeTypes(_get(_getPrototypeOf(FurnitureRoomDimmerLogic.prototype),\"getEventTypes\",this).call(this),types);}},{key:\"onDispose\",value:function onDispose(){if(this._roomColorUpdated){if(this.eventDispatcher&&this.object){var realRoomObject=this.object.model.getValue(RoomObjectVariable.FURNITURE_REAL_ROOM_OBJECT);if(realRoomObject===1){this.eventDispatcher.dispatchEvent(new RoomObjectDimmerStateUpdateEvent(this.object,0,1,1,0xFFFFFF,0xFF));this.eventDispatcher.dispatchEvent(new RoomObjectWidgetRequestEvent(RoomObjectWidgetRequestEvent.WIDGET_REMOVE_DIMMER,this.object));}this._roomColorUpdated=false;}}_get(_getPrototypeOf(FurnitureRoomDimmerLogic.prototype),\"onDispose\",this).call(this);}},{key:\"processUpdateMessage\",value:function processUpdateMessage(message){if(message instanceof ObjectDataUpdateMessage){if(message.data){var extra=message.data.getLegacyString();var realRoomObject=this.object.model.getValue(RoomObjectVariable.FURNITURE_REAL_ROOM_OBJECT);if(realRoomObject===1)this.processDimmerData(extra);_get(_getPrototypeOf(FurnitureRoomDimmerLogic.prototype),\"processUpdateMessage\",this).call(this,new ObjectDataUpdateMessage(this.getStateFromDimmerData(extra),message.data));}return;}_get(_getPrototypeOf(FurnitureRoomDimmerLogic.prototype),\"processUpdateMessage\",this).call(this,message);}},{key:\"getStateFromDimmerData\",value:function getStateFromDimmerData(data){if(!data)return 0;var parts=data.split(',');if(parts.length>=5)return parseInt(parts[0])-1;return 0;}},{key:\"processDimmerData\",value:function processDimmerData(data){if(!data)return;var parts=data.split(',');if(parts.length>=5){var state=this.getStateFromDimmerData(data);var presetId=parseInt(parts[1]);var effectId=parseInt(parts[2]);var color=parts[3];var colorCode=parseInt(color.substr(1),16);var brightness=parseInt(parts[4]);if(!state){colorCode=0xFFFFFF;brightness=0xFF;}if(this.eventDispatcher&&this.object){this.eventDispatcher.dispatchEvent(new RoomObjectDimmerStateUpdateEvent(this.object,state,presetId,effectId,colorCode,brightness));this._roomColorUpdated=true;}}}},{key:\"useObject\",value:function useObject(){if(!this.object||!this.eventDispatcher)return;this.eventDispatcher.dispatchEvent(new RoomObjectWidgetRequestEvent(RoomObjectWidgetRequestEvent.DIMMER,this.object));}},{key:\"update\",value:function update(time){_get(_getPrototypeOf(FurnitureRoomDimmerLogic.prototype),\"update\",this).call(this,time);// if(this.object && this.object.model)\n// {\n//     const realRoomObject = this.object.model.getValue<number>(RoomObjectVariable.FURNITURE_REAL_ROOM_OBJECT);\n//     if(realRoomObject === 1)\n//     {\n//         const data = this.object.model.getValue<string>(RoomObjectVariable.FURNITURE_DATA);\n//         if(data && data.length > 0)\n//         {\n//             this.object.model.setValue(RoomObjectVariable.FURNITURE_DATA, '');\n//             this.processDimmerData(data);\n//         }\n//     }\n// }\n}}]);return FurnitureRoomDimmerLogic;}(FurnitureLogic);","map":null,"metadata":{},"sourceType":"module"}