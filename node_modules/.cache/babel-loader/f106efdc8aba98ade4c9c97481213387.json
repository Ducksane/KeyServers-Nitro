{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ActivityPointNotificationMessageEvent,UserCreditsEvent,UserCurrencyComposer,UserCurrencyEvent,UserSubscriptionComposer,UserSubscriptionEvent,UserSubscriptionParser}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useMemo,useState}from'react';import{useBetween}from'use-between';import{CloneObject,ClubStatus,GetConfiguration,PlaySound,Purse,SendMessageComposer,SoundNames}from'../../api';import{UseMessageEventHook}from'../messages';var usePurseState=function usePurseState(){var _useState=useState(new Purse()),_useState2=_slicedToArray(_useState,2),purse=_useState2[0],setPurse=_useState2[1];var hcDisabled=useMemo(function(){return GetConfiguration('hc.disabled',false);},[]);var clubStatus=useMemo(function(){if(hcDisabled||purse.clubDays>0)return ClubStatus.ACTIVE;if(purse.pastVipDays>0||purse.pastVipDays>0)return ClubStatus.EXPIRED;return ClubStatus.NONE;},[purse,hcDisabled]);var getCurrencyAmount=function getCurrencyAmount(type){if(type===-1)return purse.credits;var _iterator=_createForOfIteratorHelper(purse.activityPoints.entries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),key=_step$value[0],value=_step$value[1];if(key!==type)continue;return value;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return 0;};var onUserCreditsEvent=useCallback(function(event){var parser=event.getParser();setPurse(function(prevValue){var newValue=CloneObject(prevValue);newValue.credits=parseFloat(parser.credits);if(prevValue.credits!==newValue.credits)PlaySound(SoundNames.CREDITS);return newValue;});},[]);UseMessageEventHook(UserCreditsEvent,onUserCreditsEvent);var onUserCurrencyEvent=useCallback(function(event){var parser=event.getParser();setPurse(function(prevValue){var newValue=CloneObject(prevValue);newValue.activityPoints=parser.currencies;return newValue;});},[]);UseMessageEventHook(UserCurrencyEvent,onUserCurrencyEvent);var onActivityPointNotificationMessageEvent=useCallback(function(event){var parser=event.getParser();setPurse(function(prevValue){var newValue=CloneObject(prevValue);newValue.activityPoints=new Map(newValue.activityPoints);newValue.activityPoints.set(parser.type,parser.amount);if(parser.type===0)PlaySound(SoundNames.DUCKETS);return newValue;});},[]);UseMessageEventHook(ActivityPointNotificationMessageEvent,onActivityPointNotificationMessageEvent);var onUserSubscriptionEvent=useCallback(function(event){var parser=event.getParser();var productName=parser.productName;if(productName!=='club_habbo'&&productName!=='habbo_club')return;setPurse(function(prevValue){var newValue=CloneObject(prevValue);newValue.clubDays=Math.max(0,parser.daysToPeriodEnd);newValue.clubPeriods=Math.max(0,parser.periodsSubscribedAhead);newValue.isVip=parser.isVip;newValue.pastClubDays=parser.pastClubDays;newValue.pastVipDays=parser.pastVipDays;newValue.isExpiring=parser.responseType===UserSubscriptionParser.RESPONSE_TYPE_DISCOUNT_AVAILABLE?true:false;newValue.minutesUntilExpiration=parser.minutesUntilExpiration;newValue.minutesSinceLastModified=parser.minutesSinceLastModified;return newValue;});},[]);UseMessageEventHook(UserSubscriptionEvent,onUserSubscriptionEvent);useEffect(function(){if(hcDisabled)return;SendMessageComposer(new UserSubscriptionComposer('habbo_club'));var interval=setInterval(function(){return SendMessageComposer(new UserSubscriptionComposer('habbo_club'));},50000);return function(){return clearInterval(interval);};},[hcDisabled]);useEffect(function(){SendMessageComposer(new UserCurrencyComposer());},[]);return{purse:purse,hcDisabled:hcDisabled,clubStatus:clubStatus,getCurrencyAmount:getCurrencyAmount};};export var usePurse=function usePurse(){return useBetween(usePurseState);};","map":null,"metadata":{},"sourceType":"module"}