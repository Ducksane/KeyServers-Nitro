{"ast":null,"code":"import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ClubGiftInfoEvent,FriendlyTime,GetClubGiftInfo,ScrGetKickbackInfoMessageComposer,ScrSendKickbackInfoMessageEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{OverlayTrigger,Popover}from'react-bootstrap';import{AddEventLinkTracker,ClubStatus,CreateLinkEvent,GetClubBadge,GetConfiguration,LocalizeText,RemoveLinkEventTracker,SendMessageComposer}from'../../api';import{Base,Button,Column,Flex,LayoutAvatarImageView,LayoutBadgeImageView,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../common';import{useInventoryBadges,UseMessageEventHook,usePurse,useSessionInfo}from'../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var HcCenterView=function HcCenterView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),kickbackData=_useState4[0],setKickbackData=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),unclaimedGifts=_useState6[0],setUnclaimedGifts=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),badgeCode=_useState8[0],setBadgeCode=_useState8[1];var _useSessionInfo=useSessionInfo(),_useSessionInfo$userF=_useSessionInfo.userFigure,userFigure=_useSessionInfo$userF===void 0?null:_useSessionInfo$userF;var _usePurse=usePurse(),_usePurse$purse=_usePurse.purse,purse=_usePurse$purse===void 0?null:_usePurse$purse,_usePurse$clubStatus=_usePurse.clubStatus,clubStatus=_usePurse$clubStatus===void 0?null:_usePurse$clubStatus;var _useInventoryBadges=useInventoryBadges(),_useInventoryBadges$b=_useInventoryBadges.badgeCodes,badgeCodes=_useInventoryBadges$b===void 0?[]:_useInventoryBadges$b,_useInventoryBadges$a=_useInventoryBadges.activate,activate=_useInventoryBadges$a===void 0?null:_useInventoryBadges$a,_useInventoryBadges$d=_useInventoryBadges.deactivate,deactivate=_useInventoryBadges$d===void 0?null:_useInventoryBadges$d;var getClubText=function getClubText(){if(purse.clubDays<=0)return LocalizeText('purse.clubdays.zero.amount.text');if(purse.minutesUntilExpiration>-1&&purse.minutesUntilExpiration<60*24){return FriendlyTime.shortFormat(purse.minutesUntilExpiration*60);}return FriendlyTime.shortFormat((purse.clubPeriods*31+purse.clubDays)*86400);};var getInfoText=function getInfoText(){switch(clubStatus){case ClubStatus.ACTIVE:return LocalizeText(\"hccenter.status.\".concat(clubStatus,\".info\"),['timeleft','joindate','streakduration'],[getClubText(),kickbackData.firstSubscriptionDate,FriendlyTime.shortFormat(kickbackData.currentHcStreak*86400)]);case ClubStatus.EXPIRED:return LocalizeText(\"hccenter.status.\".concat(clubStatus,\".info\"),['joindate'],[kickbackData.firstSubscriptionDate]);default:return LocalizeText(\"hccenter.status.\".concat(clubStatus,\".info\"));}};var getHcPaydayTime=function getHcPaydayTime(){return kickbackData.timeUntilPayday<60?LocalizeText('hccenter.special.time.soon'):FriendlyTime.shortFormat(kickbackData.timeUntilPayday*60);};var getHcPaydayAmount=function getHcPaydayAmount(){return LocalizeText('hccenter.special.sum',['credits'],[(kickbackData.creditRewardForStreakBonus+kickbackData.creditRewardForMonthlySpent).toString()]);};var onClubGiftInfoEvent=useCallback(function(event){var parser=event.getParser();setUnclaimedGifts(parser.giftsAvailable);},[]);UseMessageEventHook(ClubGiftInfoEvent,onClubGiftInfoEvent);var onScrSendKickbackInfo=useCallback(function(event){var parser=event.getParser();setKickbackData(parser.data);},[]);UseMessageEventHook(ScrSendKickbackInfoMessageEvent,onScrSendKickbackInfo);useEffect(function(){var linkTracker={linkReceived:function linkReceived(url){var parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'open':if(parts.length>2){switch(parts[2]){case'hccenter':setIsVisible(true);break;}}return;}},eventUrlPrefix:'habboUI/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[]);useEffect(function(){setBadgeCode(GetClubBadge(badgeCodes));},[badgeCodes]);useEffect(function(){if(!isVisible)return;var id=activate();return function(){return deactivate(id);};},[isVisible,activate,deactivate]);useEffect(function(){SendMessageComposer(new GetClubGiftInfo());SendMessageComposer(new ScrGetKickbackInfoMessageComposer());},[]);if(!isVisible)return null;var popover=/*#__PURE__*/_jsx(Popover,{id:\"popover-basic\",children:/*#__PURE__*/_jsxs(Popover.Body,{className:\"text-black py-2 px-3\",children:[/*#__PURE__*/_jsx(\"h5\",{children:LocalizeText('hccenter.breakdown.title')}),/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('hccenter.breakdown.creditsspent',['credits'],[kickbackData.totalCreditsSpent.toString()])}),/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('hccenter.breakdown.paydayfactor.percent',['percent'],[(kickbackData.kickbackPercentage*100).toString()])}),/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('hccenter.breakdown.streakbonus',['credits'],[kickbackData.creditRewardForStreakBonus.toString()])}),/*#__PURE__*/_jsx(\"hr\",{className:\"w-100 text-black my-1\"}),/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('hccenter.breakdown.total',['credits','actual'],[getHcPaydayAmount(),((kickbackData.kickbackPercentage*kickbackData.totalCreditsSpent+kickbackData.creditRewardForStreakBonus)*100/100).toString()])}),/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-link text-primary p-0\",onClick:function onClick(){return CreateLinkEvent('habbopages/'+GetConfiguration('hc.center')['payday.habbopage']);},children:LocalizeText('hccenter.special.infolink')})]})});return/*#__PURE__*/_jsxs(NitroCardView,{theme:\"primary-slim\",className:\"nitro-hc-center\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('generic.hccenter'),onCloseClick:function onCloseClick(){return setIsVisible(false);}}),/*#__PURE__*/_jsxs(Flex,{position:\"relative\",className:\"bg-muted p-2\",children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(\"div\",{className:\"hc-logo\"}),/*#__PURE__*/_jsx(Flex,{children:/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:function onClick(event){return CreateLinkEvent('catalog/open/'+GetConfiguration('catalog.links')['hc.buy_hc']);},children:LocalizeText(clubStatus===ClubStatus.ACTIVE?'hccenter.btn.extend':'hccenter.btn.buy')})})]}),/*#__PURE__*/_jsx(Base,{position:\"absolute\",className:\"end-0 p-4 top-0 habbo-avatar\",children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:userFigure,direction:4,scale:2})})]}),/*#__PURE__*/_jsxs(NitroCardContentView,{children:[/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:badgeCode,className:\"align-self-center flex-shrink-0 me-1\"}),/*#__PURE__*/_jsxs(Column,{size:5,className:\"streak-info\",gap:0,children:[/*#__PURE__*/_jsx(Text,{children:LocalizeText('hccenter.status.'+clubStatus)}),/*#__PURE__*/_jsx(Text,{dangerouslySetInnerHTML:{__html:getInfoText()}})]})]}),GetConfiguration('hc.center')['payday.info']&&/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Column,{className:\"rounded-start bg-primary p-2 payday-special mb-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-1\",children:LocalizeText('hccenter.special.title')}),/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('hccenter.special.info')}),/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-link text-white p-0 mt-auto align-self-baseline\",onClick:function onClick(){return CreateLinkEvent('habbopages/'+GetConfiguration('hc.center')['payday.habbopage']);},children:LocalizeText('hccenter.special.infolink')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"payday flex-shrink-0 p-2\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-2 ms-2\",children:LocalizeText('hccenter.special.time.title')}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"clock me-2\"}),/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0 align-self-center\",children:getHcPaydayTime()})]}),clubStatus===ClubStatus.ACTIVE&&/*#__PURE__*/_jsxs(\"div\",{className:\"pe-3\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"ms-2 mb-1 bolder\",children:LocalizeText('hccenter.special.amount.title')}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-100 text-center ms-4n\",children:getHcPaydayAmount()}),/*#__PURE__*/_jsx(OverlayTrigger,{trigger:['hover','focus'],placement:\"left\",overlay:popover,children:/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-link align-self-end text-primary\",children:LocalizeText('hccenter.breakdown.infolink')})})]})]})]})]}),GetConfiguration('hc.center')['gift.info']&&/*#__PURE__*/_jsxs(\"div\",{className:\"rounded bg-success p-2 d-flex flex-row mb-0\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-1\",children:LocalizeText('hccenter.gift.title')}),/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:unclaimedGifts>0?LocalizeText('hccenter.unclaimedgifts',['unclaimedgifts'],[unclaimedGifts.toString()]):LocalizeText('hccenter.gift.info')}})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-lg align-self-center ms-auto\",onClick:function onClick(){return CreateLinkEvent('catalog/open/'+GetConfiguration('catalog.links')['hc.hc_gifts']);},children:LocalizeText(clubStatus===ClubStatus.ACTIVE?'hccenter.btn.gifts.redeem':'hccenter.btn.gifts.view')})]}),GetConfiguration('hc.center')['benefits.info']&&/*#__PURE__*/_jsxs(\"div\",{className:\"benefits text-black py-2\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-1 text-primary\",children:LocalizeText('hccenter.general.title')}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",dangerouslySetInnerHTML:{__html:LocalizeText('hccenter.general.info')}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-link p-0 text-primary\",onClick:function onClick(){return CreateLinkEvent('habbopages/'+GetConfiguration('hc.center')['benefits.habbopage']);},children:LocalizeText('hccenter.general.infolink')})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}