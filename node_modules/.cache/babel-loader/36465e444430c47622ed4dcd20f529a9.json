{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ConfigurationEvent,HabboWebTools,LegacyExternalInterface,Nitro,NitroCommunicationDemoEvent,NitroEvent,NitroLocalizationEvent,NitroVersion,RoomEngineEvent,WebGL}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{GetCommunication,GetConfiguration,GetNitroInstance,GetUIVersion}from'./api';import{Base,TransitionAnimation,TransitionAnimationTypes}from'./common';import{LoadingView}from'./components/loading/LoadingView';import{MainView}from'./components/main/MainView';import{DispatchUiEvent,UseConfigurationEvent,UseLocalizationEvent,UseMainEvent,UseRoomEngineEvent}from'./hooks';import IntervalWebWorker from'./workers/IntervalWebWorker';import{WorkerBuilder}from'./workers/WorkerBuilder';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";NitroVersion.UI_VERSION=GetUIVersion();export var App=function App(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isReady=_useState2[0],setIsReady=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isError=_useState4[0],setIsError=_useState4[1];var _useState5=useState('Getting Ready'),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),percent=_useState8[0],setPercent=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),imageRendering=_useState10[0],setImageRendering=_useState10[1];if(!GetNitroInstance()){//@ts-ignore\nif(!NitroConfig)throw new Error('NitroConfig is not defined!');Nitro.bootstrap();var worker=new WorkerBuilder(IntervalWebWorker);Nitro.instance.setWorker(worker);}var handler=useCallback(function(event){switch(event.type){case ConfigurationEvent.LOADED:GetNitroInstance().localization.init();setPercent(function(prevValue){return prevValue+20;});return;case ConfigurationEvent.FAILED:setIsError(true);setMessage('Configuration Failed');return;case Nitro.WEBGL_UNAVAILABLE:setIsError(true);setMessage('WebGL Required');return;case Nitro.WEBGL_CONTEXT_LOST:setIsError(true);setMessage('WebGL Context Lost - Reloading');setTimeout(function(){return window.location.reload();},1500);return;case NitroCommunicationDemoEvent.CONNECTION_HANDSHAKING:setPercent(function(prevValue){return prevValue+20;});return;case NitroCommunicationDemoEvent.CONNECTION_HANDSHAKE_FAILED:setIsError(true);setMessage('Handshake Failed');return;case NitroCommunicationDemoEvent.CONNECTION_AUTHENTICATED:setPercent(function(prevValue){return prevValue+20;});GetNitroInstance().init();if(LegacyExternalInterface.available)LegacyExternalInterface.call('legacyTrack','authentication','authok',[]);return;case NitroCommunicationDemoEvent.CONNECTION_ERROR:setIsError(true);setMessage('Connection Error');return;case NitroCommunicationDemoEvent.CONNECTION_CLOSED://if(GetNitroInstance().roomEngine) GetNitroInstance().roomEngine.dispose();\n//setIsError(true);\nsetMessage('Connection Error');HabboWebTools.send(-1,'client.init.handshake.fail');return;case RoomEngineEvent.ENGINE_INITIALIZED:setPercent(function(prevValue){return prevValue+20;});setTimeout(function(){return setIsReady(true);},300);return;case NitroLocalizationEvent.LOADED:{var assetUrls=GetConfiguration('preload.assets.urls');var urls=[];if(assetUrls&&assetUrls.length){var _iterator=_createForOfIteratorHelper(assetUrls),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var url=_step.value;urls.push(GetNitroInstance().core.configuration.interpolate(url));}}catch(err){_iterator.e(err);}finally{_iterator.f();}}GetNitroInstance().core.asset.downloadAssets(urls,function(status){if(status){GetCommunication().init();setPercent(function(prevValue){return prevValue+20;});}else{setIsError(true);setMessage('Assets Failed');}});return;}}},[]);UseMainEvent(Nitro.WEBGL_UNAVAILABLE,handler);UseMainEvent(Nitro.WEBGL_CONTEXT_LOST,handler);UseMainEvent(NitroCommunicationDemoEvent.CONNECTION_HANDSHAKING,handler);UseMainEvent(NitroCommunicationDemoEvent.CONNECTION_HANDSHAKE_FAILED,handler);UseMainEvent(NitroCommunicationDemoEvent.CONNECTION_AUTHENTICATED,handler);UseMainEvent(NitroCommunicationDemoEvent.CONNECTION_ERROR,handler);UseMainEvent(NitroCommunicationDemoEvent.CONNECTION_CLOSED,handler);UseRoomEngineEvent(RoomEngineEvent.ENGINE_INITIALIZED,handler);UseLocalizationEvent(NitroLocalizationEvent.LOADED,handler);UseConfigurationEvent(ConfigurationEvent.LOADED,handler);UseConfigurationEvent(ConfigurationEvent.FAILED,handler);useEffect(function(){if(!WebGL.isWebGLAvailable()){DispatchUiEvent(new NitroEvent(Nitro.WEBGL_UNAVAILABLE));}else{GetNitroInstance().core.configuration.init();}var resize=function resize(event){return setImageRendering(!(window.devicePixelRatio%1));};window.addEventListener('resize',resize);resize(null);return function(){window.removeEventListener('resize',resize);};},[]);return/*#__PURE__*/_jsxs(Base,{fit:true,overflow:\"hidden\",className:imageRendering&&'image-rendering-pixelated',children:[(!isReady||isError)&&/*#__PURE__*/_jsx(LoadingView,{isError:isError,message:message,percent:percent}),/*#__PURE__*/_jsx(TransitionAnimation,{type:TransitionAnimationTypes.FADE_IN,inProp:isReady,children:/*#__PURE__*/_jsx(MainView,{})}),/*#__PURE__*/_jsx(Base,{id:\"draggable-windows-container\"})]});};","map":null,"metadata":{},"sourceType":"module"}