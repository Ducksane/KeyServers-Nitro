{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Vector3D}from'../../../../avatar/geometry/Vector3D';import{FurnitureParticleSystemParticle}from'./FurnitureParticleSystemParticle';export var FurnitureParticleSystemEmitter=/*#__PURE__*/function(_FurnitureParticleSys){_inherits(FurnitureParticleSystemEmitter,_FurnitureParticleSys);var _super=_createSuper(FurnitureParticleSystemEmitter);function FurnitureParticleSystemEmitter(){var _this;var name=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var spriteId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;_classCallCheck(this,FurnitureParticleSystemEmitter);_this=_super.call(this);_this._name=void 0;_this._roomObjectSpriteId=-1;_this._force=void 0;_this._timeStep=0.1;_this._gravity=void 0;_this._airFriction=void 0;_this._explosionShape=void 0;_this._particleConfigurations=void 0;_this._particles=void 0;_this._maxNumberOfParticles=void 0;_this._particlesPerFrame=void 0;_this._emittedParticles=void 0;_this._fuseTime=10;_this._energy=1;_this._hasIgnited=false;_this._burstPulse=1;_this._emitterDirection=void 0;_this._particles=[];_this._name=name;_this._roomObjectSpriteId=spriteId;_this._particleConfigurations=[];return _this;}_createClass(FurnitureParticleSystemEmitter,[{key:\"dispose\",value:function dispose(){var _iterator=_createForOfIteratorHelper(this._particles),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var k=_step.value;k.dispose();}}catch(err){_iterator.e(err);}finally{_iterator.f();}this._particles=null;this._particleConfigurations=null;_get(_getPrototypeOf(FurnitureParticleSystemEmitter.prototype),\"dispose\",this).call(this);}},{key:\"setup\",value:function setup(maxNumOfParticles,particlesPerFrame,force,direction,gravity,airFriction,explosionShape,energy,fuseTime,burstPulse){this._maxNumberOfParticles=maxNumOfParticles;this._particlesPerFrame=particlesPerFrame;this._force=force;this._emitterDirection=direction;this._emitterDirection.normalize();this._gravity=gravity;this._airFriction=airFriction;this._explosionShape=explosionShape;this._fuseTime=fuseTime;this._energy=energy;this._burstPulse=burstPulse;this.reset();}},{key:\"reset\",value:function reset(){var _iterator2=_createForOfIteratorHelper(this._particles),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var particle=_step2.value;particle.dispose();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}this._particles=[];this._emittedParticles=0;this._hasIgnited=false;this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,true);}},{key:\"copyStateFrom\",value:function copyStateFrom(emitter,scale){_get(_getPrototypeOf(FurnitureParticleSystemEmitter.prototype),\"copy\",this).call(this,emitter,scale);this._force=emitter._force;this._emitterDirection=emitter._emitterDirection;this._gravity=emitter._gravity;this._airFriction=emitter._airFriction;this._explosionShape=emitter._explosionShape;this._fuseTime=emitter._fuseTime;this._energy=emitter._energy;this._burstPulse=emitter._burstPulse;this._timeStep=emitter._timeStep;this._hasIgnited=emitter._hasIgnited;}},{key:\"configureParticle\",value:function configureParticle(lifeTIme,isEmitter,frames,fade){var particle={};particle.lifeTime=lifeTIme;particle.isEmitter=isEmitter;particle.frames=frames;particle.fade=fade;this._particleConfigurations.push(particle);}},{key:\"ignite\",value:function ignite(){this._hasIgnited=true;if(this._emittedParticles<this._maxNumberOfParticles){if(this.age>1)this.releaseParticles(this,this.direction);}}},{key:\"releaseParticles\",value:function releaseParticles(particle){var direction=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!direction)direction=new Vector3D();var newDirection=new Vector3D();var randomParticle=this.getRandomParticleConfiguration();var i=0;while(i<this._particlesPerFrame){switch(this._explosionShape){case FurnitureParticleSystemEmitter.CONE:newDirection.x=this.randomBoolean(0.5)?Math.random():-Math.random();newDirection.y=-(Math.random()+1);newDirection.z=this.randomBoolean(0.5)?Math.random():-Math.random();break;case FurnitureParticleSystemEmitter.PLANE:newDirection.x=this.randomBoolean(0.5)?Math.random():-Math.random();newDirection.y=0;newDirection.z=this.randomBoolean(0.5)?Math.random():-Math.random();break;case FurnitureParticleSystemEmitter.SPHERE:newDirection.x=this.randomBoolean(0.5)?Math.random():-Math.random();newDirection.y=this.randomBoolean(0.5)?Math.random():-Math.random();newDirection.z=this.randomBoolean(0.5)?Math.random():-Math.random();break;}newDirection.normalize();var newParticle=new FurnitureParticleSystemParticle();var lifeTime=0;var isEmitter=false;var fade=false;var frames=[];if(randomParticle){lifeTime=Math.floor(Math.random()*randomParticle.lifeTime+10);isEmitter=randomParticle.isEmitter;frames=randomParticle.frames;fade=randomParticle.fade;}else{lifeTime=Math.trunc(Math.floor(Math.random()*20+10));isEmitter=false;frames=[];}newParticle.init(particle.x,particle.y,particle.z,newDirection,this._energy,this._timeStep,lifeTime,isEmitter,frames,fade);this._particles.push(newParticle);this._emittedParticles++;i++;}}},{key:\"getRandomParticleConfiguration\",value:function getRandomParticleConfiguration(){var index=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[index];}},{key:\"update\",value:function update(){_get(_getPrototypeOf(FurnitureParticleSystemEmitter.prototype),\"update\",this).call(this);this.accumulateForces();this.verlet();this.satisfyConstraints();if(!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles){if(this.age%this._burstPulse===0)this.releaseParticles(this,this.direction);}}},{key:\"verlet\",value:function verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){var x=this.x;var y=this.y;var z=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX;this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep;this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ;this.lastX=x;this.lastY=y;this.lastZ=z;}var particles=[];var _iterator3=_createForOfIteratorHelper(this._particles),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _particle=_step3.value;_particle.update();var _x=_particle.x;var _y=_particle.y;var _z=_particle.z;_particle.x=(2-this._airFriction)*_particle.x-(1-this._airFriction)*_particle.lastX;_particle.y=(2-this._airFriction)*_particle.y-(1-this._airFriction)*_particle.lastY+this._gravity*this._timeStep*this._timeStep;_particle.z=(2-this._airFriction)*_particle.z-(1-this._airFriction)*_particle.lastZ;_particle.lastX=_x;_particle.lastY=_y;_particle.lastZ=_z;if(_particle.y>10||!_particle.isAlive)particles.push(_particle);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}for(var _i=0,_particles=particles;_i<_particles.length;_i++){var particle=_particles[_i];if(particle.isEmitter){//\n}this._particles.splice(this._particles.indexOf(particle),1);particle.dispose();}}},{key:\"satisfyConstraints\",value:function satisfyConstraints(){}},{key:\"accumulateForces\",value:function accumulateForces(){var _iterator4=_createForOfIteratorHelper(this._particles),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){//\nvar k=_step4.value;}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}},{key:\"particles\",get:function get(){return this._particles;}},{key:\"hasIgnited\",get:function get(){return this._hasIgnited;}},{key:\"randomBoolean\",value:function randomBoolean(k){return Math.random()<k;}},{key:\"roomObjectSpriteId\",get:function get(){return this._roomObjectSpriteId;}}]);return FurnitureParticleSystemEmitter;}(FurnitureParticleSystemParticle);FurnitureParticleSystemEmitter.CONE='cone';FurnitureParticleSystemEmitter.PLANE='plane';FurnitureParticleSystemEmitter.SPHERE='sphere';","map":null,"metadata":{},"sourceType":"module"}