{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{GroupInformationComposer,GroupInformationEvent,RoomControllerLevel,RoomObjectCategory,RoomObjectVariable,RoomWidgetEnumItemExtradataParameter,RoomWidgetFurniInfoUsagePolicyEnum,SetObjectDataMessageComposer,StringDataType}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{CreateLinkEvent,GetGroupInformation,GetRoomEngine,LocalizeText,RoomWidgetFurniActionMessage,SendMessageComposer}from'../../../../api';import{Button,Column,Flex,LayoutBadgeImageView,LayoutLimitedEditionCompactPlateView,LayoutRarityLevelView,Text,UserProfileIconView}from'../../../../common';import{UseMessageEventHook}from'../../../../hooks';import{useRoomContext}from'../../RoomContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PICKUP_MODE_NONE=0;var PICKUP_MODE_EJECT=1;var PICKUP_MODE_FULL=2;export var InfoStandWidgetFurniView=function InfoStandWidgetFurniView(props){var _props$furniData=props.furniData,furniData=_props$furniData===void 0?null:_props$furniData,_props$close=props.close,close=_props$close===void 0?null:_props$close;var _useRoomContext=useRoomContext(),_useRoomContext$roomS=_useRoomContext.roomSession,roomSession=_useRoomContext$roomS===void 0?null:_useRoomContext$roomS,_useRoomContext$event=_useRoomContext.eventDispatcher,eventDispatcher=_useRoomContext$event===void 0?null:_useRoomContext$event,_useRoomContext$widge=_useRoomContext.widgetHandler,widgetHandler=_useRoomContext$widge===void 0?null:_useRoomContext$widge;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),pickupMode=_useState2[0],setPickupMode=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),canMove=_useState4[0],setCanMove=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),canRotate=_useState6[0],setCanRotate=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),canUse=_useState8[0],setCanUse=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),furniKeys=_useState10[0],setFurniKeys=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),furniValues=_useState12[0],setFurniValues=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),customKeys=_useState14[0],setCustomKeys=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),customValues=_useState16[0],setCustomValues=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isCrackable=_useState18[0],setIsCrackable=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),crackableHits=_useState20[0],setCrackableHits=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),crackableTarget=_useState22[0],setCrackableTarget=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),godMode=_useState24[0],setGodMode=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),canSeeFurniId=_useState26[0],setCanSeeFurniId=_useState26[1];var _useState27=useState(null),_useState28=_slicedToArray(_useState27,2),groupName=_useState28[0],setGroupName=_useState28[1];useEffect(function(){var pickupMode=PICKUP_MODE_NONE;var canMove=false;var canRotate=false;var canUse=false;var furniKeyss=[];var furniValuess=[];var customKeyss=[];var customValuess=[];var isCrackable=false;var crackableHits=0;var crackableTarget=0;var godMode=false;var canSeeFurniId=false;var isValidController=furniData.roomControllerLevel>=RoomControllerLevel.GUEST;if(isValidController||furniData.isOwner||furniData.isRoomOwner||furniData.isAnyRoomController){canMove=true;canRotate=!furniData.isWallItem;if(furniData.roomControllerLevel>=RoomControllerLevel.MODERATOR)godMode=true;}if(furniData.isAnyRoomController){canSeeFurniId=true;}if(furniData.usagePolicy===RoomWidgetFurniInfoUsagePolicyEnum.EVERYBODY||furniData.usagePolicy===RoomWidgetFurniInfoUsagePolicyEnum.CONTROLLER&&isValidController||furniData.extraParam===RoomWidgetEnumItemExtradataParameter.JUKEBOX&&isValidController||furniData.extraParam===RoomWidgetEnumItemExtradataParameter.USABLE_PRODUCT&&isValidController)canUse=true;if(furniData.extraParam){if(furniData.extraParam===RoomWidgetEnumItemExtradataParameter.CRACKABLE_FURNI){var stuffData=furniData.stuffData;canUse=true;isCrackable=true;crackableHits=stuffData.hits;crackableTarget=stuffData.target;}if(godMode){var extraParam=furniData.extraParam.substr(RoomWidgetEnumItemExtradataParameter.BRANDING_OPTIONS.length);if(extraParam){var parts=extraParam.split('\\t');var _iterator=_createForOfIteratorHelper(parts),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var part=_step.value;var value=part.split('=');if(value&&value.length===2){furniKeyss.push(value[0]);furniValuess.push(value[1]);}}}catch(err){_iterator.e(err);}finally{_iterator.f();}}}}if(godMode){var roomObject=GetRoomEngine().getRoomObject(roomSession.roomId,furniData.id,furniData.isWallItem?RoomObjectCategory.WALL:RoomObjectCategory.FLOOR);if(roomObject){var customVariables=roomObject.model.getValue(RoomObjectVariable.FURNITURE_CUSTOM_VARIABLES);var furnitureData=roomObject.model.getValue(RoomObjectVariable.FURNITURE_DATA);if(customVariables&&customVariables.length){var _iterator2=_createForOfIteratorHelper(customVariables),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var customVariable=_step2.value;customKeyss.push(customVariable);customValuess.push(furnitureData[customVariable]||'');}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}}if(furniData.isOwner||furniData.isAnyRoomController)pickupMode=PICKUP_MODE_FULL;else if(furniData.isRoomOwner||furniData.roomControllerLevel>=RoomControllerLevel.GUILD_ADMIN)pickupMode=PICKUP_MODE_EJECT;if(furniData.isStickie)pickupMode=PICKUP_MODE_NONE;setPickupMode(pickupMode);setCanMove(canMove);setCanRotate(canRotate);setCanUse(canUse);setFurniKeys(furniKeyss);setFurniValues(furniValuess);setCustomKeys(customKeyss);setCustomValues(customValuess);setIsCrackable(isCrackable);setCrackableHits(crackableHits);setCrackableTarget(crackableTarget);setGodMode(godMode);setCanSeeFurniId(canSeeFurniId);setGroupName(null);if(furniData.groupId)SendMessageComposer(new GroupInformationComposer(furniData.groupId,false));},[roomSession,furniData]);var onGroupInformationEvent=useCallback(function(event){var parser=event.getParser();if(!furniData||furniData.groupId!==parser.id||parser.flag)return;if(groupName)setGroupName(null);setGroupName(parser.title);},[furniData,groupName]);UseMessageEventHook(GroupInformationEvent,onGroupInformationEvent);var onFurniSettingChange=useCallback(function(index,value){var clone=Array.from(furniValues);clone[index]=value;setFurniValues(clone);},[furniValues]);var onCustomVariableChange=useCallback(function(index,value){var clone=Array.from(customValues);clone[index]=value;setCustomValues(clone);},[customValues]);var getFurniSettingsAsString=useCallback(function(){if(furniKeys.length===0||furniValues.length===0)return'';var data='';var i=0;while(i<furniKeys.length){var key=furniKeys[i];var value=furniValues[i];data=data+(key+'='+value+'\\t');i++;}return data;},[furniKeys,furniValues]);var processButtonAction=useCallback(function(action){if(!action||action==='')return;var messageType=null;var objectData=null;switch(action){case'buy_one':CreateLinkEvent(\"catalog/open/offerId/\".concat(furniData.purchaseOfferId));return;case'move':messageType=RoomWidgetFurniActionMessage.MOVE;break;case'rotate':messageType=RoomWidgetFurniActionMessage.ROTATE;break;case'pickup':if(pickupMode===PICKUP_MODE_FULL)messageType=RoomWidgetFurniActionMessage.PICKUP;else messageType=RoomWidgetFurniActionMessage.EJECT;break;case'use':messageType=RoomWidgetFurniActionMessage.USE;break;case'save_branding_configuration':messageType=RoomWidgetFurniActionMessage.SAVE_STUFF_DATA;objectData=getFurniSettingsAsString();break;case'save_custom_variables':var map=new Map();for(var i=0;i<customKeys.length;i++){var key=customKeys[i];var value=customValues[i];if(key&&key.length&&value&&value.length)map.set(key,value);}SendMessageComposer(new SetObjectDataMessageComposer(furniData.id,map));break;}if(!messageType)return;widgetHandler.processWidgetMessage(new RoomWidgetFurniActionMessage(messageType,furniData.id,furniData.category,furniData.purchaseOfferId,objectData));},[widgetHandler,furniData,pickupMode,customKeys,customValues,getFurniSettingsAsString]);var getGroupBadgeCode=useCallback(function(){var stringDataType=furniData.stuffData;if(!stringDataType||!(stringDataType instanceof StringDataType))return null;return stringDataType.getValue(2);},[furniData]);if(!furniData)return null;return/*#__PURE__*/_jsxs(Column,{gap:1,alignItems:\"end\",children:[/*#__PURE__*/_jsxs(Column,{className:\"nitro-infostand rounded\",style:{backgroundColor:\"var(--test-galaxy)\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"nitro-infostand-title\",children:/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},small:true,wrap:true,children:furniData.name}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\",className:\"cursor-pointer\",onClick:close})]})})}),/*#__PURE__*/_jsxs(Column,{overflow:\"visible\",className:\"container-fluid content-area\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{position:\"relative\",gap:1,children:[furniData.stuffData.isUnique&&/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute end-0\",children:/*#__PURE__*/_jsx(LayoutLimitedEditionCompactPlateView,{uniqueNumber:furniData.stuffData.uniqueNumber,uniqueSeries:furniData.stuffData.uniqueSeries})}),furniData.stuffData.rarityLevel>-1&&/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute end-0\",children:/*#__PURE__*/_jsx(LayoutRarityLevelView,{level:furniData.stuffData.rarityLevel})}),furniData.image&&furniData.image.src.length&&/*#__PURE__*/_jsx(\"img\",{className:\"d-block mx-auto\",src:furniData.image.src,alt:\"\"})]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"bg-primary rounded py-1 px-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://4.bp.blogspot.com/-SG4h-ciWPJY/WWf0spNEazI/AAAAAAAA7jA/VRKVjhzjmAId1nvNeG1hlneobpeeOjVtACKgBGAs/s1600/katalogi_ikoni_special_offers.gif\"}),\" \\xA0\",/*#__PURE__*/_jsx(Text,{fullWidth:true,wrap:true,textBreak:true,variant:\"white\",small:true,children:furniData.description})]})}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",className:\"rounded py-1 px-2\",style:{backgroundColor:\"rgb(53, 196, 96)\"},children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(UserProfileIconView,{userId:furniData.ownerId}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('furni.owner',['name'],[furniData.ownerName])})]})}),furniData.purchaseOfferId>0&&/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"rounded py-1 px-2\",style:{backgroundColor:\"rgb(209, 82, 84)\"},children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://1.bp.blogspot.com/-4OnX3Id1PBA/WV-zzM-fUYI/AAAAAAAA6uo/T9IdzwyELNEKFi4FcY956S73uErSQ0nwQCKgBGAs/s1600/1904049800.png\"}),\" \\xA0\",/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,pointer:true,onClick:function onClick(event){return processButtonAction('buy_one');},children:LocalizeText('infostand.button.buy')})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[isCrackable&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.crackable_furni.hits_remaining',['hits','target'],[crackableHits.toString(),crackableTarget.toString()])})]}),furniData.groupId>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"}),/*#__PURE__*/_jsxs(Flex,{pointer:true,alignItems:\"center\",gap:2,onClick:function onClick(){return GetGroupInformation(furniData.groupId);},children:[/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:getGroupBadgeCode(),isGroup:true}),/*#__PURE__*/_jsx(Text,{variant:\"white\",underline:true,children:groupName})]})]}),godMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[canSeeFurniId&&/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",className:\"rounded py-1 px-2\",style:{backgroundColor:\"rgb(64, 64, 64)\"},children:/*#__PURE__*/_jsxs(Text,{small:true,wrap:true,variant:\"white\",children:[\"ID: \",furniData.id]})}),furniKeys.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"}),/*#__PURE__*/_jsx(Column,{gap:1,children:furniKeys.map(function(key,index){return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{small:true,wrap:true,align:\"end\",variant:\"white\",className:\"col-4\",children:key}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",value:furniValues[index],onChange:function onChange(event){return onFurniSettingChange(index,event.target.value);}})]},index);})})]})]}),customKeys.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0 my-1\"}),/*#__PURE__*/_jsx(Column,{gap:1,children:customKeys.map(function(key,index){return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{small:true,wrap:true,align:\"end\",variant:\"white\",className:\"col-4\",children:key}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",value:customValues[index],onChange:function onChange(event){return onCustomVariableChange(index,event.target.value);}})]},index);})})]})]})]})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,justifyContent:\"end\",children:[canMove&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(event){return processButtonAction('move');},children:LocalizeText('infostand.button.move')}),canRotate&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(event){return processButtonAction('rotate');},children:LocalizeText('infostand.button.rotate')}),pickupMode!==PICKUP_MODE_NONE&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(event){return processButtonAction('pickup');},children:LocalizeText(pickupMode===PICKUP_MODE_EJECT?'infostand.button.eject':'infostand.button.pickup')}),canUse&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(event){return processButtonAction('use');},children:LocalizeText('infostand.button.use')}),furniKeys.length>0&&furniValues.length>0&&furniKeys.length===furniValues.length&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(){return processButtonAction('save_branding_configuration');},children:LocalizeText('save')}),customKeys.length>0&&customValues.length>0&&customKeys.length===customValues.length&&/*#__PURE__*/_jsx(Button,{variant:\"none\",className:\"text-white\",style:{backgroundColor:\"var(--test-galaxytwo)\"},onClick:function onClick(){return processButtonAction('save_custom_variables');},children:LocalizeText('save')})]})]});};","map":null,"metadata":{},"sourceType":"module"}