{"ast":null,"code":"import _construct from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/construct.js\";import _toConsumableArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RemoveFriendComposer,SendRoomInviteComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useMemo,useState}from'react';import{AddEventLinkTracker,LocalizeText,RemoveLinkEventTracker,SendMessageComposer}from'../../../../api';import{Button,Flex,NitroCardAccordionSetView,NitroCardAccordionView,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../../../common';import{useFriends}from'../../../../hooks';import{FriendsListGroupView}from'./friends-list-group/FriendsListGroupView';import{FriendsListRequestView}from'./friends-list-request/FriendsListRequestView';import{FriendsRemoveConfirmationView}from'./FriendsListRemoveConfirmationView';import{FriendsRoomInviteView}from'./FriendsListRoomInviteView';import{FriendsSearchView}from'./FriendsListSearchView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var FriendsListView=function FriendsListView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedFriendsIds=_useState4[0],setSelectedFriendsIds=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showRoomInvite=_useState6[0],setShowRoomInvite=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showRemoveFriendsConfirmation=_useState8[0],setShowRemoveFriendsConfirmation=_useState8[1];var _useFriends=useFriends(),_useFriends$onlineFri=_useFriends.onlineFriends,onlineFriends=_useFriends$onlineFri===void 0?[]:_useFriends$onlineFri,_useFriends$offlineFr=_useFriends.offlineFriends,offlineFriends=_useFriends$offlineFr===void 0?[]:_useFriends$offlineFr,_useFriends$requests=_useFriends.requests,requests=_useFriends$requests===void 0?[]:_useFriends$requests,_useFriends$requestFr=_useFriends.requestFriend,requestFriend=_useFriends$requestFr===void 0?null:_useFriends$requestFr;var removeFriendsText=useMemo(function(){if(!selectedFriendsIds||!selectedFriendsIds.length)return'';var userNames=[];var _iterator=_createForOfIteratorHelper(selectedFriendsIds),_step;try{var _loop=function _loop(){var userId=_step.value;var existingFriend=onlineFriends.find(function(f){return f.id===userId;});if(!existingFriend)existingFriend=offlineFriends.find(function(f){return f.id===userId;});if(!existingFriend)return\"continue\";userNames.push(existingFriend.name);};for(_iterator.s();!(_step=_iterator.n()).done;){var _ret=_loop();if(_ret===\"continue\")continue;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return LocalizeText('friendlist.removefriendconfirm.userlist',['user_names'],[userNames.join(', ')]);},[offlineFriends,onlineFriends,selectedFriendsIds]);var selectFriend=useCallback(function(userId){if(userId<0)return;setSelectedFriendsIds(function(prevValue){var newValue=_toConsumableArray(prevValue);var existingUserIdIndex=newValue.indexOf(userId);if(existingUserIdIndex>-1){newValue.splice(existingUserIdIndex,1);}else{newValue.push(userId);}return newValue;});},[setSelectedFriendsIds]);var sendRoomInvite=function sendRoomInvite(message){if(selectedFriendsIds.length===0||!message||message.length===0)return;SendMessageComposer(new SendRoomInviteComposer(message,selectedFriendsIds));setShowRoomInvite(false);};var removeSelectedFriends=function removeSelectedFriends(){if(selectedFriendsIds.length===0)return;setSelectedFriendsIds(function(prevValue){SendMessageComposer(_construct(RemoveFriendComposer,_toConsumableArray(prevValue)));return[];});setShowRemoveFriendsConfirmation(false);};useEffect(function(){var linkTracker={linkReceived:function linkReceived(url){var parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':setIsVisible(true);return;case'hide':setIsVisible(false);return;case'toggle':setIsVisible(function(prevValue){return!prevValue;});return;case'request':if(parts.length<4)return;requestFriend(parseInt(parts[2]),parts[3]);}},eventUrlPrefix:'friends/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[requestFriend]);if(!isVisible)return null;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-friends animate__animated animate__bounceInUp\",uniqueKey:\"nitro-friends\",theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('friendlist.friends'),onCloseClick:function onCloseClick(event){return setIsVisible(false);}}),/*#__PURE__*/_jsxs(NitroCardContentView,{overflow:\"hidden\",gap:1,className:\"text-black p-0\",children:[/*#__PURE__*/_jsxs(NitroCardAccordionView,{fullHeight:true,overflow:\"hidden\",children:[/*#__PURE__*/_jsx(NitroCardAccordionSetView,{headerText:LocalizeText('friendlist.friends')+\" (\".concat(onlineFriends.length,\")\"),isExpanded:true,children:/*#__PURE__*/_jsx(FriendsListGroupView,{list:onlineFriends,selectedFriendsIds:selectedFriendsIds,selectFriend:selectFriend})}),/*#__PURE__*/_jsx(NitroCardAccordionSetView,{headerText:LocalizeText('friendlist.friends.offlinecaption')+\" (\".concat(offlineFriends.length,\")\"),children:/*#__PURE__*/_jsx(FriendsListGroupView,{list:offlineFriends,selectedFriendsIds:selectedFriendsIds,selectFriend:selectFriend})}),/*#__PURE__*/_jsx(FriendsListRequestView,{headerText:LocalizeText('friendlist.tab.friendrequests')+\" (\".concat(requests.length,\")\"),isExpanded:true}),/*#__PURE__*/_jsx(FriendsSearchView,{headerText:LocalizeText('people.search.title')})]}),selectedFriendsIds&&selectedFriendsIds.length>0&&/*#__PURE__*/_jsxs(Flex,{gap:1,className:\"p-1\",children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,onClick:function onClick(){return setShowRoomInvite(true);},children:LocalizeText('friendlist.tip.invite')}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"danger\",onClick:function onClick(event){return setShowRemoveFriendsConfirmation(true);},children:LocalizeText('generic.delete')})]})]})]}),showRoomInvite&&/*#__PURE__*/_jsx(FriendsRoomInviteView,{selectedFriendsIds:selectedFriendsIds,onCloseClick:function onCloseClick(){return setShowRoomInvite(false);},sendRoomInvite:sendRoomInvite}),showRemoveFriendsConfirmation&&/*#__PURE__*/_jsx(FriendsRemoveConfirmationView,{selectedFriendsIds:selectedFriendsIds,removeFriendsText:removeFriendsText,onCloseClick:function onCloseClick(){return setShowRemoveFriendsConfirmation(false);},removeSelectedFriends:removeSelectedFriends})]});};","map":null,"metadata":{},"sourceType":"module"}