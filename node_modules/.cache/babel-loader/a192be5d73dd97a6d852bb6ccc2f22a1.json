{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{NitroSettingsEvent,UserSettingsCameraFollowComposer,UserSettingsEvent,UserSettingsOldChatComposer,UserSettingsRoomInvitesComposer,UserSettingsSoundComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{AddEventLinkTracker,LocalizeText,RemoveLinkEventTracker,SendMessageComposer}from'../../api';import{Column,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../common';import{DispatchMainEvent,DispatchUiEvent,useCatalogPlaceMultipleItems,useCatalogSkipPurchaseConfirmation,UseMessageEventHook}from'../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var UserSettingsView=function UserSettingsView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),userSettings=_useState4[0],setUserSettings=_useState4[1];var _useCatalogPlaceMulti=useCatalogPlaceMultipleItems(),_useCatalogPlaceMulti2=_slicedToArray(_useCatalogPlaceMulti,2),catalogPlaceMultipleObjects=_useCatalogPlaceMulti2[0],setCatalogPlaceMultipleObjects=_useCatalogPlaceMulti2[1];var _useCatalogSkipPurcha=useCatalogSkipPurchaseConfirmation(),_useCatalogSkipPurcha2=_slicedToArray(_useCatalogSkipPurcha,2),catalogSkipPurchaseConfirmation=_useCatalogSkipPurcha2[0],setCatalogSkipPurchaseConfirmation=_useCatalogSkipPurcha2[1];var sso=new URLSearchParams(window.location.search).get('sso');var colorPrimary=\"\";var colorText=\"\";var colorSecondary=\"\";function saveColors(){var alertColor=document.getElementById(\"alertColor\");if(colorPrimary==\"\"||colorText==\"\"||colorSecondary==\"\"){alertColor.classList.remove(\"alert-warning\");alertColor.classList.add(\"alert-danger\");alertColor.innerHTML=\"Debes de seleccionar todos los colores para poder guardar los cambios.\";return;}fetch(\"https://int.lavvos.eu/?type=setColors&sso=\"+sso+\"&colorPrimary=\"+colorPrimary+\"&colorText=\"+colorText+\"&colorSecondary=\"+colorSecondary);alertColor.classList.remove(\"alert-warning\");alertColor.classList.remove(\"alert-danger\");alertColor.classList.add(\"alert-success\");alertColor.innerHTML=\"Se han guardado los cambios con Ã©xito\";}var onUserSettingsEvent=useCallback(function(event){var parser=event.getParser();var settingsEvent=new NitroSettingsEvent();settingsEvent.volumeSystem=parser.volumeSystem;settingsEvent.volumeFurni=parser.volumeFurni;settingsEvent.volumeTrax=parser.volumeTrax;settingsEvent.oldChat=parser.oldChat;settingsEvent.roomInvites=parser.roomInvites;settingsEvent.cameraFollow=parser.cameraFollow;settingsEvent.flags=parser.flags;settingsEvent.chatType=parser.chatType;setUserSettings(settingsEvent);DispatchMainEvent(settingsEvent);},[]);UseMessageEventHook(UserSettingsEvent,onUserSettingsEvent);var processAction=useCallback(function(type,value){var doUpdate=true;var clone=userSettings.clone();switch(type){case'close_view':setIsVisible(false);doUpdate=false;return;case'oldchat':clone.oldChat=value;SendMessageComposer(new UserSettingsOldChatComposer(clone.oldChat));break;case'room_invites':clone.roomInvites=value;SendMessageComposer(new UserSettingsRoomInvitesComposer(clone.roomInvites));break;case'camera_follow':clone.cameraFollow=value;SendMessageComposer(new UserSettingsCameraFollowComposer(clone.cameraFollow));break;case'system_volume':clone.volumeSystem=value;clone.volumeSystem=Math.max(0,clone.volumeSystem);clone.volumeSystem=Math.min(100,clone.volumeSystem);break;case'furni_volume':clone.volumeFurni=value;clone.volumeFurni=Math.max(0,clone.volumeFurni);clone.volumeFurni=Math.min(100,clone.volumeFurni);break;case'trax_volume':clone.volumeTrax=value;clone.volumeTrax=Math.max(0,clone.volumeTrax);clone.volumeTrax=Math.min(100,clone.volumeTrax);break;}if(doUpdate)setUserSettings(clone);DispatchMainEvent(clone);},[userSettings]);var saveRangeSlider=useCallback(function(type){switch(type){case'volume':SendMessageComposer(new UserSettingsSoundComposer(Math.round(userSettings.volumeSystem),Math.round(userSettings.volumeFurni),Math.round(userSettings.volumeTrax)));break;}},[userSettings]);function setColor(color){var r=parseInt(color.substr(1,2),16);var g=parseInt(color.substr(3,2),16);var b=parseInt(color.substr(5,2),16);document.querySelector('html').style.setProperty('--test-galaxy',\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\", .81)\"));colorPrimary=\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\", .81)\");}function setColorText(color){var r=parseInt(color.substr(1,2),16);var g=parseInt(color.substr(3,2),16);var b=parseInt(color.substr(5,2),16);document.querySelector('html').style.setProperty('--test-galaxytext',\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\")\"));colorText=\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\")\");}function setColorTwo(color){var r=parseInt(color.substr(1,2),16);var g=parseInt(color.substr(3,2),16);var b=parseInt(color.substr(5,2),16);document.querySelector('html').style.setProperty('--test-galaxytwo',\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\")\"));colorSecondary=\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\")\");}useEffect(function(){var linkTracker={linkReceived:function linkReceived(url){var parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':setIsVisible(true);return;case'hide':setIsVisible(false);return;case'toggle':setIsVisible(function(prevValue){return!prevValue;});return;}},eventUrlPrefix:'user-settings/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[]);useEffect(function(){if(!userSettings)return;DispatchUiEvent(userSettings);},[userSettings]);if(!isVisible)return null;return/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"user-settings\",className:\"user-settings-window\",theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('widget.memenu.settings.title'),onCloseClick:function onCloseClick(event){return processAction('close_view');}}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:userSettings.oldChat,onChange:function onChange(event){return processAction('oldchat',event.target.checked);}}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('memenu.settings.chat.prefer.old.chat')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:userSettings.roomInvites,onChange:function onChange(event){return processAction('room_invites',event.target.checked);}}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('memenu.settings.other.ignore.room.invites')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:userSettings.cameraFollow,onChange:function onChange(event){return processAction('camera_follow',event.target.checked);}}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('memenu.settings.other.disable.room.camera.follow')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:catalogPlaceMultipleObjects,onChange:function onChange(event){return setCatalogPlaceMultipleObjects(event.target.checked);}}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('memenu.settings.other.place.multiple.objects')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:catalogSkipPurchaseConfirmation,onChange:function onChange(event){return setCatalogSkipPurchaseConfirmation(event.target.checked);}}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('memenu.settings.other.skip.purchase.confirmation')})]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},bold:true,children:LocalizeText('widget.memenu.settings.volume')}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('widget.memenu.settings.volume.ui')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:userSettings.volumeSystem===0?'volume-mute':userSettings.volumeSystem>0?'volume-down':null,className:userSettings.volumeSystem>=50?'text-muted':''}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range w-100\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeSystem\",value:userSettings.volumeSystem,onChange:function onChange(event){return processAction('system_volume',event.target.value);},onMouseUp:function onMouseUp(){return saveRangeSlider('volume');}}),/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:\"volume-up\",className:userSettings.volumeSystem<50?'text-muted':''})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('widget.memenu.settings.volume.furni')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:userSettings.volumeFurni===0?'volume-mute':userSettings.volumeFurni>0?'volume-down':null,className:userSettings.volumeFurni>=50?'text-muted':''}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range w-100\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeFurni\",value:userSettings.volumeFurni,onChange:function onChange(event){return processAction('furni_volume',event.target.value);},onMouseUp:function onMouseUp(){return saveRangeSlider('volume');}}),/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:\"volume-up\",className:userSettings.volumeFurni<50?'text-muted':''})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:LocalizeText('widget.memenu.settings.volume.trax')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:userSettings.volumeTrax===0?'volume-mute':userSettings.volumeTrax>0?'volume-down':null,className:userSettings.volumeTrax>=50?'text-muted':''}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range w-100\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeTrax\",value:userSettings.volumeTrax,onChange:function onChange(event){return processAction('trax_volume',event.target.value);},onMouseUp:function onMouseUp(){return saveRangeSlider('volume');}}),/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{color:\"var(--test-galaxytext)\"},icon:\"volume-up\",className:userSettings.volumeTrax<50?'text-muted':''})]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},children:/*#__PURE__*/_jsx(\"b\",{children:\"Color de la interfaz\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"alertColor\",className:\"alert alert-warning\",children:\"Recuerda guardar los cambios para mantener siempre la misma configuraci\\xF3n.\"}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"b\",{style:{color:\"var(--test-galaxytext)\"},children:\"Color principal\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control form-control-color\",type:\"color\",onChange:function onChange(e){return setColor(e.target.value);}}),/*#__PURE__*/_jsx(\"b\",{style:{color:\"var(--test-galaxytext)\"},children:\"Color del texto\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control form-control-color\",type:\"color\",onChange:function onChange(e){return setColorText(e.target.value);}}),/*#__PURE__*/_jsx(\"b\",{style:{color:\"var(--test-galaxytext)\"},children:\"Color secundario\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control form-control-color\",type:\"color\",onChange:function onChange(e){return setColorTwo(e.target.value);}})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return saveColors();},className:\"btn btn-success btn-sm w-100\",children:\"Guardar\"})]})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}