{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RoomEngineObjectEvent,RoomObjectCategory,RoomObjectType}from'@nitrots/nitro-renderer';import{useCallback,useReducer,useRef,useState}from'react';import{GetRoomSession}from'../../api';import{Base,Button,DraggableWindowPosition,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../common';import{ModToolsEvent,ModToolsOpenRoomChatlogEvent,ModToolsOpenRoomInfoEvent,ModToolsOpenUserInfoEvent}from'../../events';import{DispatchUiEvent,UseRoomEngineEvent,UseUiEvent}from'../../hooks';import{ModToolsContextProvider}from'./ModToolsContext';import{ModToolsMessageHandler}from'./ModToolsMessageHandler';import{initialModTools,ModToolsActions,ModToolsReducer}from'./reducers/ModToolsReducer';import{ModToolsChatlogView}from'./views/room/ModToolsChatlogView';import{ModToolsRoomView}from'./views/room/ModToolsRoomView';import{ModToolsTicketsView}from'./views/tickets/ModToolsTicketsView';import{ModToolsUserChatlogView}from'./views/user/ModToolsUserChatlogView';import{ModToolsUserView}from'./views/user/ModToolsUserView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ModToolsView=function ModToolsView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedUser=_useState4[0],setSelectedUser=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isTicketsVisible=_useState6[0],setIsTicketsVisible=_useState6[1];var _useReducer=useReducer(ModToolsReducer,initialModTools),_useReducer2=_slicedToArray(_useReducer,2),modToolsState=_useReducer2[0],dispatchModToolsState=_useReducer2[1];var _modToolsState$curren=modToolsState.currentRoomId,currentRoomId=_modToolsState$curren===void 0?null:_modToolsState$curren,_modToolsState$openRo=modToolsState.openRooms,openRooms=_modToolsState$openRo===void 0?null:_modToolsState$openRo,_modToolsState$openRo2=modToolsState.openRoomChatlogs,openRoomChatlogs=_modToolsState$openRo2===void 0?null:_modToolsState$openRo2,_modToolsState$openUs=modToolsState.openUserChatlogs,openUserChatlogs=_modToolsState$openUs===void 0?null:_modToolsState$openUs,_modToolsState$openUs2=modToolsState.openUserInfo,openUserInfo=_modToolsState$openUs2===void 0?null:_modToolsState$openUs2;var elementRef=useRef(null);var onModToolsEvent=useCallback(function(event){switch(event.type){case ModToolsEvent.SHOW_MOD_TOOLS:setIsVisible(true);return;case ModToolsEvent.HIDE_MOD_TOOLS:setIsVisible(false);return;case ModToolsEvent.TOGGLE_MOD_TOOLS:setIsVisible(function(value){return!value;});return;}},[]);UseUiEvent(ModToolsEvent.SHOW_MOD_TOOLS,onModToolsEvent);UseUiEvent(ModToolsEvent.HIDE_MOD_TOOLS,onModToolsEvent);UseUiEvent(ModToolsEvent.TOGGLE_MOD_TOOLS,onModToolsEvent);var onRoomEngineObjectEvent=useCallback(function(event){if(event.category!==RoomObjectCategory.UNIT)return;var roomSession=GetRoomSession();if(!roomSession)return;var userData=roomSession.userDataManager.getUserDataByIndex(event.objectId);if(!userData||userData.type!==RoomObjectType.USER)return;setSelectedUser({userId:userData.webID,username:userData.name});},[]);UseRoomEngineEvent(RoomEngineObjectEvent.SELECTED,onRoomEngineObjectEvent);var handleClick=useCallback(function(action,value){if(!action)return;switch(action){case'toggle_room':{if(!openRooms){DispatchUiEvent(new ModToolsOpenRoomInfoEvent(currentRoomId));return;}if(openRooms.indexOf(currentRoomId)>-1){handleClick('close_room',currentRoomId.toString());}else{DispatchUiEvent(new ModToolsOpenRoomInfoEvent(currentRoomId));}return;}case'close_room':{var itemIndex=openRooms.indexOf(Number(value));var clone=Array.from(openRooms);clone.splice(itemIndex,1);dispatchModToolsState({type:ModToolsActions.SET_OPEN_ROOMS,payload:{openRooms:clone}});return;}case'toggle_room_chatlog':{if(!openRoomChatlogs){DispatchUiEvent(new ModToolsOpenRoomChatlogEvent(currentRoomId));return;}if(openRoomChatlogs.indexOf(currentRoomId)>-1){handleClick('close_room_chatlog',currentRoomId.toString());}else{DispatchUiEvent(new ModToolsOpenRoomChatlogEvent(currentRoomId));}return;}case'close_room_chatlog':{var _itemIndex=openRoomChatlogs.indexOf(Number(value));var _clone=Array.from(openRoomChatlogs);_clone.splice(_itemIndex,1);dispatchModToolsState({type:ModToolsActions.SET_OPEN_ROOM_CHATLOGS,payload:{openRoomChatlogs:_clone}});return;}case'toggle_user_info':{if(!selectedUser)return;var userId=selectedUser.userId;if(!openUserInfo){DispatchUiEvent(new ModToolsOpenUserInfoEvent(userId));return;}if(openUserInfo.indexOf(userId)>-1){handleClick('close_user_info',userId.toString());}else{DispatchUiEvent(new ModToolsOpenUserInfoEvent(userId));}return;}case'close_user_info':{var _itemIndex2=openUserInfo.indexOf(Number(value));var _clone2=Array.from(openUserInfo);_clone2.splice(_itemIndex2,1);dispatchModToolsState({type:ModToolsActions.SET_OPEN_USERINFO,payload:{openUserInfo:_clone2}});return;}case'close_user_chatlog':{var _itemIndex3=openUserChatlogs.indexOf(Number(value));var _clone3=Array.from(openUserChatlogs);_clone3.splice(_itemIndex3,1);dispatchModToolsState({type:ModToolsActions.SET_OPEN_USER_CHATLOGS,payload:{openUserChatlogs:_clone3}});return;}}},[openRooms,currentRoomId,openRoomChatlogs,selectedUser,openUserInfo,openUserChatlogs]);return/*#__PURE__*/_jsxs(ModToolsContextProvider,{value:{modToolsState:modToolsState,dispatchModToolsState:dispatchModToolsState},children:[/*#__PURE__*/_jsx(ModToolsMessageHandler,{}),isVisible&&/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"mod-tools\",className:\"nitro-mod-tools\",windowPosition:DraggableWindowPosition.TOP_LEFT,theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'Mod Tools',onCloseClick:function onCloseClick(event){return setIsVisible(false);}}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",gap:1,children:[/*#__PURE__*/_jsxs(Button,{gap:1,onClick:function onClick(event){return handleClick('toggle_room');},disabled:!currentRoomId,className:\"position-relative\",style:{backgroundColor:\"var(--test-galaxytwo)\"},variant:\"none\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-small-room position-absolute start-1\"}),\" Room Tool\"]}),/*#__PURE__*/_jsxs(Button,{innerRef:elementRef,gap:1,onClick:function onClick(event){return handleClick('toggle_room_chatlog');},disabled:!currentRoomId,className:\"position-relative\",style:{backgroundColor:\"var(--test-galaxytwo)\"},variant:\"none\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-chat-history position-absolute start-1\"}),\" Chatlog Tool\"]}),/*#__PURE__*/_jsxs(Button,{gap:1,onClick:function onClick(){return handleClick('toggle_user_info');},disabled:!selectedUser,className:\"position-relative\",style:{backgroundColor:\"var(--test-galaxytwo)\"},variant:\"none\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-user position-absolute start-1\"}),\" User: \",selectedUser?selectedUser.username:'']}),/*#__PURE__*/_jsxs(Button,{gap:1,onClick:function onClick(){return setIsTicketsVisible(function(value){return!value;});},className:\"position-relative\",style:{backgroundColor:\"var(--test-galaxytwo)\"},variant:\"none\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-tickets position-absolute start-1\"}),\" Report Tool\"]})]})]}),openRooms&&openRooms.map(function(roomId){return/*#__PURE__*/_jsx(ModToolsRoomView,{roomId:roomId,onCloseClick:function onCloseClick(){return handleClick('close_room',roomId.toString());}},roomId);}),openRoomChatlogs&&openRoomChatlogs.map(function(roomId){return/*#__PURE__*/_jsx(ModToolsChatlogView,{roomId:roomId,onCloseClick:function onCloseClick(){return handleClick('close_room_chatlog',roomId.toString());}},roomId);}),openUserInfo&&openUserInfo.map(function(userId){return/*#__PURE__*/_jsx(ModToolsUserView,{userId:userId,onCloseClick:function onCloseClick(){return handleClick('close_user_info',userId.toString());}},userId);}),openUserChatlogs&&openUserChatlogs.map(function(userId){return/*#__PURE__*/_jsx(ModToolsUserChatlogView,{userId:userId,onCloseClick:function onCloseClick(){return handleClick('close_user_chatlog',userId.toString());}},userId);}),isTicketsVisible&&/*#__PURE__*/_jsx(ModToolsTicketsView,{onCloseClick:function onCloseClick(){return setIsTicketsVisible(false);}})]});};","map":null,"metadata":{},"sourceType":"module"}