{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{AvatarCanvas}from'../structure/AvatarCanvas';import{AvatarSet}from'./AvatarSet';import{GeometryBodyPart}from'./GeometryBodyPart';import{Matrix4x4}from'./Matrix4x4';import{Vector3D}from'./Vector3D';export var AvatarModelGeometry=/*#__PURE__*/function(){function AvatarModelGeometry(k){_classCallCheck(this,AvatarModelGeometry);this._camera=void 0;this._avatarSet=void 0;this._geometryTypes=void 0;this._itemIdToBodyPartMap=void 0;this._transformation=void 0;this._canvases=void 0;this._camera=new Vector3D(0,0,10);this._avatarSet=new AvatarSet(k.avatarSets[0]);this._geometryTypes=new Map();this._itemIdToBodyPartMap=new Map();this._transformation=new Matrix4x4();this._canvases=new Map();var camera=k.camera;if(camera){this._camera.x=parseFloat(camera.x);this._camera.y=parseFloat(camera.y);this._camera.z=parseFloat(camera.z);}if(k.canvases&&k.canvases.length>0){var _iterator=_createForOfIteratorHelper(k.canvases),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var canvas=_step.value;if(!canvas)continue;var scale=canvas.scale;var geometries=new Map();if(canvas.geometries&&canvas.geometries.length>0){var _iterator2=_createForOfIteratorHelper(canvas.geometries),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var geometry=_step2.value;if(!geometry)continue;var avatarCanvas=new AvatarCanvas(geometry,scale);geometries.set(avatarCanvas.id,avatarCanvas);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}this._canvases.set(scale,geometries);}}catch(err){_iterator.e(err);}finally{_iterator.f();}}if(k.types&&k.types.length>0){var _iterator3=_createForOfIteratorHelper(k.types),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var type=_step3.value;if(!type)continue;var bodyParts=new Map();var itemIds=new Map();if(type.bodyParts&&type.bodyParts.length>0){var _iterator4=_createForOfIteratorHelper(type.bodyParts),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var bodyPart=_step4.value;if(!bodyPart)continue;var geometryBodyPart=new GeometryBodyPart(bodyPart);bodyParts.set(geometryBodyPart.id,geometryBodyPart);var _iterator5=_createForOfIteratorHelper(geometryBodyPart.getPartIds(null)),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var part=_step5.value;itemIds.set(part,geometryBodyPart);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}this._geometryTypes.set(type.id,bodyParts);this._itemIdToBodyPartMap.set(type.id,itemIds);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}}_createClass(AvatarModelGeometry,[{key:\"removeDynamicItems\",value:function removeDynamicItems(k){var _iterator6=_createForOfIteratorHelper(this._geometryTypes.values()),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var geometry=_step6.value;if(!geometry)continue;var _iterator7=_createForOfIteratorHelper(geometry.values()),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var part=_step7.value;if(!part)continue;part.removeDynamicParts(k);}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}},{key:\"getBodyPartIdsInAvatarSet\",value:function getBodyPartIdsInAvatarSet(k){var avatarSet=this._avatarSet.findAvatarSet(k);if(!avatarSet)return[];return avatarSet.getBodyParts();}},{key:\"isMainAvatarSet\",value:function isMainAvatarSet(k){var avatarSet=this._avatarSet.findAvatarSet(k);if(!avatarSet)return false;return avatarSet.isMain;}},{key:\"getCanvas\",value:function getCanvas(k,_arg_2){var canvas=this._canvases.get(k);if(!canvas)return null;return canvas.get(_arg_2)||null;}},{key:\"typeExists\",value:function typeExists(k){var existing=this._geometryTypes.get(k);if(existing)return true;return false;}},{key:\"hasBodyPart\",value:function hasBodyPart(k,_arg_2){if(this.typeExists(k)){var existing=this._geometryTypes.get(k);if(existing&&existing.get(_arg_2))return true;}return false;}},{key:\"getBodyPartIDs\",value:function getBodyPartIDs(k){var parts=this.getBodyPartsOfType(k);var types=[];if(parts){var _iterator8=_createForOfIteratorHelper(parts.values()),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var part=_step8.value;if(!part)continue;types.push(part.id);}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}}return types;}},{key:\"getBodyPartsOfType\",value:function getBodyPartsOfType(k){if(this.typeExists(k))return this._geometryTypes.get(k);return new Map();}},{key:\"getBodyPart\",value:function getBodyPart(k,_arg_2){return this.getBodyPartsOfType(k).get(_arg_2)||null;}},{key:\"getBodyPartOfItem\",value:function getBodyPartOfItem(k,_arg_2,_arg_3){var itemIds=this._itemIdToBodyPartMap.get(k);if(itemIds){var part=itemIds.get(_arg_2);if(part)return part;var parts=this.getBodyPartsOfType(k);if(parts){var _iterator9=_createForOfIteratorHelper(parts.values()),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _part=_step9.value;if(!_part)continue;if(_part.hasPart(_arg_2,_arg_3))return _part;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}}}return null;}},{key:\"getBodyPartsInAvatarSet\",value:function getBodyPartsInAvatarSet(k,_arg_2){var parts=this.getBodyPartIdsInAvatarSet(_arg_2);var geometryParts=[];var _iterator10=_createForOfIteratorHelper(parts),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var part=_step10.value;if(!part)continue;var bodyPart=k.get(part);if(bodyPart){geometryParts.push(bodyPart);}}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}return geometryParts;}},{key:\"getBodyPartsAtAngle\",value:function getBodyPartsAtAngle(k,_arg_2,_arg_3){if(!_arg_3)return[];var geometryParts=this.getBodyPartsOfType(_arg_3);var parts=this.getBodyPartsInAvatarSet(geometryParts,k);var sets=[];var ids=[];this._transformation=Matrix4x4.getYRotationMatrix(_arg_2);var _iterator11=_createForOfIteratorHelper(parts.values()),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var part=_step11.value;if(!part)continue;part.applyTransform(this._transformation);sets.push([part.getDistance(this._camera),part]);}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}sets.sort(function(a,b){var partA=a[0];var partB=b[0];if(partA<partB)return-1;if(partA>partB)return 1;return 0;});for(var _i=0,_sets=sets;_i<_sets.length;_i++){var set=_sets[_i];if(!set)continue;ids.push(set[1].id);}return ids;}},{key:\"getParts\",value:function getParts(k,_arg_2,_arg_3,_arg_4,_arg_5){if(this.hasBodyPart(k,_arg_2)){var part=this.getBodyPartsOfType(k).get(_arg_2);this._transformation=Matrix4x4.getYRotationMatrix(_arg_3);return part.getParts(this._transformation,this._camera,_arg_4,_arg_5);}return[];}}]);return AvatarModelGeometry;}();","map":null,"metadata":{},"sourceType":"module"}