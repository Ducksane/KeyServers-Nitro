{"ast":null,"code":"import _toConsumableArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import{CfhSanctionMessageEvent,CfhTopicsInitEvent,IssueDeletedMessageEvent,IssueInfoMessageEvent,IssuePickFailedMessageEvent,ModeratorActionResultMessageEvent,ModeratorInitMessageEvent,ModeratorToolPreferencesEvent,RoomEngineEvent}from'@nitrots/nitro-renderer';import{useCallback}from'react';import{NotificationAlertType,NotificationUtilities,PlaySound,SoundNames}from'../../api';import{ModToolsEvent}from'../../events';import{UseMessageEventHook,UseRoomEngineEvent,UseUiEvent}from'../../hooks';import{SetCfhCategories}from'./common/GetCFHCategories';import{useModToolsContext}from'./ModToolsContext';import{ModToolsActions}from'./reducers/ModToolsReducer';export var ModToolsMessageHandler=function ModToolsMessageHandler(props){var _useModToolsContext=useModToolsContext(),_useModToolsContext$m=_useModToolsContext.modToolsState,modToolsState=_useModToolsContext$m===void 0?null:_useModToolsContext$m,_useModToolsContext$d=_useModToolsContext.dispatchModToolsState,dispatchModToolsState=_useModToolsContext$d===void 0?null:_useModToolsContext$d;var _modToolsState$openRo=modToolsState.openRooms,openRooms=_modToolsState$openRo===void 0?null:_modToolsState$openRo,_modToolsState$openRo2=modToolsState.openRoomChatlogs,openRoomChatlogs=_modToolsState$openRo2===void 0?null:_modToolsState$openRo2,_modToolsState$openUs=modToolsState.openUserChatlogs,openUserChatlogs=_modToolsState$openUs===void 0?null:_modToolsState$openUs,_modToolsState$openUs2=modToolsState.openUserInfo,openUserInfo=_modToolsState$openUs2===void 0?null:_modToolsState$openUs2,_modToolsState$ticket=modToolsState.tickets,tickets=_modToolsState$ticket===void 0?null:_modToolsState$ticket;var onModeratorInitMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;var data=parser.data;dispatchModToolsState({type:ModToolsActions.SET_INIT_DATA,payload:{settings:data}});dispatchModToolsState({type:ModToolsActions.SET_TICKETS,payload:{tickets:data.issues}});},[dispatchModToolsState]);var onIssueInfoMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;var newTickets=tickets?Array.from(tickets):[];var existingIndex=newTickets.findIndex(function(entry){return entry.issueId===parser.issueData.issueId;});if(existingIndex>-1){newTickets[existingIndex]=parser.issueData;}else{newTickets.push(parser.issueData);PlaySound(SoundNames.MODTOOLS_NEW_TICKET);}dispatchModToolsState({type:ModToolsActions.SET_TICKETS,payload:{tickets:newTickets}});},[dispatchModToolsState,tickets]);var onModeratorToolPreferencesEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;},[]);var onIssuePickFailedMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;NotificationUtilities.simpleAlert('Failed to pick issue',NotificationAlertType.DEFAULT,null,null,'Error');},[]);var onIssueDeletedMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;var newTickets=tickets?Array.from(tickets):[];var existingIndex=newTickets.findIndex(function(entry){return entry.issueId===parser.issueId;});if(existingIndex===-1)return;newTickets.splice(existingIndex,1);dispatchModToolsState({type:ModToolsActions.SET_TICKETS,payload:{tickets:newTickets}});},[dispatchModToolsState,tickets]);var onModeratorActionResultMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;if(parser.success){NotificationUtilities.simpleAlert('Moderation action was successfull',NotificationAlertType.MODERATION,null,null,'Success');}else{NotificationUtilities.simpleAlert('There was a problem applying tht moderation action',NotificationAlertType.MODERATION,null,null,'Error');}},[]);var onCfhTopicsInitEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;var categories=parser.callForHelpCategories;dispatchModToolsState({type:ModToolsActions.SET_CFH_CATEGORIES,payload:{cfhCategories:categories}});SetCfhCategories(categories);},[dispatchModToolsState]);var onCfhSanctionMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;// todo: update sanction data\n},[]);UseMessageEventHook(ModeratorInitMessageEvent,onModeratorInitMessageEvent);UseMessageEventHook(IssueInfoMessageEvent,onIssueInfoMessageEvent);UseMessageEventHook(ModeratorToolPreferencesEvent,onModeratorToolPreferencesEvent);UseMessageEventHook(IssuePickFailedMessageEvent,onIssuePickFailedMessageEvent);UseMessageEventHook(IssueDeletedMessageEvent,onIssueDeletedMessageEvent);UseMessageEventHook(ModeratorActionResultMessageEvent,onModeratorActionResultMessageEvent);UseMessageEventHook(CfhTopicsInitEvent,onCfhTopicsInitEvent);UseMessageEventHook(CfhSanctionMessageEvent,onCfhSanctionMessageEvent);var onRoomEngineEvent=useCallback(function(event){switch(event.type){case RoomEngineEvent.INITIALIZED:dispatchModToolsState({type:ModToolsActions.SET_CURRENT_ROOM_ID,payload:{currentRoomId:event.roomId}});return;case RoomEngineEvent.DISPOSED:dispatchModToolsState({type:ModToolsActions.SET_CURRENT_ROOM_ID,payload:{currentRoomId:null}});return;}},[dispatchModToolsState]);UseRoomEngineEvent(RoomEngineEvent.INITIALIZED,onRoomEngineEvent);UseRoomEngineEvent(RoomEngineEvent.DISPOSED,onRoomEngineEvent);var onModToolsEvent=useCallback(function(event){switch(event.type){case ModToolsEvent.OPEN_ROOM_INFO:{var castedEvent=event;if(openRooms&&openRooms.includes(castedEvent.roomId))return;var rooms=openRooms||[];dispatchModToolsState({type:ModToolsActions.SET_OPEN_ROOMS,payload:{openRooms:[].concat(_toConsumableArray(rooms),[castedEvent.roomId])}});return;}case ModToolsEvent.OPEN_ROOM_CHATLOG:{var _castedEvent=event;if(openRoomChatlogs&&openRoomChatlogs.includes(_castedEvent.roomId))return;var chatlogs=openRoomChatlogs||[];dispatchModToolsState({type:ModToolsActions.SET_OPEN_ROOM_CHATLOGS,payload:{openRoomChatlogs:[].concat(_toConsumableArray(chatlogs),[_castedEvent.roomId])}});return;}case ModToolsEvent.OPEN_USER_INFO:{var _castedEvent2=event;if(openUserInfo&&openUserInfo.includes(_castedEvent2.userId))return;var userInfo=openUserInfo||[];dispatchModToolsState({type:ModToolsActions.SET_OPEN_USERINFO,payload:{openUserInfo:[].concat(_toConsumableArray(userInfo),[_castedEvent2.userId])}});return;}case ModToolsEvent.OPEN_USER_CHATLOG:{var _castedEvent3=event;if(openUserChatlogs&&openUserChatlogs.includes(_castedEvent3.userId))return;var userChatlog=openUserChatlogs||[];dispatchModToolsState({type:ModToolsActions.SET_OPEN_USER_CHATLOGS,payload:{openUserChatlogs:[].concat(_toConsumableArray(userChatlog),[_castedEvent3.userId])}});return;}}},[openRooms,dispatchModToolsState,openRoomChatlogs,openUserInfo,openUserChatlogs]);UseUiEvent(ModToolsEvent.OPEN_ROOM_INFO,onModToolsEvent);UseUiEvent(ModToolsEvent.OPEN_ROOM_CHATLOG,onModToolsEvent);UseUiEvent(ModToolsEvent.OPEN_USER_INFO,onModToolsEvent);UseUiEvent(ModToolsEvent.OPEN_USER_CHATLOG,onModToolsEvent);return null;};","map":null,"metadata":{},"sourceType":"module"}