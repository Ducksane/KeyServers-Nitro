{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ControlYoutubeDisplayPlaybackMessageComposer,SetYoutubeDisplayPlaylistMessageComposer,YoutubeControlVideoMessageEvent,YoutubeDisplayPlaylistsEvent,YoutubeDisplayVideoMessageEvent}from'@nitrots/nitro-renderer';import{useCallback,useMemo,useState}from'react';import YouTube from'react-youtube';import{FurnitureYoutubeDisplayWidgetHandler,LocalizeText,RoomWidgetUpdateYoutubeDisplayEvent,SendMessageComposer}from'../../../../../api';import{Grid,LayoutGridItem,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../../../../common';import{UseEventDispatcherHook,UseMessageEventHook}from'../../../../../hooks';import{useRoomContext}from'../../../RoomContext';import{YoutubeVideoPlaybackStateEnum}from'./utils/YoutubeVideoPlaybackStateEnum';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var FurnitureYoutubeDisplayView=function FurnitureYoutubeDisplayView(props){var _useState=useState(-1),_useState2=_slicedToArray(_useState,2),objectId=_useState2[0],setObjectId=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),videoId=_useState4[0],setVideoId=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),videoStart=_useState6[0],setVideoStart=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),videoEnd=_useState8[0],setVideoEnd=_useState8[1];var _useState9=useState(-1),_useState10=_slicedToArray(_useState9,2),currentVideoState=_useState10[0],setCurrentVideoState=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),selectedItem=_useState12[0],setSelectedItem=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),playlists=_useState14[0],setPlaylists=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),hasControl=_useState16[0],setHasControl=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),player=_useState18[0],setPlayer=_useState18[1];var _useRoomContext=useRoomContext(),_useRoomContext$event=_useRoomContext.eventDispatcher,eventDispatcher=_useRoomContext$event===void 0?null:_useRoomContext$event;var onRoomWidgetUpdateYoutubeDisplayEvent=useCallback(function(event){switch(event.type){case RoomWidgetUpdateYoutubeDisplayEvent.UPDATE_YOUTUBE_DISPLAY:{setObjectId(event.objectId);setHasControl(event.hasControl);}}},[]);var close=useCallback(function(){setObjectId(-1);setSelectedItem(null);setPlaylists(null);setHasControl(false);setVideoId(null);setVideoEnd(null);setVideoStart(null);setCurrentVideoState(-1);},[]);UseEventDispatcherHook(RoomWidgetUpdateYoutubeDisplayEvent.UPDATE_YOUTUBE_DISPLAY,eventDispatcher,onRoomWidgetUpdateYoutubeDisplayEvent);var onVideo=useCallback(function(event){if(objectId===-1)return;var parser=event.getParser();if(objectId!==parser.furniId)return;setVideoId(parser.videoId);setVideoStart(parser.startAtSeconds);setVideoEnd(parser.endAtSeconds);setCurrentVideoState(parser.state);},[objectId]);var onPlaylists=useCallback(function(event){if(objectId===-1)return;var parser=event.getParser();if(objectId!==parser.furniId)return;setPlaylists(parser.playlists);setSelectedItem(parser.selectedPlaylistId);setVideoId(null);setCurrentVideoState(-1);setVideoEnd(null);setVideoStart(null);},[objectId]);var onControlVideo=useCallback(function(event){if(objectId===-1)return;var parser=event.getParser();if(objectId!==parser.furniId)return;switch(parser.commandId){case 1:setCurrentVideoState(YoutubeVideoPlaybackStateEnum.PLAYING);if(player.getPlayerState()!==YoutubeVideoPlaybackStateEnum.PLAYING)player.playVideo();break;case 2:setCurrentVideoState(YoutubeVideoPlaybackStateEnum.PAUSED);if(player.getPlayerState()!==YoutubeVideoPlaybackStateEnum.PAUSED)player.pauseVideo();break;}},[objectId,player]);UseMessageEventHook(YoutubeDisplayVideoMessageEvent,onVideo);UseMessageEventHook(YoutubeDisplayPlaylistsEvent,onPlaylists);UseMessageEventHook(YoutubeControlVideoMessageEvent,onControlVideo);var processAction=useCallback(function(action){switch(action){case'playlist_prev':SendMessageComposer(new ControlYoutubeDisplayPlaybackMessageComposer(objectId,FurnitureYoutubeDisplayWidgetHandler.CONTROL_COMMAND_PREVIOUS_VIDEO));break;case'playlist_next':SendMessageComposer(new ControlYoutubeDisplayPlaybackMessageComposer(objectId,FurnitureYoutubeDisplayWidgetHandler.CONTROL_COMMAND_NEXT_VIDEO));break;case'video_pause':if(hasControl&&videoId&&videoId.length){SendMessageComposer(new ControlYoutubeDisplayPlaybackMessageComposer(objectId,FurnitureYoutubeDisplayWidgetHandler.CONTROL_COMMAND_PAUSE_VIDEO));}break;case'video_play':if(hasControl&&videoId&&videoId.length){SendMessageComposer(new ControlYoutubeDisplayPlaybackMessageComposer(objectId,FurnitureYoutubeDisplayWidgetHandler.CONTROL_COMMAND_CONTINUE_VIDEO));}break;default:if(selectedItem===action){setSelectedItem(null);SendMessageComposer(new SetYoutubeDisplayPlaylistMessageComposer(objectId,''));return;}SendMessageComposer(new SetYoutubeDisplayPlaylistMessageComposer(objectId,action));setSelectedItem(action);}},[hasControl,objectId,selectedItem,videoId]);var onReady=useCallback(function(event){setPlayer(event.target);},[]);var onStateChange=useCallback(function(event){setPlayer(event.target);if(objectId){switch(event.target.getPlayerState()){case-1:case 1:if(currentVideoState===2){//event.target.pauseVideo();\n}if(currentVideoState!==1){processAction('video_play');}return;case 2:if(currentVideoState!==2){processAction('video_pause');}}}},[currentVideoState,objectId,processAction]);var getYoutubeOpts=useMemo(function(){if(!videoStart&&!videoEnd){return{height:'375',width:'500',playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1}};}return{height:'375',width:'500',playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:videoStart,end:videoEnd}};},[videoEnd,videoStart]);if(objectId===-1)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"youtube-tv-widget\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'',onCloseClick:close}),/*#__PURE__*/_jsx(NitroCardContentView,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row w-100 h-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"youtube-video-container col-9\",children:[videoId&&videoId.length>0&&/*#__PURE__*/_jsx(YouTube,{videoId:videoId,opts:getYoutubeOpts,onReady:onReady,onStateChange:onStateChange,containerClassName:'youtubeContainer'}),(!videoId||videoId.length===0)&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-video w-100 h-100 justify-content-center align-items-center d-flex\",children:LocalizeText('widget.furni.video_viewer.no_videos')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"playlist-container col-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"playlist-controls justify-content-center d-flex\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon icon-youtube-prev cursor-pointer\",onClick:function onClick(){return processAction('playlist_prev');}}),/*#__PURE__*/_jsx(\"i\",{className:\"icon icon-youtube-next cursor-pointer\",onClick:function onClick(){return processAction('playlist_next');}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",children:LocalizeText('widget.furni.video_viewer.playlists')}),/*#__PURE__*/_jsx(Grid,{columnCount:1,className:\"playlist-grid\",children:playlists&&playlists.map(function(entry,index){return/*#__PURE__*/_jsxs(LayoutGridItem,{onClick:function onClick(){return processAction(entry.video);},itemActive:entry.video===selectedItem,children:[/*#__PURE__*/_jsx(\"b\",{children:entry.title}),\" - \",entry.description]},index);})})]})]})})]});};","map":null,"metadata":{},"sourceType":"module"}