{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{PetAddedToInventoryEvent,PetInventoryEvent,PetRemovedFromInventory,RequestPetsComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{useBetween}from'use-between';import{useInventoryUnseenTracker}from'.';import{UseMessageEventHook}from'..';import{addSinglePetItem,mergePetFragments,processPetFragment,removePetItemById,SendMessageComposer,UnseenItemCategory}from'../../api';import{useSharedVisibility}from'../useSharedVisibility';var petMsgFragments=null;var useInventoryPetsState=function useInventoryPetsState(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),needsUpdate=_useState2[0],setNeedsUpdate=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),petItems=_useState4[0],setPetItems=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),selectedPet=_useState6[0],setSelectedPet=_useState6[1];var _useSharedVisibility=useSharedVisibility(),_useSharedVisibility$=_useSharedVisibility.isVisible,isVisible=_useSharedVisibility$===void 0?false:_useSharedVisibility$,_useSharedVisibility$2=_useSharedVisibility.activate,activate=_useSharedVisibility$2===void 0?null:_useSharedVisibility$2,_useSharedVisibility$3=_useSharedVisibility.deactivate,deactivate=_useSharedVisibility$3===void 0?null:_useSharedVisibility$3;var _useInventoryUnseenTr=useInventoryUnseenTracker(),_useInventoryUnseenTr2=_useInventoryUnseenTr.isUnseen,isUnseen=_useInventoryUnseenTr2===void 0?null:_useInventoryUnseenTr2,_useInventoryUnseenTr3=_useInventoryUnseenTr.resetCategory,resetCategory=_useInventoryUnseenTr3===void 0?null:_useInventoryUnseenTr3;var onPetInventoryEvent=useCallback(function(event){var parser=event.getParser();if(!petMsgFragments)petMsgFragments=new Array(parser.totalFragments);var fragment=mergePetFragments(parser.fragment,parser.totalFragments,parser.fragmentNumber,petMsgFragments);if(!fragment)return;setPetItems(function(prevValue){var newValue=_toConsumableArray(prevValue);processPetFragment(newValue,fragment,isUnseen);return newValue;});petMsgFragments=null;},[isUnseen]);UseMessageEventHook(PetInventoryEvent,onPetInventoryEvent);var onPetAddedToInventoryEvent=useCallback(function(event){var parser=event.getParser();setPetItems(function(prevValue){var newValue=_toConsumableArray(prevValue);addSinglePetItem(parser.pet,newValue,isUnseen(UnseenItemCategory.PET,parser.pet.id));return newValue;});},[isUnseen]);UseMessageEventHook(PetAddedToInventoryEvent,onPetAddedToInventoryEvent);var onPetRemovedFromInventory=useCallback(function(event){var parser=event.getParser();setPetItems(function(prevValue){var newValue=_toConsumableArray(prevValue);removePetItemById(parser.petId,newValue);return newValue;});},[]);UseMessageEventHook(PetRemovedFromInventory,onPetRemovedFromInventory);useEffect(function(){if(!petItems||!petItems.length)return;setSelectedPet(function(prevValue){var newValue=prevValue;if(newValue&&petItems.indexOf(newValue)===-1)newValue=null;if(!newValue)newValue=petItems[0];return newValue;});},[petItems]);useEffect(function(){if(!isVisible)return;return function(){resetCategory(UnseenItemCategory.PET);};},[isVisible,resetCategory]);useEffect(function(){if(!isVisible||!needsUpdate)return;SendMessageComposer(new RequestPetsComposer());setNeedsUpdate(false);},[isVisible,needsUpdate]);return{petItems:petItems,selectedPet:selectedPet,setSelectedPet:setSelectedPet,activate:activate,deactivate:deactivate};};export var useInventoryPets=function useInventoryPets(){return useBetween(useInventoryPetsState);};","map":null,"metadata":{},"sourceType":"module"}