{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{ConvertGlobalRoomIdMessageComposer,HabboWebTools,LegacyExternalInterface,NavigatorInitComposer,NavigatorSearchComposer,RoomSessionEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{AddEventLinkTracker,DoorStateType,LocalizeText,RemoveLinkEventTracker,SendMessageComposer,TryVisitRoom}from'../../api';import{Base,Column,NitroCardContentView,NitroCardView}from'../../common';import{UseRoomSessionManagerEvent,useSharedNavigatorData}from'../../hooks';import{NavigatorContextProvider}from'./NavigatorContext';import{NavigatorMessageHandler}from'./NavigatorMessageHandler';import{NavigatorDoorStateView}from'./views/NavigatorDoorStateView';import{NavigatorRoomCreatorView}from'./views/NavigatorRoomCreatorView';import{NavigatorRoomInfoView}from'./views/NavigatorRoomInfoView';import{NavigatorRoomLinkView}from'./views/NavigatorRoomLinkView';import{NavigatorRoomSettingsView}from'./views/room-settings/NavigatorRoomSettingsView';import{NavigatorSearchResultView}from'./views/search/NavigatorSearchResultView';import{NavigatorSearchView}from'./views/search/NavigatorSearchView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var NavigatorView=function NavigatorView(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isReady=_useState4[0],setIsReady=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isCreatorOpen=_useState6[0],setCreatorOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isRoomInfoOpen=_useState8[0],setRoomInfoOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isRoomLinkOpen=_useState10[0],setRoomLinkOpen=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isLoading=_useState12[0],setIsLoading=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),needsInit=_useState14[0],setNeedsInit=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),needsSearch=_useState16[0],setNeedsSearch=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),categories=_useState18[0],setCategories=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),topLevelContext=_useState20[0],setTopLevelContext=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),topLevelContexts=_useState22[0],setTopLevelContexts=_useState22[1];var _useSharedNavigatorDa=useSharedNavigatorData(),_useSharedNavigatorDa2=_slicedToArray(_useSharedNavigatorDa,2),navigatorData=_useSharedNavigatorDa2[0],setNavigatorData=_useSharedNavigatorDa2[1];var _useState23=useState({roomInfo:null,state:DoorStateType.NONE}),_useState24=_slicedToArray(_useState23,2),doorData=_useState24[0],setDoorData=_useState24[1];var _useState25=useState(null),_useState26=_slicedToArray(_useState25,2),searchResult=_useState26[0],setSearchResult=_useState26[1];var pendingSearch=useRef(null);var onRoomSessionEvent=useCallback(function(event){switch(event.type){case RoomSessionEvent.CREATED:setIsVisible(false);setCreatorOpen(false);return;}},[]);UseRoomSessionManagerEvent(RoomSessionEvent.CREATED,onRoomSessionEvent);var sendSearch=useCallback(function(searchValue,contextCode){setCreatorOpen(false);SendMessageComposer(new NavigatorSearchComposer(contextCode,searchValue));setIsLoading(true);},[]);var reloadCurrentSearch=useCallback(function(){if(!isReady){setNeedsSearch(true);return;}if(pendingSearch.current){sendSearch(pendingSearch.current.value,pendingSearch.current.code);pendingSearch.current=null;return;}if(searchResult){sendSearch(searchResult.data,searchResult.code);return;}if(!topLevelContext)return;sendSearch('',topLevelContext.code);},[isReady,searchResult,topLevelContext,sendSearch]);var linkReceived=useCallback(function(url){var parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':{setIsVisible(true);setNeedsSearch(true);return;}case'hide':setIsVisible(false);return;case'toggle':{if(isVisible){setIsVisible(false);return;}setIsVisible(true);setNeedsSearch(true);return;}case'toggle-room-info':setRoomInfoOpen(function(value){return!value;});return;case'toggle-room-link':setRoomLinkOpen(function(value){return!value;});return;case'goto':if(parts.length<=2)return;switch(parts[2]){case'home':if(navigatorData.homeRoomId<=0)return;TryVisitRoom(navigatorData.homeRoomId);break;default:{var roomId=parseInt(parts[2]);TryVisitRoom(roomId);}}return;case'create':setIsVisible(true);setCreatorOpen(true);return;case'search':if(parts.length>2){var topLevelContextCode=parts[2];var searchValue='';if(parts.length>3)searchValue=parts[3];pendingSearch.current={value:searchValue,code:topLevelContextCode};setIsVisible(true);setNeedsSearch(true);}return;}},[isVisible,navigatorData]);useEffect(function(){var linkTracker={linkReceived:linkReceived,eventUrlPrefix:'navigator/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[linkReceived]);useEffect(function(){if(!searchResult)return;setIsLoading(false);},[searchResult]);useEffect(function(){if(!isVisible||!isReady||!needsSearch)return;reloadCurrentSearch();setNeedsSearch(false);},[isVisible,isReady,needsSearch,reloadCurrentSearch]);useEffect(function(){if(isReady||!topLevelContext)return;setIsReady(true);},[isReady,topLevelContext]);useEffect(function(){if(!isVisible||!needsInit)return;SendMessageComposer(new NavigatorInitComposer());setNeedsInit(false);},[isVisible,needsInit]);useEffect(function(){LegacyExternalInterface.addCallback(HabboWebTools.OPENROOM,function(k){var _arg_2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var _arg_3=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return SendMessageComposer(new ConvertGlobalRoomIdMessageComposer(k));});},[]);return/*#__PURE__*/_jsxs(NavigatorContextProvider,{value:{categories:categories,setCategories:setCategories,topLevelContext:topLevelContext,setTopLevelContext:setTopLevelContext,topLevelContexts:topLevelContexts,setTopLevelContexts:setTopLevelContexts,navigatorData:navigatorData,setNavigatorData:setNavigatorData,doorData:doorData,setDoorData:setDoorData,searchResult:searchResult,setSearchResult:setSearchResult},children:[/*#__PURE__*/_jsx(NavigatorMessageHandler,{}),isVisible&&/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"navigator\",className:\"nitro-navigator\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"drag-handler\",children:[/*#__PURE__*/_jsx(\"div\",{style:{padding:\"10px\",fontSize:\"21px\",fontWeight:\"bold\",color:\"var(--test-galaxytext)\",display:\"inline-block\"},children:\"Navegador\"}),topLevelContexts&&topLevelContexts.length>0&&topLevelContexts.map(function(context,index){return/*#__PURE__*/_jsx(\"div\",{style:{display:\"inline-block\",backgroundColor:\"var(--test-galaxytwo)\",padding:\"4px\",borderRadius:\"4px\",marginRight:\"5px\",cursor:\"pointer\"},onClick:function onClick(event){return sendSearch('',context.code);},children:LocalizeText('navigator.toplevelview.'+context.code)});}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"inline-block\",float:\"right\",padding:\"13px\"},children:[/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return setCreatorOpen(true);},style:{display:\"inline-block\",backgroundColor:\"#1dbf4a\",padding:\"4px\",borderRadius:\"4px\",marginRight:\"2px\",cursor:\"pointer\"},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"plus\"}),\" Crear sala\"]}),\" \\xA0\",/*#__PURE__*/_jsx(\"div\",{style:{display:\"inline-block\",backgroundColor:\"#a61c1c\",padding:\"4px\",borderRadius:\"4px\",marginRight:\"2px\",cursor:\"pointer\"},onClick:function onClick(){return setIsVisible(!isVisible);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\"})})]})]}),/*#__PURE__*/_jsxs(NitroCardContentView,{position:\"relative\",children:[isLoading&&/*#__PURE__*/_jsx(Base,{fit:true,position:\"absolute\",className:\"top-0 start-0 z-index-1 bg-muted opacity-0-5\"}),!isCreatorOpen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavigatorSearchView,{sendSearch:sendSearch}),/*#__PURE__*/_jsx(Column,{overflow:\"auto\",children:searchResult&&searchResult.results.map(function(result,index){return/*#__PURE__*/_jsx(NavigatorSearchResultView,{searchResult:result},index);})})]}),isCreatorOpen&&/*#__PURE__*/_jsx(NavigatorRoomCreatorView,{})]})]}),/*#__PURE__*/_jsx(NavigatorDoorStateView,{}),isRoomInfoOpen&&/*#__PURE__*/_jsx(NavigatorRoomInfoView,{onCloseClick:function onCloseClick(){return setRoomInfoOpen(false);}}),isRoomLinkOpen&&/*#__PURE__*/_jsx(NavigatorRoomLinkView,{onCloseClick:function onCloseClick(){return setRoomLinkOpen(false);}}),/*#__PURE__*/_jsx(NavigatorRoomSettingsView,{})]});};","map":null,"metadata":{},"sourceType":"module"}