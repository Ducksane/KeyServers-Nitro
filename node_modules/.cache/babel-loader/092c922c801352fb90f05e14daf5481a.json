{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RoomObjectCategory,RoomObjectOperationType}from'@nitrots/nitro-renderer';import{useCallback,useMemo,useState}from'react';import{CreateLinkEvent,GetRoomEngine,GetSessionDataManager,LocalizeText,ProductTypeEnum,RoomWidgetPresentOpenMessage,RoomWidgetUpdatePresentDataEvent,RoomWidgetUpdateRoomObjectEvent}from'../../../../../api';import{Button,Column,Flex,LayoutGiftTagView,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../../common';import{UseEventDispatcherHook}from'../../../../../hooks/events/UseEventDispatcherHook';import{useRoomContext}from'../../../RoomContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FLOOR='floor';var WALLPAPER='wallpaper';var LANDSCAPE='landscape';var ACTION_GIVE_GIFT=0;var ACTION_OPEN=1;var ACTION_PLACE=2;var ACTION_INVENTORY=3;export var FurnitureGiftOpeningView=function FurnitureGiftOpeningView(props){var _useState=useState(-1),_useState2=_slicedToArray(_useState,2),objectId=_useState2[0],setObjectId=_useState2[1];var _useState3=useState(-1),_useState4=_slicedToArray(_useState3,2),classId=_useState4[0],setClassId=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),itemType=_useState6[0],setItemType=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),text=_useState8[0],setText=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isOwnerOfFurniture=_useState10[0],setIsOwnerOfFurniture=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),senderName=_useState12[0],setSenderName=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),senderFigure=_useState14[0],setSenderFigure=_useState14[1];var _useState15=useState(-1),_useState16=_slicedToArray(_useState15,2),placedItemId=_useState16[0],setPlacedItemId=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),placedItemType=_useState18[0],setPlacedItemType=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),placedInRoom=_useState20[0],setPlacedInRoom=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),imageUrl=_useState22[0],setImageUrl=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),openRequested=_useState24[0],setOpenRequested=_useState24[1];var _useRoomContext=useRoomContext(),_useRoomContext$roomS=_useRoomContext.roomSession,roomSession=_useRoomContext$roomS===void 0?null:_useRoomContext$roomS,_useRoomContext$event=_useRoomContext.eventDispatcher,eventDispatcher=_useRoomContext$event===void 0?null:_useRoomContext$event,_useRoomContext$widge=_useRoomContext.widgetHandler,widgetHandler=_useRoomContext$widge===void 0?null:_useRoomContext$widge;var clearGift=useCallback(function(){if(!openRequested)setObjectId(-1);setText(null);setIsOwnerOfFurniture(false);},[openRequested]);var getGiftImageUrl=useCallback(function(name){return'';},[]);var onRoomWidgetUpdatePresentDataEvent=useCallback(function(event){switch(event.type){case RoomWidgetUpdatePresentDataEvent.PACKAGEINFO:{setOpenRequested(false);setObjectId(event.objectId);setText(event.giftMessage);setIsOwnerOfFurniture(event.isController);setSenderName(event.purchaserName);setSenderFigure(event.purchaserFigure);setImageUrl(event.imageUrl);return;}case RoomWidgetUpdatePresentDataEvent.CONTENTS_FLOOR:case RoomWidgetUpdatePresentDataEvent.CONTENTS_LANDSCAPE:case RoomWidgetUpdatePresentDataEvent.CONTENTS_WALLPAPER:{var imageType=null;if(event.type===RoomWidgetUpdatePresentDataEvent.CONTENTS_FLOOR)imageType='packagecard_icon_floor';else if(event.type===RoomWidgetUpdatePresentDataEvent.CONTENTS_LANDSCAPE)imageType='packagecard_icon_landscape';else if(event.type===RoomWidgetUpdatePresentDataEvent.CONTENTS_WALLPAPER)imageType='packagecard_icon_wallpaper';setObjectId(event.objectId);setClassId(event.classId);setItemType(event.itemType);setText(event.giftMessage);setIsOwnerOfFurniture(event.isController);setPlacedItemId(event.placedItemId);setPlacedItemType(event.placedItemType);setPlacedInRoom(event.placedInRoom);setImageUrl(getGiftImageUrl(imageType));return;}case RoomWidgetUpdatePresentDataEvent.CONTENTS_CLUB:{setObjectId(event.objectId);setClassId(event.classId);setItemType(event.itemType);setText(event.giftMessage);setIsOwnerOfFurniture(event.isController);setImageUrl(getGiftImageUrl('packagecard_icon_hc'));return;}case RoomWidgetUpdatePresentDataEvent.CONTENTS:{if(!openRequested)return;setObjectId(event.objectId);setClassId(event.classId);setItemType(event.itemType);setText(event.giftMessage);setIsOwnerOfFurniture(event.isController);setPlacedItemId(event.placedItemId);setPlacedItemType(event.placedItemType);setPlacedInRoom(event.placedInRoom);setImageUrl(event.imageUrl);return;}case RoomWidgetUpdatePresentDataEvent.CONTENTS_IMAGE:{if(!openRequested)return;setImageUrl(event.imageUrl);}}},[openRequested,getGiftImageUrl]);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.PACKAGEINFO,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS_FLOOR,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS_LANDSCAPE,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS_WALLPAPER,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS_CLUB,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);UseEventDispatcherHook(RoomWidgetUpdatePresentDataEvent.CONTENTS_IMAGE,eventDispatcher,onRoomWidgetUpdatePresentDataEvent);var onRoomWidgetRoomObjectUpdateEvent=useCallback(function(event){if(event.id===objectId)clearGift();if(event.id===placedItemId){if(placedInRoom)setPlacedInRoom(false);}},[objectId,placedItemId,placedInRoom,clearGift]);UseEventDispatcherHook(RoomWidgetUpdateRoomObjectEvent.FURNI_REMOVED,eventDispatcher,onRoomWidgetRoomObjectUpdateEvent);var close=useCallback(function(){setObjectId(-1);setOpenRequested(false);setPlacedItemId(-1);setPlacedInRoom(false);setText(null);setIsOwnerOfFurniture(false);},[]);var isSpaces=useMemo(function(){if(itemType!==ProductTypeEnum.WALL)return false;var furniData=GetSessionDataManager().getWallItemData(classId);if(!furniData)return false;var className=furniData.className;return className===FLOOR||className===LANDSCAPE||className===WALLPAPER;},[classId,itemType]);var productName=useMemo(function(){if(objectId===-1)return'';if(isSpaces)return'widget.furni.present.spaces.message_opened';return'widget.furni.present.message_opened';},[objectId,isSpaces]);var handleAction=useCallback(function(action){switch(action){case ACTION_GIVE_GIFT:CreateLinkEvent('catalog/open');return;case ACTION_OPEN:setOpenRequested(true);widgetHandler.processWidgetMessage(new RoomWidgetPresentOpenMessage(RoomWidgetPresentOpenMessage.OPEN_PRESENT,objectId));return;case ACTION_PLACE:return;case ACTION_INVENTORY:if(placedItemId>0&&placedInRoom){if(placedItemType===ProductTypeEnum.PET){roomSession.pickupPet(placedItemId);}else{var roomObject=GetRoomEngine().getRoomObject(roomSession.roomId,placedItemId,RoomObjectCategory.FLOOR);if(roomObject)GetRoomEngine().processRoomObjectOperation(roomObject.id,RoomObjectCategory.FLOOR,RoomObjectOperationType.OBJECT_PICKUP);}}close();return;}},[roomSession,widgetHandler,objectId,placedInRoom,placedItemId,placedItemType,close]);if(objectId===-1)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-gift-opening\",theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText(senderName?'widget.furni.present.window.title_from':'widget.furni.present.window.title',['name'],[senderName]),onCloseClick:close}),/*#__PURE__*/_jsxs(NitroCardContentView,{center:true,children:[placedItemId===-1&&/*#__PURE__*/_jsxs(Column,{overflow:\"hidden\",children:[/*#__PURE__*/_jsx(Flex,{center:true,overflow:\"auto\",children:/*#__PURE__*/_jsx(LayoutGiftTagView,{userName:senderName,figure:senderFigure,message:text})}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[senderName&&/*#__PURE__*/_jsx(Button,{fullWidth:true,onClick:function onClick(event){return handleAction(ACTION_GIVE_GIFT);},children:LocalizeText('widget.furni.present.give_gift',['name'],[senderName])}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"success\",onClick:function onClick(event){return handleAction(ACTION_OPEN);},children:LocalizeText('widget.furni.present.open_gift')})]})]}),placedItemId>-1&&/*#__PURE__*/_jsxs(Column,{overflow:\"hidden\",children:[/*#__PURE__*/_jsxs(Flex,{center:true,overflow:\"auto\",gap:2,children:[/*#__PURE__*/_jsx(\"img\",{src:imageUrl,className:\"no-select\",alt:\"\"}),/*#__PURE__*/_jsx(Text,{wrap:true,children:LocalizeText(productName,['product'],[text])})]}),/*#__PURE__*/_jsxs(Column,{grow:true,gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,onClick:function onClick(event){return handleAction(ACTION_INVENTORY);},children:LocalizeText('widget.furni.present.put_in_inventory')}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"success\",onClick:function onClick(event){return handleAction(ACTION_PLACE);},children:LocalizeText(placedInRoom?'widget.furni.present.keep_in_room':'widget.furni.present.place_in_room')})]}),senderName&&senderName.length&&/*#__PURE__*/_jsx(Button,{fullWidth:true,onClick:function onClick(event){return handleAction(ACTION_GIVE_GIFT);},children:LocalizeText('widget.furni.present.give_gift',['name'],[senderName])})]})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}