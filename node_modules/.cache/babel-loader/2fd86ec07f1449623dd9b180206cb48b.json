{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Disposable}from'../../core/common/disposable/Disposable';import{RequestPetInfoComposer}from'../communication/messages/outgoing/pet/RequestPetInfoComposer';import{UserCurrentBadgesComposer}from'../communication/messages/outgoing/user/data/UserCurrentBadgesComposer';export var UserDataManager=/*#__PURE__*/function(_Disposable){_inherits(UserDataManager,_Disposable);var _super=_createSuper(UserDataManager);function UserDataManager(){var _this;_classCallCheck(this,UserDataManager);_this=_super.call(this);_this._connection=void 0;_this._userDataByType=void 0;_this._userDataByRoomIndex=void 0;_this._userBadges=void 0;_this._connection=null;_this._userDataByType=new Map();_this._userDataByRoomIndex=new Map();_this._userBadges=new Map();return _this;}_createClass(UserDataManager,[{key:\"onDispose\",value:function onDispose(){this._connection=null;}},{key:\"setConnection\",value:function setConnection(connection){this._connection=connection;}},{key:\"getUserData\",value:function getUserData(webID){return this.getDataByType(webID,UserDataManager.TYPE_USER);}},{key:\"getPetData\",value:function getPetData(webID){return this.getDataByType(webID,UserDataManager.TYPE_PET);}},{key:\"getBotData\",value:function getBotData(webID){return this.getDataByType(webID,UserDataManager.TYPE_BOT);}},{key:\"getRentableBotData\",value:function getRentableBotData(webID){return this.getDataByType(webID,UserDataManager.TYPE_RENTABLE_BOT);}},{key:\"getDataByType\",value:function getDataByType(webID,type){var existing=this._userDataByType.get(type);if(!existing)return null;var userData=existing.get(webID);if(!userData)return null;return userData;}},{key:\"getUserDataByIndex\",value:function getUserDataByIndex(roomIndex){var existing=this._userDataByRoomIndex.get(roomIndex);if(!existing)return null;return existing;}},{key:\"getUserDataByName\",value:function getUserDataByName(name){var _iterator=_createForOfIteratorHelper(this._userDataByRoomIndex.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var userData=_step.value;if(!userData||userData.name!==name)continue;return userData;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return null;}},{key:\"updateUserData\",value:function updateUserData(data){if(!data)return;this.removeUserData(data.roomIndex);var existingType=this._userDataByType.get(data.type);if(!existingType){existingType=new Map();this._userDataByType.set(data.type,existingType);}existingType.set(data.webID,data);this._userDataByRoomIndex.set(data.roomIndex,data);}},{key:\"removeUserData\",value:function removeUserData(roomIndex){var existing=this.getUserDataByIndex(roomIndex);if(!existing)return;this._userDataByRoomIndex.delete(roomIndex);var existingType=this._userDataByType.get(existing.type);if(existingType)existingType.delete(existing.webID);}},{key:\"getUserBadges\",value:function getUserBadges(userId){if(this._connection){this._connection.send(new UserCurrentBadgesComposer(userId));}var badges=this._userBadges.get(userId);if(!badges)return[];return badges;}},{key:\"setUserBadges\",value:function setUserBadges(userId,badges){this._userBadges.set(userId,badges);}},{key:\"updateFigure\",value:function updateFigure(roomIndex,figure,sex,hasSaddle,isRiding){var userData=this.getUserDataByIndex(roomIndex);if(!userData)return;userData.figure=figure;userData.sex=sex;userData.hasSaddle=hasSaddle;userData.isRiding=isRiding;}},{key:\"updateName\",value:function updateName(roomIndex,name){var userData=this.getUserDataByIndex(roomIndex);if(!userData)return;userData.name=name;}},{key:\"updateMotto\",value:function updateMotto(roomIndex,custom){var userData=this.getUserDataByIndex(roomIndex);if(!userData)return;userData.custom=custom;}},{key:\"updateAchievementScore\",value:function updateAchievementScore(roomIndex,score){var userData=this.getUserDataByIndex(roomIndex);if(!userData)return;userData.activityPoints=score;}},{key:\"updatePetLevel\",value:function updatePetLevel(roomIndex,level){var userData=this.getUserDataByIndex(roomIndex);if(userData)userData.petLevel=level;}},{key:\"updatePetBreedingStatus\",value:function updatePetBreedingStatus(roomIndex,canBreed,canHarvest,canRevive,hasBreedingPermission){var userData=this.getUserDataByIndex(roomIndex);if(!userData)return;userData.canBreed=canBreed;userData.canHarvest=canHarvest;userData.canRevive=canRevive;userData.hasBreedingPermission=hasBreedingPermission;}},{key:\"requestPetInfo\",value:function requestPetInfo(id){if(!this._connection)return;var petData=this.getPetData(id);if(!petData)return;this._connection.send(new RequestPetInfoComposer(id));}},{key:\"connection\",get:function get(){return this._connection;}}]);return UserDataManager;}(Disposable);UserDataManager.TYPE_USER=1;UserDataManager.TYPE_PET=2;UserDataManager.TYPE_BOT=3;UserDataManager.TYPE_RENTABLE_BOT=4;","map":null,"metadata":{},"sourceType":"module"}