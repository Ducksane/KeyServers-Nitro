{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{BuildersClubFurniCountMessageEvent,BuildersClubPlaceRoomItemMessageComposer,BuildersClubPlaceWallItemMessageComposer,BuildersClubQueryFurniCountMessageComposer,BuildersClubSubscriptionStatusMessageEvent,CatalogPageMessageEvent,CatalogPagesListEvent,CatalogPublishedMessageEvent,ClubGiftInfoEvent,FurniturePlaceComposer,FurniturePlacePaintComposer,GetCatalogIndexComposer,GetCatalogPageComposer,GetClubGiftInfo,GetGiftWrappingConfigurationComposer,GiftWrappingConfigurationEvent,GuildMembershipsMessageEvent,HabboClubOffersMessageEvent,LegacyDataType,LimitedEditionSoldOutEvent,MarketplaceMakeOfferResult,ProductOfferEvent,PurchaseErrorMessageEvent,PurchaseFromCatalogComposer,PurchaseNotAllowedMessageEvent,PurchaseOKMessageEvent,RoomControllerLevel,RoomEngineObjectPlacedEvent,RoomObjectCategory,RoomObjectPlacementSource,RoomObjectType,RoomObjectVariable,RoomPreviewer,SellablePetPalettesMessageEvent,Vector3d}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{useBetween}from'use-between';import{BuilderFurniPlaceableStatus,CatalogNode,CatalogPage,CatalogPetPalette,CatalogType,CreateLinkEvent,FurniCategory,GetFurnitureData,GetNitroInstance,GetProductDataForLocalization,GetRoomEngine,GetRoomSession,GiftWrappingConfiguration,LocalizeText,NotificationAlertType,NotificationUtilities,Offer,PageLocalization,PlacedObjectPurchaseData,PlaySound,Product,ProductTypeEnum,RequestedPage,SendMessageComposer,SoundNames}from'../../api';import{CatalogPurchasedEvent,CatalogPurchaseFailureEvent,CatalogPurchaseNotAllowedEvent,CatalogPurchaseSoldOutEvent,InventoryFurniAddedEvent}from'../../events';import{DispatchUiEvent,UseRoomEngineEvent,UseUiEvent}from'../events';import{UseMessageEventHook}from'../messages';import{useCatalogPlaceMultipleItems}from'./useCatalogPlaceMultipleItems';import{useCatalogSkipPurchaseConfirmation}from'./useCatalogSkipPurchaseConfirmation';var DUMMY_PAGE_ID_FOR_OFFER_SEARCH=-12345678;var DRAG_AND_DROP_ENABLED=true;var useCatalogState=function useCatalogState(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isBusy=_useState4[0],setIsBusy=_useState4[1];var _useState5=useState(-1),_useState6=_slicedToArray(_useState5,2),pageId=_useState6[0],setPageId=_useState6[1];var _useState7=useState(-1),_useState8=_slicedToArray(_useState7,2),previousPageId=_useState8[0],setPreviousPageId=_useState8[1];var _useState9=useState(CatalogType.NORMAL),_useState10=_slicedToArray(_useState9,2),currentType=_useState10[0],setCurrentType=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),rootNode=_useState12[0],setRootNode=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),offersToNodes=_useState14[0],setOffersToNodes=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),currentPage=_useState16[0],setCurrentPage=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),currentOffer=_useState18[0],setCurrentOffer=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),activeNodes=_useState20[0],setActiveNodes=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),searchResult=_useState22[0],setSearchResult=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),frontPageItems=_useState24[0],setFrontPageItems=_useState24[1];var _useState25=useState(null),_useState26=_slicedToArray(_useState25,2),roomPreviewer=_useState26[0],setRoomPreviewer=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),navigationHidden=_useState28[0],setNavigationHidden=_useState28[1];var _useState29=useState({quantity:1,extraData:null,extraParamRequired:false,previewStuffData:null}),_useState30=_slicedToArray(_useState29,2),purchaseOptions=_useState30[0],setPurchaseOptions=_useState30[1];var _useState31=useState({}),_useState32=_slicedToArray(_useState31,2),catalogOptions=_useState32[0],setCatalogOptions=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),objectMoverRequested=_useState34[0],setObjectMoverRequested=_useState34[1];var _useCatalogPlaceMulti=useCatalogPlaceMultipleItems(),_useCatalogPlaceMulti2=_slicedToArray(_useCatalogPlaceMulti,2),catalogPlaceMultipleObjects=_useCatalogPlaceMulti2[0],setCatalogPlaceMultipleObjects=_useCatalogPlaceMulti2[1];var _useCatalogSkipPurcha=useCatalogSkipPurchaseConfirmation(),_useCatalogSkipPurcha2=_slicedToArray(_useCatalogSkipPurcha,2),catalogSkipPurchaseConfirmation=_useCatalogSkipPurcha2[0],setCatalogSkipPurchaseConfirmation=_useCatalogSkipPurcha2[1];var _useState35=useState(null),_useState36=_slicedToArray(_useState35,2),purchasableOffer=_useState36[0],setPurchaseableOffer=_useState36[1];var _useState37=useState(null),_useState38=_slicedToArray(_useState37,2),placedObjectPurchaseData=_useState38[0],setPlacedObjectPurchaseData=_useState38[1];var _useState39=useState(0),_useState40=_slicedToArray(_useState39,2),furniCount=_useState40[0],setFurniCount=_useState40[1];var _useState41=useState(0),_useState42=_slicedToArray(_useState41,2),furniLimit=_useState42[0],setFurniLimit=_useState42[1];var _useState43=useState(0),_useState44=_slicedToArray(_useState43,2),maxFurniLimit=_useState44[0],setMaxFurniLimit=_useState44[1];var _useState45=useState(0),_useState46=_slicedToArray(_useState45,2),secondsLeft=_useState46[0],setSecondsLeft=_useState46[1];var _useState47=useState(0),_useState48=_slicedToArray(_useState47,2),updateTime=_useState48[0],setUpdateTime=_useState48[1];var _useState49=useState(0),_useState50=_slicedToArray(_useState49,2),secondsLeftWithGrace=_useState50[0],setSecondsLeftWithGrace=_useState50[1];var requestedPage=useRef(new RequestedPage());var resetState=useCallback(function(){setPageId(-1);setPreviousPageId(-1);setRootNode(null);setOffersToNodes(null);setCurrentPage(null);setCurrentOffer(null);setActiveNodes([]);setSearchResult(null);setFrontPageItems([]);setIsVisible(false);},[]);var getBuilderFurniPlaceableStatus=useCallback(function(offer){if(!offer)return BuilderFurniPlaceableStatus.MISSING_OFFER;if(furniCount<0||furniCount>=furniLimit)return BuilderFurniPlaceableStatus.FURNI_LIMIT_REACHED;var roomSession=GetRoomSession();if(!roomSession)return BuilderFurniPlaceableStatus.NOT_IN_ROOM;if(!roomSession.isRoomOwner)return BuilderFurniPlaceableStatus.NOT_ROOM_OWNER;if(secondsLeft<=0){var roomEngine=GetRoomEngine();var objectCount=roomEngine.getRoomObjectCount(roomSession.roomId,RoomObjectCategory.UNIT);while(objectCount>0){var roomObject=roomEngine.getRoomObjectByIndex(roomSession.roomId,objectCount,RoomObjectCategory.UNIT);var userData=roomSession.userDataManager.getUserDataByIndex(roomObject.id);if(userData&&userData.type===RoomObjectType.USER&&userData.roomIndex!==roomSession.ownRoomIndex&&!userData.isModerator)return BuilderFurniPlaceableStatus.VISITORS_IN_ROOM;objectCount--;}}return BuilderFurniPlaceableStatus.OKAY;},[furniCount,furniLimit,secondsLeft]);var isDraggable=useCallback(function(offer){var roomSession=GetRoomSession();if((DRAG_AND_DROP_ENABLED&&roomSession&&offer.page&&offer.page.layoutCode!=='sold_ltd_items'&&currentType===CatalogType.NORMAL&&(roomSession.isRoomOwner||roomSession.isGuildRoom&&roomSession.controllerLevel>=RoomControllerLevel.GUILD_MEMBER)||currentType===CatalogType.BUILDER&&getBuilderFurniPlaceableStatus(offer)===BuilderFurniPlaceableStatus.OKAY)&&offer.pricingModel!==Offer.PRICING_MODEL_BUNDLE&&offer.product.productType!==ProductTypeEnum.EFFECT&&offer.product.productType!==ProductTypeEnum.HABBO_CLUB)return true;return false;},[currentType,getBuilderFurniPlaceableStatus]);var requestOfferToMover=useCallback(function(offer){if(!isDraggable(offer))return;var product=offer.product;if(!product)return;var category=0;switch(product.productType){case ProductTypeEnum.FLOOR:category=RoomObjectCategory.FLOOR;break;case ProductTypeEnum.WALL:category=RoomObjectCategory.WALL;break;}if(GetRoomEngine().processRoomObjectPlacement(RoomObjectPlacementSource.CATALOG,-offer.offerId,category,product.productClassId,product.extraParam)){setPurchaseableOffer(offer);setObjectMoverRequested(true);setIsVisible(false);}},[isDraggable]);var resetRoomPaint=useCallback(function(planeType,type){var roomEngine=GetRoomEngine();var wallType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_WALL_TYPE);var floorType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_FLOOR_TYPE);var landscapeType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_LANDSCAPE_TYPE);wallType=wallType&&wallType.length?wallType:'101';floorType=floorType&&floorType.length?floorType:'101';landscapeType=landscapeType&&landscapeType.length?landscapeType:'1.1';switch(planeType){case'floor':roomEngine.updateRoomInstancePlaneType(roomEngine.activeRoomId,type,wallType,landscapeType,true);return;case'wallpaper':roomEngine.updateRoomInstancePlaneType(roomEngine.activeRoomId,floorType,type,landscapeType,true);return;case'landscape':roomEngine.updateRoomInstancePlaneType(roomEngine.activeRoomId,floorType,wallType,type,true);return;default:roomEngine.updateRoomInstancePlaneType(roomEngine.activeRoomId,floorType,wallType,landscapeType,true);return;}},[]);var cancelObjectMover=useCallback(function(){if(!purchasableOffer)return;GetRoomEngine().cancelRoomObjectInsert();setObjectMoverRequested(false);setPurchaseableOffer(null);},[purchasableOffer]);var resetObjectMover=useCallback(function(){var flag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setObjectMoverRequested(function(prevValue){if(prevValue&&flag){CreateLinkEvent('catalog/open');}return false;});},[]);var resetPlacedOfferData=useCallback(function(){var flag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!flag)resetObjectMover();setPlacedObjectPurchaseData(function(prevValue){if(prevValue){switch(prevValue.category){case RoomObjectCategory.FLOOR:GetRoomEngine().removeRoomObjectFloor(prevValue.roomId,prevValue.objectId);break;case RoomObjectCategory.WALL:{switch(prevValue.furniData.className){case'floor':case'wallpaper':case'landscape':resetRoomPaint('reset','');break;default:GetRoomEngine().removeRoomObjectWall(prevValue.roomId,prevValue.objectId);break;}break;}default:GetRoomEngine().deleteRoomObject(prevValue.objectId,prevValue.category);break;}}return null;});},[resetObjectMover,resetRoomPaint]);var getNodeById=useCallback(function(id,node){if(node.pageId===id&&node!==rootNode)return node;var _iterator=_createForOfIteratorHelper(node.children),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var child=_step.value;var found=getNodeById(id,child);if(found)return found;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return null;},[rootNode]);var getNodeByName=useCallback(function(name,node){if(node.pageName===name&&node!==rootNode)return node;var _iterator2=_createForOfIteratorHelper(node.children),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var child=_step2.value;var found=getNodeByName(name,child);if(found)return found;}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return null;},[rootNode]);var getNodesByOfferId=useCallback(function(offerId){var flag=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!offersToNodes||!offersToNodes.size)return null;if(flag){var nodes=[];var offers=offersToNodes.get(offerId);if(offers&&offers.length){var _iterator3=_createForOfIteratorHelper(offers),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var offer=_step3.value;offer.isVisible&&nodes.push(offer);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}if(nodes.length)return nodes;}return offersToNodes.get(offerId);},[offersToNodes]);var loadCatalogPage=useCallback(function(pageId,offerId){if(pageId<0)return;setIsBusy(true);setPageId(pageId);if(pageId>-1)SendMessageComposer(new GetCatalogPageComposer(pageId,offerId,currentType));},[currentType]);var showCatalogPage=useCallback(function(pageId,layoutCode,localization,offers,offerId,acceptSeasonCurrencyAsCredits){var catalogPage=new CatalogPage(pageId,layoutCode,localization,offers,acceptSeasonCurrencyAsCredits);setCurrentPage(catalogPage);setPreviousPageId(function(prevValue){return pageId!==-1?pageId:prevValue;});setNavigationHidden(false);if(offerId>-1&&catalogPage.offers.length){var _iterator4=_createForOfIteratorHelper(catalogPage.offers),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var offer=_step4.value;if(offer.offerId!==offerId)continue;setCurrentOffer(offer);break;}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}},[]);var activateNode=useCallback(function(targetNode){var offerId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;cancelObjectMover();if(targetNode.parent.pageName==='root'){if(targetNode.children.length){var _iterator5=_createForOfIteratorHelper(targetNode.children),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var child=_step5.value;if(!child.isVisible)continue;targetNode=child;break;}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}}var nodes=[];var node=targetNode;while(node&&node.pageName!=='root'){nodes.push(node);node=node.parent;}nodes.reverse();setActiveNodes(function(prevValue){var isActive=prevValue.indexOf(targetNode)>=0;var isOpen=targetNode.isOpen;var _iterator6=_createForOfIteratorHelper(prevValue),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var existing=_step6.value;existing.deactivate();if(nodes.indexOf(existing)===-1)existing.close();}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}var _iterator7=_createForOfIteratorHelper(nodes),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var n=_step7.value;n.activate();if(n.parent)n.open();if(n===targetNode.parent&&n.children.length)n.open();}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}if(isActive&&isOpen)targetNode.close();else targetNode.open();return nodes;});if(targetNode.pageId>-1)loadCatalogPage(targetNode.pageId,offerId);},[setActiveNodes,loadCatalogPage,cancelObjectMover]);var openPageById=useCallback(function(id){setSearchResult(null);if(!isVisible){requestedPage.current.requestById=id;setIsVisible(true);}else{var node=getNodeById(id,rootNode);if(node)activateNode(node);}},[isVisible,rootNode,getNodeById,activateNode]);var openPageByName=useCallback(function(name){setSearchResult(null);if(!isVisible){requestedPage.current.requestByName=name;setIsVisible(true);}else{var node=getNodeByName(name,rootNode);if(node)activateNode(node);}},[isVisible,rootNode,getNodeByName,activateNode]);var openPageByOfferId=useCallback(function(offerId){setSearchResult(null);if(!isVisible){requestedPage.current.requestedByOfferId=offerId;setIsVisible(true);}else{var nodes=getNodesByOfferId(offerId);if(!nodes||!nodes.length)return;activateNode(nodes[0],offerId);}},[isVisible,getNodesByOfferId,activateNode]);var refreshBuilderStatus=useCallback(function(){},[]);var onCatalogPagesListEvent=useCallback(function(event){var parser=event.getParser();var offers=new Map();var getCatalogNode=function getCatalogNode(node,depth,parent){var catalogNode=new CatalogNode(node,depth,parent);var _iterator8=_createForOfIteratorHelper(catalogNode.offerIds),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var offerId=_step8.value;if(offers.has(offerId))offers.get(offerId).push(catalogNode);else offers.set(offerId,[catalogNode]);}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}depth++;var _iterator9=_createForOfIteratorHelper(node.children),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var child=_step9.value;catalogNode.addChild(getCatalogNode(child,depth,catalogNode));}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return catalogNode;};setRootNode(getCatalogNode(parser.root,0,null));setOffersToNodes(offers);},[setRootNode,setOffersToNodes]);UseMessageEventHook(CatalogPagesListEvent,onCatalogPagesListEvent);var onCatalogPageMessageEvent=useCallback(function(event){var parser=event.getParser();if(parser.catalogType!==currentType)return;var purchasableOffers=[];var _iterator10=_createForOfIteratorHelper(parser.offers),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var offer=_step10.value;var products=[];var productData=GetProductDataForLocalization(offer.localizationId);var _iterator11=_createForOfIteratorHelper(offer.products),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var product=_step11.value;var furnitureData=GetFurnitureData(product.furniClassId,product.productType);products.push(new Product(product.productType,product.furniClassId,product.extraParam,product.productCount,productData,furnitureData,product.uniqueLimitedItem,product.uniqueLimitedSeriesSize,product.uniqueLimitedItemsLeft));}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}if(!products.length)continue;var _purchasableOffer=new Offer(offer.offerId,offer.localizationId,offer.rent,offer.priceCredits,offer.priceActivityPoints,offer.priceActivityPointsType,offer.giftable,offer.clubLevel,products,offer.bundlePurchaseAllowed);if(currentType===CatalogType.NORMAL||_purchasableOffer.pricingModel!==Offer.PRICING_MODEL_BUNDLE&&_purchasableOffer.pricingModel!==Offer.PRICING_MODEL_MULTI)purchasableOffers.push(_purchasableOffer);}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}if(parser.frontPageItems&&parser.frontPageItems.length)setFrontPageItems(parser.frontPageItems);setIsBusy(false);if(pageId===parser.pageId){showCatalogPage(parser.pageId,parser.layoutCode,new PageLocalization(parser.localization.images.concat(),parser.localization.texts.concat()),purchasableOffers,parser.offerId,parser.acceptSeasonCurrencyAsCredits);}},[currentType,pageId,setFrontPageItems,setIsBusy,showCatalogPage]);UseMessageEventHook(CatalogPageMessageEvent,onCatalogPageMessageEvent);var onPurchaseOKMessageEvent=useCallback(function(event){var parser=event.getParser();DispatchUiEvent(new CatalogPurchasedEvent(parser.offer));},[]);UseMessageEventHook(PurchaseOKMessageEvent,onPurchaseOKMessageEvent);var onPurchaseErrorMessageEvent=useCallback(function(event){var parser=event.getParser();DispatchUiEvent(new CatalogPurchaseFailureEvent(parser.code));},[]);UseMessageEventHook(PurchaseErrorMessageEvent,onPurchaseErrorMessageEvent);var onPurchaseNotAllowedMessageEvent=useCallback(function(event){var parser=event.getParser();DispatchUiEvent(new CatalogPurchaseNotAllowedEvent(parser.code));},[]);UseMessageEventHook(PurchaseNotAllowedMessageEvent,onPurchaseNotAllowedMessageEvent);var onLimitedEditionSoldOutEvent=useCallback(function(event){var parser=event.getParser();DispatchUiEvent(new CatalogPurchaseSoldOutEvent());},[]);UseMessageEventHook(LimitedEditionSoldOutEvent,onLimitedEditionSoldOutEvent);var onProductOfferEvent=useCallback(function(event){var parser=event.getParser();var offerData=parser.offer;if(!offerData||!offerData.products.length)return;var offerProductData=offerData.products[0];if(offerProductData.uniqueLimitedItem){// update unique\n}var products=[];var productData=GetProductDataForLocalization(offerData.localizationId);var _iterator12=_createForOfIteratorHelper(offerData.products),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var product=_step12.value;var furnitureData=GetFurnitureData(product.furniClassId,product.productType);products.push(new Product(product.productType,product.furniClassId,product.extraParam,product.productCount,productData,furnitureData,product.uniqueLimitedItem,product.uniqueLimitedSeriesSize,product.uniqueLimitedItemsLeft));}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}var offer=new Offer(offerData.offerId,offerData.localizationId,offerData.rent,offerData.priceCredits,offerData.priceActivityPoints,offerData.priceActivityPointsType,offerData.giftable,offerData.clubLevel,products,offerData.bundlePurchaseAllowed);if(!(currentType===CatalogType.NORMAL||offer.pricingModel!==Offer.PRICING_MODEL_BUNDLE&&offer.pricingModel!==Offer.PRICING_MODEL_MULTI))return;offer.page=currentPage;setCurrentOffer(offer);if(offer.product&&offer.product.productType===ProductTypeEnum.WALL){setPurchaseOptions(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.extraData=offer.product.extraParam||null;return newValue;});}// (this._isObjectMoverRequested) && (this._purchasableOffer)\n},[currentType,currentPage,setCurrentOffer,setPurchaseOptions]);UseMessageEventHook(ProductOfferEvent,onProductOfferEvent);var onSellablePetPalettesMessageEvent=useCallback(function(event){var parser=event.getParser();var petPalette=new CatalogPetPalette(parser.productCode,parser.palettes.slice());setCatalogOptions(function(prevValue){var petPalettes=[];if(prevValue.petPalettes)petPalettes.push.apply(petPalettes,_toConsumableArray(prevValue.petPalettes));for(var i=0;i<petPalettes.length;i++){var palette=petPalettes[i];if(palette.breed===petPalette.breed){petPalettes.splice(i,1);break;}}petPalettes.push(petPalette);return _objectSpread(_objectSpread({},prevValue),{},{petPalettes:petPalettes});});},[setCatalogOptions]);UseMessageEventHook(SellablePetPalettesMessageEvent,onSellablePetPalettesMessageEvent);var onHabboClubOffersMessageEvent=useCallback(function(event){var parser=event.getParser();setCatalogOptions(function(prevValue){var clubOffers=parser.offers;return _objectSpread(_objectSpread({},prevValue),{},{clubOffers:clubOffers});});},[setCatalogOptions]);UseMessageEventHook(HabboClubOffersMessageEvent,onHabboClubOffersMessageEvent);var onGuildMembershipsMessageEvent=useCallback(function(event){var parser=event.getParser();setCatalogOptions(function(prevValue){var groups=parser.groups;return _objectSpread(_objectSpread({},prevValue),{},{groups:groups});});},[setCatalogOptions]);UseMessageEventHook(GuildMembershipsMessageEvent,onGuildMembershipsMessageEvent);var onGiftWrappingConfigurationEvent=useCallback(function(event){var parser=event.getParser();setCatalogOptions(function(prevValue){var giftConfiguration=new GiftWrappingConfiguration(parser);return _objectSpread(_objectSpread({},prevValue),{},{giftConfiguration:giftConfiguration});});},[setCatalogOptions]);UseMessageEventHook(GiftWrappingConfigurationEvent,onGiftWrappingConfigurationEvent);var onMarketplaceMakeOfferResult=useCallback(function(event){var parser=event.getParser();if(!parser)return;var title='';if(parser.result===1){title=LocalizeText('inventory.marketplace.result.title.success');}else{title=LocalizeText('inventory.marketplace.result.title.failure');}var message=LocalizeText(\"inventory.marketplace.result.\".concat(parser.result));NotificationUtilities.simpleAlert(message,NotificationAlertType.DEFAULT,null,null,title);},[]);UseMessageEventHook(MarketplaceMakeOfferResult,onMarketplaceMakeOfferResult);var onClubGiftInfoEvent=useCallback(function(event){var parser=event.getParser();setCatalogOptions(function(prevValue){var clubGifts=parser;return _objectSpread(_objectSpread({},prevValue),{},{clubGifts:clubGifts});});},[setCatalogOptions]);UseMessageEventHook(ClubGiftInfoEvent,onClubGiftInfoEvent);var onCatalogPublishedMessageEvent=useCallback(function(event){var wasVisible=isVisible;resetState();if(wasVisible)NotificationUtilities.simpleAlert(LocalizeText('catalog.alert.published.description'),NotificationAlertType.ALERT,null,null,LocalizeText('catalog.alert.published.title'));},[isVisible,resetState]);UseMessageEventHook(CatalogPublishedMessageEvent,onCatalogPublishedMessageEvent);var onBuildersClubFurniCountMessageEvent=useCallback(function(event){var parser=event.getParser();setFurniCount(parser.furniCount);refreshBuilderStatus();},[refreshBuilderStatus]);UseMessageEventHook(BuildersClubFurniCountMessageEvent,onBuildersClubFurniCountMessageEvent);var onBuildersClubSubscriptionStatusMessageEvent=useCallback(function(event){var parser=event.getParser();setFurniLimit(parser._Str_15864);setMaxFurniLimit(parser._Str_24094);setSecondsLeft(parser._Str_3709);setUpdateTime(GetNitroInstance().time);setSecondsLeftWithGrace(parser._Str_24379);refreshBuilderStatus();},[refreshBuilderStatus]);UseMessageEventHook(BuildersClubSubscriptionStatusMessageEvent,onBuildersClubSubscriptionStatusMessageEvent);var onCatalogPurchasedEvent=useCallback(function(event){PlaySound(SoundNames.CREDITS);},[]);UseUiEvent(CatalogPurchasedEvent.PURCHASE_SUCCESS,onCatalogPurchasedEvent);var onRoomEngineObjectPlacedEvent=useCallback(function(event){if(!objectMoverRequested||event.type!==RoomEngineObjectPlacedEvent.PLACED)return;resetPlacedOfferData(true);if(!purchasableOffer){resetObjectMover();return;}var placed=false;var product=purchasableOffer.product;if(event.category===RoomObjectCategory.WALL){switch(product.furnitureData.className){case'floor':case'wallpaper':case'landscape':placed=event.placedOnFloor||event.placedOnWall;break;default:placed=event.placedInRoom;break;}}else{placed=event.placedInRoom;}if(!placed){resetObjectMover();return;}setPlacedObjectPurchaseData(new PlacedObjectPurchaseData(event.roomId,event.objectId,event.category,event.wallLocation,event.x,event.y,event.direction,purchasableOffer));switch(currentType){case CatalogType.NORMAL:{switch(event.category){case RoomObjectCategory.FLOOR:GetRoomEngine().addFurnitureFloor(event.roomId,event.objectId,product.productClassId,new Vector3d(event.x,event.y,event.z),new Vector3d(event.direction),0,new LegacyDataType());break;case RoomObjectCategory.WALL:{switch(product.furnitureData.className){case'floor':case'wallpaper':case'landscape':resetRoomPaint(product.furnitureData.className,product.extraParam);break;default:GetRoomEngine().addFurnitureWall(event.roomId,event.objectId,product.productClassId,new Vector3d(event.x,event.y,event.z),new Vector3d(event.direction*45),0,event.instanceData,0);break;}}}var roomObject=GetRoomEngine().getRoomObject(event.roomId,event.objectId,event.category);if(roomObject)roomObject.model.setValue(RoomObjectVariable.FURNITURE_ALPHA_MULTIPLIER,0.5);if(catalogSkipPurchaseConfirmation){SendMessageComposer(new PurchaseFromCatalogComposer(pageId,purchasableOffer.offerId,product.extraParam,1));if(catalogPlaceMultipleObjects)requestOfferToMover(purchasableOffer);}else{// confirm\nif(catalogPlaceMultipleObjects)requestOfferToMover(purchasableOffer);}break;}case CatalogType.BUILDER:{var _pageId=purchasableOffer.page.pageId;if(_pageId===DUMMY_PAGE_ID_FOR_OFFER_SEARCH){_pageId=-1;}switch(event.category){case RoomObjectCategory.FLOOR:SendMessageComposer(new BuildersClubPlaceRoomItemMessageComposer(_pageId,purchasableOffer.offerId,product.extraParam,event.x,event.y,event.direction));break;case RoomObjectCategory.WALL:SendMessageComposer(new BuildersClubPlaceWallItemMessageComposer(_pageId,purchasableOffer.offerId,product.extraParam,event.wallLocation));break;}if(catalogPlaceMultipleObjects)requestOfferToMover(purchasableOffer);break;}}},[objectMoverRequested,purchasableOffer,catalogPlaceMultipleObjects,catalogSkipPurchaseConfirmation,currentType,pageId,resetPlacedOfferData,resetObjectMover,resetRoomPaint,requestOfferToMover]);UseRoomEngineEvent(RoomEngineObjectPlacedEvent.PLACED,onRoomEngineObjectPlacedEvent);var onInventoryFurniAddedEvent=useCallback(function(event){var roomEngine=GetRoomEngine();if(!placedObjectPurchaseData||placedObjectPurchaseData.productClassId!==event.spriteId||placedObjectPurchaseData.roomId!==roomEngine.activeRoomId)return;switch(event.category){case FurniCategory.FLOOR:{var floorType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_FLOOR_TYPE);if(placedObjectPurchaseData.extraParam!==floorType)SendMessageComposer(new FurniturePlacePaintComposer(event.id));break;}case FurniCategory.WALL_PAPER:{var wallType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_WALL_TYPE);if(placedObjectPurchaseData.extraParam!==wallType)SendMessageComposer(new FurniturePlacePaintComposer(event.id));break;}case FurniCategory.LANDSCAPE:{var landscapeType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_LANDSCAPE_TYPE);if(placedObjectPurchaseData.extraParam!==landscapeType)SendMessageComposer(new FurniturePlacePaintComposer(event.id));break;}default:SendMessageComposer(new FurniturePlaceComposer(event.id,placedObjectPurchaseData.category,placedObjectPurchaseData.wallLocation,placedObjectPurchaseData.x,placedObjectPurchaseData.y,placedObjectPurchaseData.direction));}if(!catalogPlaceMultipleObjects)resetPlacedOfferData();},[placedObjectPurchaseData,catalogPlaceMultipleObjects,resetPlacedOfferData]);UseUiEvent(InventoryFurniAddedEvent.FURNI_ADDED,onInventoryFurniAddedEvent);useEffect(function(){return function(){return setCurrentOffer(null);};},[currentPage]);useEffect(function(){if(!isVisible||!rootNode||!requestedPage.current)return;switch(requestedPage.current.requestType){case RequestedPage.REQUEST_TYPE_NONE:if(currentPage)return;if(rootNode.isBranch){var _iterator13=_createForOfIteratorHelper(rootNode.children),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var child=_step13.value;if(child&&child.isVisible){activateNode(child);return;}}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}}return;case RequestedPage.REQUEST_TYPE_ID:openPageById(requestedPage.current.requestById);requestedPage.current.resetRequest();return;case RequestedPage.REQUEST_TYPE_OFFER:openPageByOfferId(requestedPage.current.requestedByOfferId);requestedPage.current.resetRequest();return;case RequestedPage.REQUEST_TYPE_NAME:openPageByName(requestedPage.current.requestByName);requestedPage.current.resetRequest();return;}},[isVisible,rootNode,currentPage,activateNode,openPageById,openPageByOfferId,openPageByName]);useEffect(function(){if(!searchResult&&currentPage&&currentPage.pageId===-1)openPageById(previousPageId);},[searchResult,currentPage,previousPageId,openPageById]);useEffect(function(){if(!isVisible||rootNode)return;SendMessageComposer(new GetGiftWrappingConfigurationComposer());SendMessageComposer(new GetClubGiftInfo());SendMessageComposer(new GetCatalogIndexComposer(currentType));SendMessageComposer(new BuildersClubQueryFurniCountMessageComposer());},[isVisible,rootNode,currentType]);useEffect(function(){setRoomPreviewer(new RoomPreviewer(GetRoomEngine(),++RoomPreviewer.PREVIEW_COUNTER));return function(){setRoomPreviewer(function(prevValue){prevValue.dispose();return null;});};},[]);return{isVisible:isVisible,setIsVisible:setIsVisible,isBusy:isBusy,pageId:pageId,previousPageId:previousPageId,currentType:currentType,rootNode:rootNode,offersToNodes:offersToNodes,currentPage:currentPage,setCurrentPage:setCurrentPage,currentOffer:currentOffer,setCurrentOffer:setCurrentOffer,activeNodes:activeNodes,searchResult:searchResult,setSearchResult:setSearchResult,frontPageItems:frontPageItems,roomPreviewer:roomPreviewer,navigationHidden:navigationHidden,setNavigationHidden:setNavigationHidden,purchaseOptions:purchaseOptions,setPurchaseOptions:setPurchaseOptions,catalogOptions:catalogOptions,setCatalogOptions:setCatalogOptions,getNodeById:getNodeById,getNodeByName:getNodeByName,activateNode:activateNode,openPageById:openPageById,openPageByName:openPageByName,openPageByOfferId:openPageByOfferId,requestOfferToMover:requestOfferToMover};};export var useCatalog=function useCatalog(){return useBetween(useCatalogState);};","map":null,"metadata":{},"sourceType":"module"}