{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Nitro}from'../../../../../../Nitro';import{PlaneBitmapData}from'../../utils/PlaneBitmapData';import{Randomizer}from'../../utils/Randomizer';import{PlaneRasterizer}from'../basic/PlaneRasterizer';import{PlaneVisualizationLayer}from'../basic/PlaneVisualizationLayer';import{LandscapePlane}from'./LandscapePlane';export var LandscapeRasterizer=/*#__PURE__*/function(_PlaneRasterizer){_inherits(LandscapeRasterizer,_PlaneRasterizer);var _super=_createSuper(LandscapeRasterizer);function LandscapeRasterizer(){var _this;_classCallCheck(this,LandscapeRasterizer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this._landscapeWidth=0;_this._landscapeHeight=0;return _this;}_createClass(LandscapeRasterizer,[{key:\"initializeDimensions\",value:function initializeDimensions(k,_arg_2){if(k<0)k=0;if(_arg_2<0)_arg_2=0;this._landscapeWidth=k;this._landscapeHeight=_arg_2;return true;}},{key:\"initializePlanes\",value:function initializePlanes(){if(!this.data)return;var landscapes=this.data.landscapes;if(landscapes&&landscapes.length)this.parseLandscapes(landscapes);}},{key:\"parseLandscapes\",value:function parseLandscapes(k){if(!k)return;var randomNumber=Math.trunc(Math.random()*654321);for(var landscapeIndex in k){var landscape=k[landscapeIndex];if(!landscape)continue;var id=landscape.id;var visualizations=landscape.animatedVisualizations;var plane=new LandscapePlane();var _iterator=_createForOfIteratorHelper(visualizations),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var visualization=_step.value;if(!visualization)continue;var size=visualization.size;var horizontalAngle=LandscapePlane.HORIZONTAL_ANGLE_DEFAULT;var verticalAngle=LandscapePlane.VERTICAL_ANGLE_DEFAULT;if(visualization.horizontalAngle)horizontalAngle=visualization.horizontalAngle;if(visualization.verticalAngle)verticalAngle=visualization.verticalAngle;var basicLayers=visualization.layers;var animatedLayers=visualization.animationLayers;var totalBasicLayers=basicLayers&&basicLayers.length||0;var totalAnimatedLayers=animatedLayers&&animatedLayers.length||0;var totalLayers=totalBasicLayers+totalAnimatedLayers;var planeVisualization=plane.createPlaneVisualization(size,totalLayers||0,this.getGeometry(size,horizontalAngle,verticalAngle));if(planeVisualization){Randomizer.setSeed(randomNumber);var layerId=0;if(totalBasicLayers){while(layerId<basicLayers.length){var layer=basicLayers[layerId];if(layer){var material=null;var align=PlaneVisualizationLayer.ALIGN_DEFAULT;var color=LandscapePlane.DEFAULT_COLOR;var offset=PlaneVisualizationLayer.DEFAULT_OFFSET;if(layer.materialId)material=this.getMaterial(layer.materialId);if(layer.color)color=layer.color;if(layer.offset)offset=layer.offset;if(layer.align){if(layer.align==='bottom'){align=PlaneVisualizationLayer.ALIGN_BOTTOM;}else if(layer.align==='top')align=PlaneVisualizationLayer.ALIGN_TOP;}planeVisualization.setLayer(layerId,material,color,align,offset);}layerId++;}}layerId=0;if(totalAnimatedLayers){var animationItems=[];while(layerId<animatedLayers.length){var _layer=animatedLayers[layerId];if(_layer){var items=_layer.animationItems;if(items&&items.length){var _iterator2=_createForOfIteratorHelper(items),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;if(item){var _id=item.id;var assetId=item.assetId;var x=this.getCoordinateValue(item.x||'',item.randomX||'');var y=this.getCoordinateValue(item.y||'',item.randomY||'');var speedX=item.speedX?item.speedX/Nitro.instance.getConfiguration('system.animation.fps'):0;var speedY=item.speedY?item.speedY/Nitro.instance.getConfiguration('system.animation.fps'):0;animationItems.push({asset:assetId,x:x,y:y,speedX:speedX,speedY:speedY});}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}layerId++;}planeVisualization.setAnimationLayer(layerId,animationItems,this.assetCollection);}}}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(!this.addPlane(id,plane))plane.dispose();}}},{key:\"getCoordinateValue\",value:function getCoordinateValue(k,_arg_2){var _local_3=0;if(k.length>0){if(k.charAt(k.length-1)==='%'){k=k.substr(0,k.length-1);_local_3=parseFloat(k)/100;}}if(_arg_2.length>0){var _local_4=10000;var _local_5=Randomizer.getValues(1,0,_local_4);var _local_6=_local_5[0]/_local_4;if(_arg_2.charAt(_arg_2.length-1)==='%'){_arg_2=_arg_2.substr(0,_arg_2.length-1);_local_3=_local_3+_local_6*parseFloat(_arg_2)/100;}}return _local_3;}},{key:\"render\",value:function render(canvas,id,width,height,scale,normal,useTexture){var offsetX=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0;var offsetY=arguments.length>8&&arguments[8]!==undefined?arguments[8]:0;var maxX=arguments.length>9&&arguments[9]!==undefined?arguments[9]:0;var maxY=arguments.length>10&&arguments[10]!==undefined?arguments[10]:0;var timeSinceStartMs=arguments.length>11&&arguments[11]!==undefined?arguments[11]:0;var plane=this.getPlane(id);if(!plane)plane=this.getPlane(LandscapeRasterizer.DEFAULT);if(!plane)return null;if(canvas){canvas.clear();}var graphic=plane.render(canvas,width,height,scale,normal,useTexture,offsetX,offsetY,maxX,maxY,timeSinceStartMs);if(graphic&&graphic!==canvas){graphic=graphic.clone();if(!graphic)return null;}var planeBitmapData=null;if(!plane.isStatic(scale)&&LandscapeRasterizer.UPDATE_INTERVAL>0){planeBitmapData=new PlaneBitmapData(graphic,Math.round(timeSinceStartMs/LandscapeRasterizer.UPDATE_INTERVAL)*LandscapeRasterizer.UPDATE_INTERVAL+LandscapeRasterizer.UPDATE_INTERVAL);}else{planeBitmapData=new PlaneBitmapData(graphic,-1);}return planeBitmapData;}},{key:\"getTextureIdentifier\",value:function getTextureIdentifier(k,_arg_2){if(_arg_2){if(_arg_2.x<0)return k+'_0';return k+'_1';}return _get(_getPrototypeOf(LandscapeRasterizer.prototype),\"getTextureIdentifier\",this).call(this,k,_arg_2);}}]);return LandscapeRasterizer;}(PlaneRasterizer);LandscapeRasterizer.UPDATE_INTERVAL=500;","map":null,"metadata":{},"sourceType":"module"}