{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{RelationshipStatusInfoEvent,RoomSessionFavoriteGroupUpdateEvent,RoomSessionUserBadgesEvent,RoomSessionUserFigureUpdateEvent,UserRelationshipsComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{CloneObject,GetConfiguration,GetGroupInformation,GetSessionDataManager,GetUserProfile,LocalizeText,RoomWidgetChangeMottoMessage,RoomWidgetUpdateInfostandUserEvent,SendMessageComposer}from'../../../../api';import{Base,Column,Flex,LayoutAvatarImageView,LayoutBadgeImageView,Text,UserProfileIconView}from'../../../../common';import{UseEventDispatcherHook,UseMessageEventHook}from'../../../../hooks';import{useRoomContext}from'../../RoomContext';import{InfoStandWidgetUserRelationshipsView}from'./InfoStandWidgetUserRelationshipsView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var InfoStandWidgetUserView=function InfoStandWidgetUserView(props){var _props$userData=props.userData,userData=_props$userData===void 0?null:_props$userData,_props$setUserData=props.setUserData,setUserData=_props$setUserData===void 0?null:_props$setUserData,_props$close=props.close,close=_props$close===void 0?null:_props$close;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),motto=_useState2[0],setMotto=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEditingMotto=_useState4[0],setIsEditingMotto=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),relationships=_useState6[0],setRelationships=_useState6[1];var _useRoomContext=useRoomContext(),_useRoomContext$event=_useRoomContext.eventDispatcher,eventDispatcher=_useRoomContext$event===void 0?null:_useRoomContext$event,_useRoomContext$widge=_useRoomContext.widgetHandler,widgetHandler=_useRoomContext$widge===void 0?null:_useRoomContext$widge;var maxBadgeCount=GetConfiguration('user.badges.max.slots',5);var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),bannerUrl=_useState8[0],setBannerUrl=_useState8[1];var sso=new URLSearchParams(window.location.search).get('sso');var saveMotto=function saveMotto(motto){if(!isEditingMotto||motto.length>GetConfiguration('motto.max.length',38))return;widgetHandler.processWidgetMessage(new RoomWidgetChangeMottoMessage(motto));setIsEditingMotto(false);};var onMottoBlur=function onMottoBlur(event){return saveMotto(event.target.value);};var onMottoKeyDown=function onMottoKeyDown(event){event.stopPropagation();switch(event.key){case'Enter':saveMotto(event.target.value);return;}};var onRoomSessionUserBadgesEvent=useCallback(function(event){if(!userData||userData.webID!==event.userId)return;setUserData(function(prevValue){var newValue=CloneObject(prevValue);newValue.badges=event.badges;return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionUserBadgesEvent.RSUBE_BADGES,eventDispatcher,onRoomSessionUserBadgesEvent);var onRoomSessionUserFigureUpdateEvent=useCallback(function(event){if(!userData||userData.roomIndex!==event.roomIndex)return;setUserData(function(prevValue){var newValue=CloneObject(prevValue);newValue.figure=event.figure;newValue.motto=event.customInfo;newValue.achievementScore=event.activityPoints;return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionUserFigureUpdateEvent.USER_FIGURE,eventDispatcher,onRoomSessionUserFigureUpdateEvent);var onRoomSessionFavoriteGroupUpdateEvent=useCallback(function(event){if(!userData||userData.roomIndex!==event.roomIndex)return;setUserData(function(prevValue){var newValue=CloneObject(prevValue);var clearGroup=event.status===-1||event.habboGroupId<=0;newValue.groupId=clearGroup?-1:event.habboGroupId;newValue.groupName=clearGroup?null:event.habboGroupName;newValue.groupBadgeId=clearGroup?null:GetSessionDataManager().getGroupBadge(event.habboGroupId);return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionFavoriteGroupUpdateEvent.FAVOURITE_GROUP_UPDATE,eventDispatcher,onRoomSessionFavoriteGroupUpdateEvent);var onUserRelationshipsEvent=useCallback(function(event){var parser=event.getParser();if(!userData||userData.webID!==parser.userId)return;setRelationships(parser);},[userData]);UseMessageEventHook(RelationshipStatusInfoEvent,onUserRelationshipsEvent);useEffect(function(){setIsEditingMotto(false);setMotto(userData.motto);SendMessageComposer(new UserRelationshipsComposer(userData.webID));fetch(\"https://int.habbbo.net/?type=getbanner&sso=\"+sso+\"&username=\"+userData.name).then(function(response){return response.text();}).then(function(result){if(result==null||result==\"ERROR\")setBannerUrl(\"https://swfs.hgalaxy.net/banners/banner1.png\");else setBannerUrl(\"https://swfs.hgalaxy.net/banners/banner\"+result.replace(/\\n/g,\"\")+\".png\");});return function(){setIsEditingMotto(false);setMotto(null);setRelationships(null);};},[userData]);if(!userData)return null;return/*#__PURE__*/_jsxs(Column,{className:\"nitro-infostand rounded\",style:{backgroundColor:\"var(--test-galaxy)\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"nitro-infostand-title\",children:/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(UserProfileIconView,{userId:userData.webID}),/*#__PURE__*/_jsx(Text,{variant:\"none\",style:{color:\"var(--test-galaxytext)\"},small:true,wrap:true,children:userData.name})]}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\",className:\"cursor-pointer\",onClick:close})]})})}),/*#__PURE__*/_jsxs(Column,{overflow:\"visible\",className:\"container-fluid content-area\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Column,{fullWidth:true,className:\"body-image\",onClick:function onClick(event){return GetUserProfile(userData.webID);},style:{backgroundImage:\"url(\"+bannerUrl+\")\",borderRadius:\"10px\"},children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:userData.figure,direction:4})}),/*#__PURE__*/_jsxs(Column,{grow:true,gap:0,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[0]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[0],showInfo:true})}),/*#__PURE__*/_jsx(Base,{pointer:userData.groupId>0,className:\"badge-image\",onClick:function onClick(event){return GetGroupInformation(userData.groupId);},children:userData.groupId>0&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.groupBadgeId,isGroup:true,showInfo:true,customTitle:userData.groupName})})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[1]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[1],showInfo:true})}),/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[2]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[2],showInfo:true})})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[3]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[3],showInfo:true})}),/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[4]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[4],showInfo:true})})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"bg-primary rounded py-1 px-2\",children:[userData.type!==RoomWidgetUpdateInfostandUserEvent.OWN_USER&&/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"pencil-alt\",className:\"small\",style:{marginLeft:\"1px\"}}),/*#__PURE__*/_jsx(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:/*#__PURE__*/_jsx(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,small:true,variant:\"white\",children:motto})})]}),userData.type===RoomWidgetUpdateInfostandUserEvent.OWN_USER&&/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"pencil-alt\",className:\"small\",style:{marginLeft:\"1px\"}}),/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:[!isEditingMotto&&/*#__PURE__*/_jsxs(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,small:true,variant:\"white\",onClick:function onClick(event){return setIsEditingMotto(true);},children:[motto,\"\\xA0\"]}),isEditingMotto&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"motto-input\",maxLength:GetConfiguration('motto.max.length',38),value:motto,onChange:function onChange(event){return setMotto(event.target.value);},onBlur:onMottoBlur,onKeyDown:onMottoKeyDown,autoFocus:true})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"rounded py-1 px-2\",style:{backgroundColor:\"#35c460\"},children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://images.habbo.com/c_images/catalogue/icon_256.png\"}),\" \\xA0\",/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.achievement_score')+' '+userData.achievementScore})]}),userData.carryItem>0&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"rounded py-1 px-2\",style:{backgroundColor:\"#d15254\"},children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://images.habbo.com/c_images/catalogue/icon_70.png\"}),\" \\xA0\",/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.handitem',['item'],[LocalizeText('handitem'+userData.carryItem)])})]})})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsx(InfoStandWidgetUserRelationshipsView,{relationships:relationships})})]})]});};","map":null,"metadata":{},"sourceType":"module"}