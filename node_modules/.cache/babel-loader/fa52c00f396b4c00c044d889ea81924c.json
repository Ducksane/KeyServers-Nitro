{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Rectangle}from'@pixi/math';import{AdvancedMap}from'../../../../../core/utils/AdvancedMap';import{AlphaTolerance}from'../../../../../room/object/enum/AlphaTolerance';import{RoomObjectSpriteType}from'../../../../../room/object/enum/RoomObjectSpriteType';import{RoomObjectSpriteVisualization}from'../../../../../room/object/visualization/RoomObjectSpriteVisualization';import{Vector3d}from'../../../../../room/utils/Vector3d';import{RoomObjectVariable}from'../../RoomObjectVariable';import{RoomPlaneBitmapMaskData}from'../../RoomPlaneBitmapMaskData';import{RoomPlaneBitmapMaskParser}from'../../RoomPlaneBitmapMaskParser';import{RoomPlaneData}from'../../RoomPlaneData';import{RoomPlaneParser}from'../../RoomPlaneParser';import{RoomPlane}from'./RoomPlane';import{RoomVisualizationData}from'./RoomVisualizationData';export var RoomVisualization=/*#__PURE__*/function(_RoomObjectSpriteVisu){_inherits(RoomVisualization,_RoomObjectSpriteVisu);var _super=_createSuper(RoomVisualization);function RoomVisualization(){var _this;_classCallCheck(this,RoomVisualization);_this=_super.call(this);_this._data=void 0;_this._roomPlaneParser=void 0;_this._roomPlaneBitmapMaskParser=void 0;_this._geometryUpdateId=void 0;_this._boundingRectangle=void 0;_this._directionX=void 0;_this._directionY=void 0;_this._directionZ=void 0;_this._floorThickness=void 0;_this._wallThickness=void 0;_this._holeUpdateTime=void 0;_this._planes=void 0;_this._visiblePlanes=void 0;_this._visiblePlaneSpriteNumbers=void 0;_this._roomScale=void 0;_this._lastUpdateTime=void 0;_this._updateIntervalTime=void 0;_this._wallType=void 0;_this._floorType=void 0;_this._landscapeType=void 0;_this._colorBackgroundOnly=void 0;_this._color=void 0;_this._redColor=void 0;_this._greenColor=void 0;_this._blueColor=void 0;_this._typeVisibility=void 0;_this._assetUpdateCounter=void 0;_this._maskData=void 0;_this._isPlaneSet=void 0;_this._data=null;_this._roomPlaneParser=new RoomPlaneParser();_this._roomPlaneBitmapMaskParser=new RoomPlaneBitmapMaskParser();_this._geometryUpdateId=-1;_this._directionX=0;_this._directionY=0;_this._directionZ=0;_this._floorThickness=1;_this._wallThickness=1;_this._holeUpdateTime=NaN;_this._planes=[];_this._visiblePlanes=[];_this._visiblePlaneSpriteNumbers=[];_this._roomScale=0;_this._lastUpdateTime=-1000;_this._updateIntervalTime=250;_this._wallType=null;_this._floorType=null;_this._landscapeType=null;_this._colorBackgroundOnly=true;_this._color=0xFFFFFF;_this._redColor=0xFF;_this._greenColor=0xFF;_this._blueColor=0xFF;_this._typeVisibility=[];_this._assetUpdateCounter=0;_this._maskData=null;_this._isPlaneSet=false;_this._typeVisibility[RoomPlane.TYPE_UNDEFINED]=false;_this._typeVisibility[RoomPlane.TYPE_FLOOR]=true;_this._typeVisibility[RoomPlane.TYPE_WALL]=true;_this._typeVisibility[RoomPlane.TYPE_LANDSCAPE]=true;return _this;}_createClass(RoomVisualization,[{key:\"initialize\",value:function initialize(data){if(!(data instanceof RoomVisualizationData))return false;this._data=data;_get(_getPrototypeOf(RoomVisualization.prototype),\"initialize\",this).call(this,data);this._data.setGraphicAssetCollection(this.asset);return true;}},{key:\"dispose\",value:function dispose(){_get(_getPrototypeOf(RoomVisualization.prototype),\"dispose\",this).call(this);this.clearPlanes();this._planes=null;this._visiblePlanes=null;this._visiblePlaneSpriteNumbers=null;if(this._roomPlaneParser){this._roomPlaneParser.dispose();this._roomPlaneParser=null;}if(this._roomPlaneBitmapMaskParser){this._roomPlaneBitmapMaskParser.dispose();this._roomPlaneBitmapMaskParser=null;}if(this._data){this._data.clearCache();this._data=null;}var existingTextureCache=RoomVisualization.RENDER_TEXTURE_CACHE.get(this);if(existingTextureCache){var _iterator=_createForOfIteratorHelper(existingTextureCache.getValues()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var texture=_step.value;texture.destroy(true);}}catch(err){_iterator.e(err);}finally{_iterator.f();}existingTextureCache.dispose();RoomVisualization.RENDER_TEXTURE_CACHE.delete(this);}}},{key:\"reset\",value:function reset(){_get(_getPrototypeOf(RoomVisualization.prototype),\"reset\",this).call(this);this._floorType=null;this._wallType=null;this._landscapeType=null;this._maskData=null;this._geometryUpdateId=-1;this._roomScale=0;}},{key:\"update\",value:function update(geometry,time,_update,skipUpdate){if(!this.object||!geometry)return;RoomVisualization.LAST_VISUALIZATION=this;var removeCount=0;var existing=RoomVisualization.RENDER_TEXTURE_CACHE.get(RoomVisualization.LAST_VISUALIZATION);if(existing)removeCount=existing.length;var geometryUpdate=this.updateGeometry(geometry);var objectModel=this.object.model;var needsUpdate=false;if(this.updateThickness(objectModel))needsUpdate=true;if(this.updateHole(objectModel))needsUpdate=true;if(this.initializeRoomPlanes()){if(existing&&removeCount){setTimeout(function(){while(removeCount){var texture=existing.getWithIndex(0);if(texture){texture.destroy(true);existing.remove(existing.getKey(0));}removeCount--;}},0);}}needsUpdate=this.updateMasks(objectModel);if(time<this._lastUpdateTime+this._updateIntervalTime&&!geometryUpdate&&!needsUpdate)return;if(this.updatePlaneTexturesAndVisibilities(objectModel))needsUpdate=true;if(this.updatePlanes(geometry,geometryUpdate,time))needsUpdate=true;if(needsUpdate){var index=0;while(index<this._visiblePlanes.length){var spriteIndex=this._visiblePlaneSpriteNumbers[index];var sprite=this.getSprite(spriteIndex);var plane=this._visiblePlanes[index];if(sprite&&plane&&plane.type!==RoomPlane.TYPE_LANDSCAPE){if(this._colorBackgroundOnly){var _local_14=plane.color;var _local_15=(_local_14&0xFF)*this._redColor/0xFF;var _local_16=(_local_14>>8&0xFF)*this._greenColor/0xFF;var _local_17=(_local_14>>16&0xFF)*this._blueColor/0xFF;var _local_18=_local_14>>24;_local_14=(_local_18<<24)+(_local_17<<16)+(_local_16<<8)+_local_15;sprite.color=_local_14;}else{sprite.color=plane.color;}}index++;}this.updateSpriteCounter++;}this.updateModelCounter=objectModel.updateCounter;this._lastUpdateTime=time;}},{key:\"updateGeometry\",value:function updateGeometry(k){if(!k)return false;if(this._geometryUpdateId===k.updateId)return false;this._geometryUpdateId=k.updateId;this._boundingRectangle=null;var direction=k.direction;if(direction&&(direction.x!==this._directionX||direction.y!==this._directionY||direction.z!==this._directionZ||k.scale!==this._roomScale)){this._directionX=direction.x;this._directionY=direction.y;this._directionZ=direction.z;this._roomScale=k.scale;return true;}return false;}},{key:\"updateThickness\",value:function updateThickness(k){if(this.updateModelCounter===k.updateCounter)return false;var floorThickness=k.getValue(RoomObjectVariable.ROOM_FLOOR_THICKNESS);var wallThickness=k.getValue(RoomObjectVariable.ROOM_WALL_THICKNESS);if(!isNaN(floorThickness)&&!isNaN(wallThickness)&&(floorThickness!==this._floorThickness||wallThickness!==this._wallThickness)){this._floorThickness=floorThickness;this._wallThickness=wallThickness;this.clearPlanes();return true;}return false;}},{key:\"updateHole\",value:function updateHole(k){if(this.updateModelCounter===k.updateCounter)return false;var holeUpdate=k.getValue(RoomObjectVariable.ROOM_FLOOR_HOLE_UPDATE_TIME);if(!isNaN(holeUpdate)&&holeUpdate!==this._holeUpdateTime){this._holeUpdateTime=holeUpdate;this.clearPlanes();return true;}return false;}},{key:\"updateMasks\",value:function updateMasks(k){if(this.updateModelCounter===k.updateCounter)return false;var didUpdate=false;var planeMask=k.getValue(RoomObjectVariable.ROOM_PLANE_MASK_XML);if(planeMask!==this._maskData){this.updatePlaneMasks(planeMask);this._maskData=planeMask;didUpdate=true;}var backgroundColor=k.getValue(RoomObjectVariable.ROOM_BACKGROUND_COLOR);if(backgroundColor!==this._color){this._color=backgroundColor;this._redColor=this._color&0xFF;this._greenColor=this._color>>8&0xFF;this._blueColor=this._color>>16&0xFF;didUpdate=true;}var backgroundOnly=k.getValue(RoomObjectVariable.ROOM_COLORIZE_BG_ONLY)||false;if(backgroundOnly!==this._colorBackgroundOnly){this._colorBackgroundOnly=backgroundOnly;didUpdate=true;}return didUpdate;}},{key:\"updatePlaneTexturesAndVisibilities\",value:function updatePlaneTexturesAndVisibilities(model){if(this.updateModelCounter===model.updateCounter)return false;var floorType=model.getValue(RoomObjectVariable.ROOM_FLOOR_TYPE);var wallType=model.getValue(RoomObjectVariable.ROOM_WALL_TYPE);var landscapeType=model.getValue(RoomObjectVariable.ROOM_LANDSCAPE_TYPE);this.updatePlaneTypes(floorType,wallType,landscapeType);var floorVisibility=model.getValue(RoomObjectVariable.ROOM_FLOOR_VISIBILITY)===1;var wallVisibility=model.getValue(RoomObjectVariable.ROOM_WALL_VISIBILITY)===1;var landscapeVisibility=model.getValue(RoomObjectVariable.ROOM_LANDSCAPE_VISIBILITY)===1;this.updatePlaneVisibility(floorVisibility,wallVisibility,landscapeVisibility);return true;}},{key:\"clearPlanes\",value:function clearPlanes(){if(this._planes){while(this._planes.length){var plane=this._planes[0];if(plane)plane.dispose();this._planes.pop();}this._planes=[];this._planes=[];}this._isPlaneSet=false;this._assetUpdateCounter=this._assetUpdateCounter+1;this.reset();}},{key:\"initializeRoomPlanes\",value:function initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return false;if(!isNaN(this._floorThickness))this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness;if(!isNaN(this._wallThickness))this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness;var mapData=this.object.model.getValue(RoomObjectVariable.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(mapData))return;var _local_3=this.getLandscapeWidth();var _local_4=this.getLandscapeHeight();var _local_5=0;var randomSeed=this.object.model.getValue(RoomObjectVariable.ROOM_RANDOM_SEED);var index=0;while(index<this._roomPlaneParser.planeCount){var location=this._roomPlaneParser.getPlaneLocation(index);var leftSide=this._roomPlaneParser.getPlaneLeftSide(index);var rightSide=this._roomPlaneParser.getPlaneRightSide(index);var secondaryNormals=this._roomPlaneParser.getPlaneSecondaryNormals(index);var planeType=this._roomPlaneParser.getPlaneType(index);var plane=null;if(location&&leftSide&&rightSide){var _local_14=Vector3d.crossProduct(leftSide,rightSide);randomSeed=randomSeed*7613+517;plane=null;if(planeType===RoomPlaneData.PLANE_FLOOR){var _local_15=location.x+leftSide.x+0.5;var _local_16=location.y+rightSide.y+0.5;var textureOffsetX=Math.trunc(_local_15)-_local_15;var textureOffsetY=Math.trunc(_local_16)-_local_16;plane=new RoomPlane(this.object.getLocation(),location,leftSide,rightSide,RoomPlane.TYPE_FLOOR,true,secondaryNormals,randomSeed,-textureOffsetX,-textureOffsetY);if(_local_14.z!==0){plane.color=RoomVisualization.FLOOR_COLOR;}else{plane.color=_local_14.x!==0?RoomVisualization.FLOOR_COLOR_RIGHT:RoomVisualization.FLOOR_COLOR_LEFT;}if(this._data)plane.rasterizer=this._data.floorRasterizer;}else if(planeType===RoomPlaneData.PLANE_WALL){plane=new RoomPlane(this.object.getLocation(),location,leftSide,rightSide,RoomPlane.TYPE_WALL,true,secondaryNormals,randomSeed);if(leftSide.length<1||rightSide.length<1){plane.hasTexture=false;}if(_local_14.x===0&&_local_14.y===0){plane.color=RoomVisualization.WALL_COLOR_BORDER;}else{if(_local_14.y>0){plane.color=RoomVisualization.WALL_COLOR_TOP;}else{if(_local_14.y===0){plane.color=RoomVisualization.WALL_COLOR_SIDE;}else{plane.color=RoomVisualization.WALL_COLOR_BOTTOM;}}}if(this._data)plane.rasterizer=this._data.wallRasterizer;}else if(planeType===RoomPlaneData.PLANE_LANDSCAPE){plane=new RoomPlane(this.object.getLocation(),location,leftSide,rightSide,RoomPlane.TYPE_LANDSCAPE,true,secondaryNormals,randomSeed,_local_5,0,_local_3,_local_4);if(_local_14.y>0){plane.color=RoomVisualization.LANDSCAPE_COLOR_TOP;}else{if(_local_14.y==0){plane.color=RoomVisualization.LANDSCAPE_COLOR_SIDE;}else{plane.color=RoomVisualization.LANDSCAPE_COLOR_BOTTOM;}}if(this._data)plane.rasterizer=this._data.landscapeRasterizer;_local_5=_local_5+leftSide.length;}else if(planeType==RoomPlaneData.PLANE_BILLBOARD){plane=new RoomPlane(this.object.getLocation(),location,leftSide,rightSide,RoomPlane.TYPE_WALL,true,secondaryNormals,randomSeed);if(leftSide.length<1||rightSide.length<1){plane.hasTexture=false;}if(_local_14.x==0&&_local_14.y==0){plane.color=RoomVisualization.WALL_COLOR_BORDER;}else{if(_local_14.y>0){plane.color=RoomVisualization.WALL_COLOR_TOP;}else{if(_local_14.y==0){plane.color=RoomVisualization.WALL_COLOR_SIDE;}else{plane.color=RoomVisualization.WALL_COLOR_BOTTOM;}}}// if (this._Str_594 != null)\n// {\n//     _local_13.rasterizer = this._Str_594._Str_23913;\n// }\n}if(plane){plane.maskManager=this._data.maskManager;var _local_19=0;while(_local_19<this._roomPlaneParser.getPlaneMaskCount(index)){var _local_20=this._roomPlaneParser.getPlaneMaskLeftSideLoc(index,_local_19);var _local_21=this._roomPlaneParser.getPlaneMaskRightSideLoc(index,_local_19);var _local_22=this._roomPlaneParser.getPlaneMaskLeftSideLength(index,_local_19);var _local_23=this._roomPlaneParser.getPlaneMaskRightSideLength(index,_local_19);plane.addRectangleMask(_local_20,_local_21,_local_22,_local_23);_local_19++;}this._planes.push(plane);}}else{return;}index++;}this._isPlaneSet=true;this.defineSprites();return true;}},{key:\"defineSprites\",value:function defineSprites(){this.createSprites(this._planes.length);var planeIndex=0;while(planeIndex<this._planes.length){var plane=this._planes[planeIndex];var sprite=this.getSprite(planeIndex);if(plane&&sprite&&plane.leftSide&&plane.rightSide){if(plane.type===RoomPlane.TYPE_WALL&&(plane.leftSide.length<1||plane.rightSide.length<1)){sprite.alphaTolerance=AlphaTolerance.MATCH_NOTHING;}else{sprite.alphaTolerance=AlphaTolerance.MATCH_OPAQUE_PIXELS;}if(plane.type===RoomPlane.TYPE_WALL){sprite.tag='plane.wall@'+(planeIndex+1);}else if(plane.type===RoomPlane.TYPE_FLOOR){sprite.tag='plane.floor@'+(planeIndex+1);}else{sprite.tag='plane@'+(planeIndex+1);}sprite.spriteType=RoomObjectSpriteType.ROOM_PLANE;}planeIndex++;}}},{key:\"getLandscapeWidth\",value:function getLandscapeWidth(){var length=0;var index=0;while(index<this._roomPlaneParser.planeCount){var type=this._roomPlaneParser.getPlaneType(index);if(type===RoomPlaneData.PLANE_LANDSCAPE){var vector=this._roomPlaneParser.getPlaneLeftSide(index);length+=vector.length;}index++;}return length;}},{key:\"getLandscapeHeight\",value:function getLandscapeHeight(){var length=0;var index=0;while(index<this._roomPlaneParser.planeCount){var type=this._roomPlaneParser.getPlaneType(index);if(type===RoomPlaneData.PLANE_LANDSCAPE){var vector=this._roomPlaneParser.getPlaneRightSide(index);if(vector.length>length)length=vector.length;}index++;}if(length>5)length=5;return length;}},{key:\"updatePlaneTypes\",value:function updatePlaneTypes(floorType,wallType,landscapeType){if(floorType!==this._floorType)this._floorType=floorType;else floorType=null;if(wallType!==this._wallType)this._wallType=wallType;else wallType=null;if(landscapeType!==this._landscapeType)this._landscapeType=landscapeType;else landscapeType=null;if(!floorType&&!wallType&&!landscapeType)return false;var index=0;while(index<this._planes.length){var plane=this._planes[index];if(plane){if(plane.type===RoomPlane.TYPE_FLOOR&&floorType){plane.id=floorType;}else if(plane.type===RoomPlane.TYPE_WALL&&wallType){plane.id=wallType;}else if(plane.type===RoomPlane.TYPE_LANDSCAPE&&landscapeType){plane.id=landscapeType;}}index++;}return true;}},{key:\"updatePlaneVisibility\",value:function updatePlaneVisibility(k,_arg_2,_arg_3){if(k===this._typeVisibility[RoomPlane.TYPE_FLOOR]&&_arg_2===this._typeVisibility[RoomPlane.TYPE_WALL]&&_arg_3===this._typeVisibility[RoomPlane.TYPE_LANDSCAPE])return;this._typeVisibility[RoomPlane.TYPE_FLOOR]=k;this._typeVisibility[RoomPlane.TYPE_WALL]=_arg_2;this._typeVisibility[RoomPlane.TYPE_LANDSCAPE]=_arg_3;this._visiblePlanes=[];this._visiblePlaneSpriteNumbers=[];}},{key:\"updatePlanes\",value:function updatePlanes(k,_arg_2,_arg_3){if(!k||!this.object)return;this._assetUpdateCounter++;if(_arg_2){this._visiblePlanes=[];this._visiblePlaneSpriteNumbers=[];}var _local_8=this._visiblePlanes.length>0;var _local_6=this._visiblePlanes;if(!this._visiblePlanes.length)_local_6=this._planes;var depth=0;var updated=false;var index=0;while(index<_local_6.length){var _local_10=index;if(_local_8)_local_10=this._visiblePlaneSpriteNumbers[index];var _local_11=this.getSprite(_local_10);if(_local_11){var _local_12=_local_6[index];if(_local_12){_local_11.id=_local_12.uniqueId;if(_local_12.update(k,_arg_3)){if(_local_12.visible){depth=_local_12.relativeDepth+this.floorRelativeDepth+_local_10/1000;if(_local_12.type!==RoomPlane.TYPE_FLOOR){depth=_local_12.relativeDepth+this.wallRelativeDepth+_local_10/1000;if(_local_12.leftSide.length<1||_local_12.rightSide.length<1){depth=depth+RoomVisualization.ROOM_DEPTH_OFFSET*0.5;}}var _local_14='plane '+_local_10+' '+k.scale;this.updateSprite(_local_11,_local_12,_local_14,depth);}updated=true;}if(_local_11.visible!=(_local_12.visible&&this._typeVisibility[_local_12.type])){_local_11.visible=!_local_11.visible;updated=true;}if(_local_11.visible){if(!_local_8){this._visiblePlanes.push(_local_12);this._visiblePlaneSpriteNumbers.push(index);}}}else{_local_11.id=0;if(_local_11.visible){_local_11.visible=false;updated=true;}}}index++;}return updated;}},{key:\"updatePlaneMasks\",value:function updatePlaneMasks(k){if(!k)return;this._roomPlaneBitmapMaskParser.initialize(k);var _local_4=[];var _local_5=[];var _local_6=false;var index=0;while(index<this._planes.length){var plane=this._planes[index];if(plane){plane.resetBitmapMasks();if(plane.type===RoomPlane.TYPE_LANDSCAPE)_local_4.push(index);}index++;}var _iterator2=_createForOfIteratorHelper(this._roomPlaneBitmapMaskParser.masks.values()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var mask=_step2.value;var maskType=this._roomPlaneBitmapMaskParser.getMaskType(mask);var maskLocation=this._roomPlaneBitmapMaskParser.getMaskLocation(mask);var maskCategory=this._roomPlaneBitmapMaskParser.getMaskCategory(mask);if(maskLocation){var i=0;while(i<this._planes.length){var _plane2=this._planes[i];if(_plane2.type===RoomPlane.TYPE_WALL||_plane2.type===RoomPlane.TYPE_LANDSCAPE){if(_plane2&&_plane2.location&&_plane2.normal){var _local_14=Vector3d.dif(maskLocation,_plane2.location);var _local_15=Math.abs(Vector3d.scalarProjection(_local_14,_plane2.normal));if(_local_15<0.01){if(_plane2.leftSide&&_plane2.rightSide){var _local_16=Vector3d.scalarProjection(_local_14,_plane2.leftSide);var _local_17=Vector3d.scalarProjection(_local_14,_plane2.rightSide);if(_plane2.type===RoomPlane.TYPE_WALL||_plane2.type===RoomPlane.TYPE_LANDSCAPE&&maskCategory===RoomPlaneBitmapMaskData.HOLE){_plane2.addBitmapMask(maskType,_local_16,_local_17);}else{if(_plane2.type===RoomPlane.TYPE_LANDSCAPE){if(!_plane2.canBeVisible)_local_6=true;_plane2.canBeVisible=true;_local_5.push(i);}}}}}}i++;}}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}index=0;while(index<_local_4.length){var planeIndex=_local_4[index];if(_local_5.indexOf(planeIndex)<0){var _plane=this._planes[planeIndex];_plane.canBeVisible=false;_local_6=true;}index++;}if(_local_6){this._visiblePlanes=[];this._visiblePlaneSpriteNumbers=[];}}},{key:\"updateSprite\",value:function updateSprite(k,_arg_2,_arg_3,_arg_4){var offset=_arg_2.offset;k.offsetX=-offset.x;k.offsetY=-offset.y;k.relativeDepth=_arg_4;k.color=_arg_2.color;k.texture=this.getPlaneBitmap(_arg_2,_arg_3);k.name=_arg_3+'_'+this._assetUpdateCounter;}},{key:\"getPlaneBitmap\",value:function getPlaneBitmap(k,_arg_2){return k.bitmapData;}},{key:\"getBoundingRectangle\",value:function getBoundingRectangle(){if(!this._boundingRectangle)this._boundingRectangle=_get(_getPrototypeOf(RoomVisualization.prototype),\"getBoundingRectangle\",this).call(this);return new Rectangle(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height);}},{key:\"planes\",get:function get(){var planes=[];var _iterator3=_createForOfIteratorHelper(this._visiblePlanes),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var plane=_step3.value;planes.push(plane);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return planes;}},{key:\"floorRelativeDepth\",get:function get(){return RoomVisualization.ROOM_DEPTH_OFFSET+0.1;}},{key:\"wallRelativeDepth\",get:function get(){return RoomVisualization.ROOM_DEPTH_OFFSET+0.5;}}],[{key:\"getTextureCache\",value:function getTextureCache(key){var existing=RoomVisualization.RENDER_TEXTURE_CACHE.get(RoomVisualization.LAST_VISUALIZATION);if(!existing)return null;return existing.getValue(key);}},{key:\"addTextureCache\",value:function addTextureCache(key,value){if(!RoomVisualization.LAST_VISUALIZATION)return;var existing=RoomVisualization.RENDER_TEXTURE_CACHE.get(RoomVisualization.LAST_VISUALIZATION);if(!existing){existing=new AdvancedMap();RoomVisualization.RENDER_TEXTURE_CACHE.set(RoomVisualization.LAST_VISUALIZATION,existing);}existing.add(key,value);}}]);return RoomVisualization;}(RoomObjectSpriteVisualization);RoomVisualization.LAST_VISUALIZATION=null;RoomVisualization.RENDER_TEXTURE_CACHE=new Map();RoomVisualization.FLOOR_COLOR=0xFFFFFF;RoomVisualization.FLOOR_COLOR_LEFT=0xDDDDDD;RoomVisualization.FLOOR_COLOR_RIGHT=0xBBBBBB;RoomVisualization.WALL_COLOR_TOP=0xFFFFFF;RoomVisualization.WALL_COLOR_SIDE=0xCCCCCC;RoomVisualization.WALL_COLOR_BOTTOM=0x999999;RoomVisualization.WALL_COLOR_BORDER=0x999999;RoomVisualization.LANDSCAPE_COLOR_TOP=0xFFFFFF;RoomVisualization.LANDSCAPE_COLOR_SIDE=0xCCCCCC;RoomVisualization.LANDSCAPE_COLOR_BOTTOM=0x999999;RoomVisualization.ROOM_DEPTH_OFFSET=1000;","map":null,"metadata":{},"sourceType":"module"}