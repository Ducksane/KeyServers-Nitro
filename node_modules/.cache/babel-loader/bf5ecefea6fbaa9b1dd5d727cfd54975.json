{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RoomObjectVariable,Vector3d}from'@nitrots/nitro-renderer';import{useEffect,useState}from'react';import{attemptItemPlacement,FurniCategory,GetRoomEngine,GetSessionDataManager,LocalizeText,UnseenItemCategory}from'../../../../api';import{AutoGrid,Button,Column,Grid,LayoutLimitedEditionCompactPlateView,LayoutRarityLevelView,LayoutRoomPreviewerView,Text}from'../../../../common';import{CatalogPostMarketplaceOfferEvent}from'../../../../events';import{DispatchUiEvent,useInventoryFurni,useInventoryUnseenTracker}from'../../../../hooks';import{InventoryCategoryEmptyView}from'../InventoryCategoryEmptyView';import{InventoryFurnitureItemView}from'./InventoryFurnitureItemView';import{InventoryFurnitureSearchView}from'./InventoryFurnitureSearchView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var attemptPlaceMarketplaceOffer=function attemptPlaceMarketplaceOffer(groupItem){var item=groupItem.getLastItem();if(!item)return false;if(!item.sellable)return false;DispatchUiEvent(new CatalogPostMarketplaceOfferEvent(item));};export var InventoryFurnitureView=function InventoryFurnitureView(props){var _props$roomSession=props.roomSession,roomSession=_props$roomSession===void 0?null:_props$roomSession,_props$roomPreviewer=props.roomPreviewer,roomPreviewer=_props$roomPreviewer===void 0?null:_props$roomPreviewer;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),filteredGroupItems=_useState4[0],setFilteredGroupItems=_useState4[1];var _useInventoryFurni=useInventoryFurni(),_useInventoryFurni$gr=_useInventoryFurni.groupItems,groupItems=_useInventoryFurni$gr===void 0?[]:_useInventoryFurni$gr,_useInventoryFurni$se=_useInventoryFurni.selectedItem,selectedItem=_useInventoryFurni$se===void 0?null:_useInventoryFurni$se,_useInventoryFurni$ac=_useInventoryFurni.activate,activate=_useInventoryFurni$ac===void 0?null:_useInventoryFurni$ac,_useInventoryFurni$de=_useInventoryFurni.deactivate,deactivate=_useInventoryFurni$de===void 0?null:_useInventoryFurni$de;var _useInventoryUnseenTr=useInventoryUnseenTracker(),_useInventoryUnseenTr2=_useInventoryUnseenTr.resetItems,resetItems=_useInventoryUnseenTr2===void 0?null:_useInventoryUnseenTr2;useEffect(function(){if(!selectedItem||!roomPreviewer)return;var furnitureItem=selectedItem.getLastItem();if(!furnitureItem)return;var roomEngine=GetRoomEngine();var wallType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_WALL_TYPE);var floorType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_FLOOR_TYPE);var landscapeType=roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId,RoomObjectVariable.ROOM_LANDSCAPE_TYPE);wallType=wallType&&wallType.length?wallType:'101';floorType=floorType&&floorType.length?floorType:'101';landscapeType=landscapeType&&landscapeType.length?landscapeType:'1.1';roomPreviewer.reset(false);roomPreviewer.updateObjectRoom(floorType,wallType,landscapeType);roomPreviewer.updateRoomWallsAndFloorVisibility(true,true);if(furnitureItem.category===FurniCategory.WALL_PAPER||furnitureItem.category===FurniCategory.FLOOR||furnitureItem.category===FurniCategory.LANDSCAPE){floorType=furnitureItem.category===FurniCategory.FLOOR?selectedItem.stuffData.getLegacyString():floorType;wallType=furnitureItem.category===FurniCategory.WALL_PAPER?selectedItem.stuffData.getLegacyString():wallType;landscapeType=furnitureItem.category===FurniCategory.LANDSCAPE?selectedItem.stuffData.getLegacyString():landscapeType;roomPreviewer.updateObjectRoom(floorType,wallType,landscapeType);if(furnitureItem.category===FurniCategory.LANDSCAPE){var data=GetSessionDataManager().getWallItemDataByName('noob_window_double');if(data)roomPreviewer.addWallItemIntoRoom(data.id,new Vector3d(90,0,0),data.customParams);}}else{if(selectedItem.isWallItem){roomPreviewer.addWallItemIntoRoom(selectedItem.type,new Vector3d(90),furnitureItem.stuffData.getLegacyString());}else{roomPreviewer.addFurnitureIntoRoom(selectedItem.type,new Vector3d(90),selectedItem.stuffData,furnitureItem.extra.toString());}}},[roomPreviewer,selectedItem]);useEffect(function(){if(!selectedItem||!selectedItem.hasUnseenItems)return;resetItems(UnseenItemCategory.FURNI,selectedItem.items.map(function(item){return item.id;}));selectedItem.hasUnseenItems=false;},[selectedItem,resetItems]);useEffect(function(){if(!isVisible)return;var id=activate();return function(){return deactivate(id);};},[isVisible,activate,deactivate]);useEffect(function(){setIsVisible(true);return function(){return setIsVisible(false);};},[]);if(!groupItems||!groupItems.length)return/*#__PURE__*/_jsx(InventoryCategoryEmptyView,{title:LocalizeText('inventory.empty.title'),desc:LocalizeText('inventory.empty.desc')});return/*#__PURE__*/_jsxs(Grid,{children:[/*#__PURE__*/_jsxs(Column,{size:7,overflow:\"hidden\",children:[/*#__PURE__*/_jsx(InventoryFurnitureSearchView,{groupItems:groupItems,setGroupItems:setFilteredGroupItems}),/*#__PURE__*/_jsx(AutoGrid,{columnCount:5,children:filteredGroupItems&&filteredGroupItems.length>0&&filteredGroupItems.map(function(item,index){return/*#__PURE__*/_jsx(InventoryFurnitureItemView,{groupItem:item},index);})})]}),/*#__PURE__*/_jsxs(Column,{size:5,overflow:\"auto\",children:[/*#__PURE__*/_jsxs(Column,{overflow:\"hidden\",position:\"relative\",children:[/*#__PURE__*/_jsx(LayoutRoomPreviewerView,{roomPreviewer:roomPreviewer,height:140}),selectedItem&&selectedItem.stuffData.isUnique&&/*#__PURE__*/_jsx(LayoutLimitedEditionCompactPlateView,{className:\"top-2 end-2\",position:\"absolute\",uniqueNumber:selectedItem.stuffData.uniqueNumber,uniqueSeries:selectedItem.stuffData.uniqueSeries}),selectedItem&&selectedItem.stuffData.rarityLevel>-1&&/*#__PURE__*/_jsx(LayoutRarityLevelView,{className:\"top-2 end-2\",position:\"absolute\",level:selectedItem.stuffData.rarityLevel})]}),selectedItem&&/*#__PURE__*/_jsx(Column,{grow:true,justifyContent:\"between\",gap:1,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{style:{color:\"var(--test-galaxytext)\"},variant:\"none\",grow:true,truncate:true,children:selectedItem.name}),!!roomSession&&/*#__PURE__*/_jsx(Button,{style:{marginTop:\"10px\"},variant:\"success\",onClick:function onClick(event){return attemptItemPlacement(selectedItem);},children:LocalizeText('inventory.furni.placetoroom')}),selectedItem&&selectedItem.isSellable&&/*#__PURE__*/_jsx(Button,{style:{marginTop:\"10px\"},onClick:function onClick(event){return attemptPlaceMarketplaceOffer(selectedItem);},children:LocalizeText('inventory.marketplace.sell')})]})})]})]});};","map":null,"metadata":{},"sourceType":"module"}