{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _toConsumableArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RoomObjectCategory,RoomObjectUserType}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{RoomWidgetUpdateRoomObjectEvent}from'../../../../api';import{UseEventDispatcherHook,useFriends}from'../../../../hooks';import{useRoomContext}from'../../RoomContext';import{FriendRequestDialogView}from'./FriendRequestDialogView';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var FriendRequestWidgetView=function FriendRequestWidgetView(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),displayedRequests=_useState2[0],setDisplayedRequests=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),dismissedRequestIds=_useState4[0],setDismissedRequestIds=_useState4[1];var _useRoomContext=useRoomContext(),_useRoomContext$roomS=_useRoomContext.roomSession,roomSession=_useRoomContext$roomS===void 0?null:_useRoomContext$roomS,_useRoomContext$event=_useRoomContext.eventDispatcher,eventDispatcher=_useRoomContext$event===void 0?null:_useRoomContext$event;var _useFriends=useFriends(),_useFriends$requests=_useFriends.requests,requests=_useFriends$requests===void 0?[]:_useFriends$requests;var hideFriendRequest=function hideFriendRequest(userId){setDismissedRequestIds(function(prevValue){if(prevValue.indexOf(userId)>=0)return prevValue;var newValue=_toConsumableArray(prevValue);newValue.push(userId);return newValue;});};var onRoomWidgetUpdateRoomObjectEvent=useCallback(function(event){if(event.category!==RoomObjectCategory.UNIT)return;var userData=roomSession.userDataManager.getUserDataByIndex(event.id);if(userData&&userData.type===RoomObjectUserType.getTypeNumber(RoomObjectUserType.USER)){if(event.type===RoomWidgetUpdateRoomObjectEvent.USER_ADDED){var request=requests.find(function(request){return request.requesterUserId===userData.webID;});if(!request||displayedRequests.find(function(request){return request.request.requesterUserId===userData.webID;}))return;var newValue=_toConsumableArray(displayedRequests);newValue.push({roomIndex:userData.roomIndex,request:request});setDisplayedRequests(newValue);}return;}if(event.type===RoomWidgetUpdateRoomObjectEvent.USER_REMOVED){var index=displayedRequests.findIndex(function(request){return request.roomIndex===event.id;});if(index===-1)return;var _newValue=_toConsumableArray(displayedRequests);_newValue.splice(index,1);setDisplayedRequests(_newValue);}},[roomSession,requests,displayedRequests]);UseEventDispatcherHook(RoomWidgetUpdateRoomObjectEvent.USER_ADDED,eventDispatcher,onRoomWidgetUpdateRoomObjectEvent);UseEventDispatcherHook(RoomWidgetUpdateRoomObjectEvent.USER_REMOVED,eventDispatcher,onRoomWidgetUpdateRoomObjectEvent);useEffect(function(){if(!requests||!requests.length)return;var newDisplayedRequests=[];var _iterator=_createForOfIteratorHelper(requests),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var request=_step.value;var userData=roomSession.userDataManager.getUserData(request.requesterUserId);if(!userData)continue;newDisplayedRequests.push({roomIndex:userData.roomIndex,request:request});}}catch(err){_iterator.e(err);}finally{_iterator.f();}setDisplayedRequests(newDisplayedRequests);},[roomSession,requests]);if(!requests.length)return null;return/*#__PURE__*/_jsx(_Fragment,{children:displayedRequests.map(function(request,index){if(dismissedRequestIds.indexOf(request.request.requesterUserId)>=0)return null;return/*#__PURE__*/_jsx(FriendRequestDialogView,{roomIndex:request.roomIndex,request:request.request,hideFriendRequest:hideFriendRequest},index);})});};","map":null,"metadata":{},"sourceType":"module"}