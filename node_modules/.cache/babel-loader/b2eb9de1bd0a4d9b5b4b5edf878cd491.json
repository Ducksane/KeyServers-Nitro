{"ast":null,"code":"import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{GuideSessionGetRequesterRoomMessageComposer,GuideSessionInviteRequesterMessageComposer,GuideSessionMessageMessageComposer,GuideSessionRequesterRoomMessageEvent,GuideSessionResolvedMessageComposer}from'@nitrots/nitro-renderer';import{useCallback,useState}from'react';import{GetSessionDataManager,LocalizeText,SendMessageComposer,TryVisitRoom}from'../../../api';import{Base,Button,ButtonGroup,Column,Flex,LayoutAvatarImageView,Text}from'../../../common';import{UseMessageEventHook}from'../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var GuideToolOngoingView=function GuideToolOngoingView(props){var _props$isGuide=props.isGuide,isGuide=_props$isGuide===void 0?false:_props$isGuide,_props$userId=props.userId,userId=_props$userId===void 0?0:_props$userId,_props$userName=props.userName,userName=_props$userName===void 0?null:_props$userName,_props$userFigure=props.userFigure,userFigure=_props$userFigure===void 0?null:_props$userFigure,_props$isTyping=props.isTyping,isTyping=_props$isTyping===void 0?false:_props$isTyping,_props$messageGroups=props.messageGroups,messageGroups=_props$messageGroups===void 0?[]:_props$messageGroups;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),messageText=_useState2[0],setMessageText=_useState2[1];var visit=useCallback(function(){SendMessageComposer(new GuideSessionGetRequesterRoomMessageComposer());},[]);var invite=useCallback(function(){SendMessageComposer(new GuideSessionInviteRequesterMessageComposer());},[]);var resolve=useCallback(function(){SendMessageComposer(new GuideSessionResolvedMessageComposer());},[]);var onGuideSessionRequesterRoomMessageEvent=useCallback(function(event){var parser=event.getParser();TryVisitRoom(parser.requesterRoomId);},[]);UseMessageEventHook(GuideSessionRequesterRoomMessageEvent,onGuideSessionRequesterRoomMessageEvent);var sendMessage=useCallback(function(){if(!messageText||!messageText.length)return;SendMessageComposer(new GuideSessionMessageMessageComposer(messageText));setMessageText('');},[messageText]);var onKeyDown=useCallback(function(event){if(event.key!=='Enter')return;sendMessage();},[sendMessage]);var isOwnChat=useCallback(function(userId){return userId===GetSessionDataManager().userId;},[]);return/*#__PURE__*/_jsxs(Column,{fullHeight:true,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",gap:1,className:\"bg-muted p-2 rounded\",children:[isGuide&&/*#__PURE__*/_jsxs(ButtonGroup,{children:[/*#__PURE__*/_jsx(Button,{onClick:visit,children:LocalizeText('guide.help.request.guide.ongoing.visit.button')}),/*#__PURE__*/_jsx(Button,{disabled:true,onClick:invite,children:LocalizeText('guide.help.request.guide.ongoing.invite.button')})]}),!isGuide&&/*#__PURE__*/_jsxs(Column,{gap:0,children:[/*#__PURE__*/_jsx(Text,{bold:true,children:userName}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('guide.help.request.user.ongoing.guide.desc')})]}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",disabled:true,children:LocalizeText('guide.help.common.report.link')})]}),/*#__PURE__*/_jsx(Column,{overflow:\"hidden\",gap:1,className:\"bg-muted rounded chat-messages p-2\",children:/*#__PURE__*/_jsx(Column,{overflow:\"auto\",children:messageGroups.map(function(group,index){return/*#__PURE__*/_jsxs(Flex,{fullWidth:true,justifyContent:isOwnChat(group.userId)?'end':'start',gap:2,children:[/*#__PURE__*/_jsx(Base,{shrink:true,className:\"message-avatar\",children:!isOwnChat(group.userId)&&/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:userFigure,direction:2})}),/*#__PURE__*/_jsxs(Base,{className:'bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-'+(isOwnChat(group.userId)?'right':'left'),children:[/*#__PURE__*/_jsxs(Text,{bold:true,children:[isOwnChat(group.userId)&&GetSessionDataManager().userName,!isOwnChat(group.userId)&&userName]}),group.messages.map(function(chat,index){return/*#__PURE__*/_jsx(Base,{className:\"text-break\",children:chat.message},index);})]}),isOwnChat(group.userId)&&/*#__PURE__*/_jsx(Base,{className:\"message-avatar flex-shrink-0\",children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:GetSessionDataManager().figure,direction:4})})]},index);})})}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",placeholder:LocalizeText('guide.help.request.guide.ongoing.input.empty',['name'],[userName]),value:messageText,onChange:function onChange(event){return setMessageText(event.target.value);},onKeyDown:onKeyDown}),/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:sendMessage,children:LocalizeText('widgets.chatinput.say')})]}),isTyping&&/*#__PURE__*/_jsx(Text,{variant:\"muted\",children:LocalizeText('guide.help.common.typing')})]}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"success\",onClick:resolve,children:LocalizeText('guide.help.request.'+(isGuide?'guide':'user')+'.ongoing.close.link')})]});};","map":null,"metadata":{},"sourceType":"module"}