{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{RoomEngineUseProductEvent,RoomObjectCategory,RoomObjectType,RoomObjectVariable,RoomSessionDanceEvent,RoomSessionPetStatusUpdateEvent,RoomSessionUserDataUpdateEvent,RoomWidgetEnum,SetRelationshipStatusComposer}from'@nitrots/nitro-renderer';import{SendMessageComposer}from'../../..';import{GetRoomEngine,GetSessionDataManager,IsOwnerOfFurniture}from'../../../..';import{MessengerFriend}from'../../../../friends/MessengerFriend';import{FurniCategory}from'../../../../inventory/FurniCategory';import{RoomWidgetAvatarInfoEvent,RoomWidgetUpdateDanceStatusEvent,RoomWidgetUpdateUserDataEvent,RoomWidgetUseProductBubbleEvent,UseProductItem}from'../events';import{RoomWidgetAvatarExpressionMessage,RoomWidgetChangePostureMessage,RoomWidgetDanceMessage,RoomWidgetRoomObjectMessage,RoomWidgetUseProductMessage,RoomWidgetUserActionMessage}from'../messages';import{RoomWidgetHandler}from'./RoomWidgetHandler';export var RoomWidgetAvatarInfoHandler=/*#__PURE__*/function(_RoomWidgetHandler){_inherits(RoomWidgetAvatarInfoHandler,_RoomWidgetHandler);var _super=_createSuper(RoomWidgetAvatarInfoHandler);function RoomWidgetAvatarInfoHandler(){_classCallCheck(this,RoomWidgetAvatarInfoHandler);return _super.apply(this,arguments);}_createClass(RoomWidgetAvatarInfoHandler,[{key:\"processEvent\",value:function processEvent(event){switch(event.type){case RoomSessionUserDataUpdateEvent.USER_DATA_UPDATED:this.container.eventDispatcher.dispatchEvent(new RoomWidgetUpdateUserDataEvent());return;case RoomSessionDanceEvent.RSDE_DANCE:var danceEvent=event;var isDancing=false;var userData=this.container.roomSession.userDataManager.getUserData(GetSessionDataManager().userId);if(userData&&userData.roomIndex===danceEvent.roomIndex)isDancing=danceEvent.danceId!==0;this.container.eventDispatcher.dispatchEvent(new RoomWidgetUpdateDanceStatusEvent(isDancing));return;case RoomEngineUseProductEvent.USE_PRODUCT_FROM_INVENTORY:return;case RoomEngineUseProductEvent.USE_PRODUCT_FROM_ROOM:this.processUsableRoomObject(event.objectId);return;case RoomSessionPetStatusUpdateEvent.PET_STATUS_UPDATE:this.processRoomSessionPetStatusUpdateEvent(event);return;}}},{key:\"processWidgetMessage\",value:function processWidgetMessage(message){var userId=0;if(message instanceof RoomWidgetUserActionMessage)userId=message.userId;switch(message.type){case RoomWidgetRoomObjectMessage.GET_OWN_CHARACTER_INFO:this.processOwnCharacterInfo();break;case RoomWidgetUserActionMessage.START_NAME_CHANGE:// habbo help - start name change\nbreak;case RoomWidgetUserActionMessage.REQUEST_PET_UPDATE:break;case RoomWidgetUseProductMessage.PET_PRODUCT:{var productMessage=message;this.container.roomSession.usePetProduct(productMessage.objectId,productMessage.petId);break;}case RoomWidgetUserActionMessage.HARVEST_PET:this.container.roomSession.harvestPet(userId);break;case RoomWidgetUserActionMessage.COMPOST_PLANT:this.container.roomSession.compostPlant(userId);break;case RoomWidgetDanceMessage.DANCE:{var danceMessage=message;this.container.roomSession.sendDanceMessage(danceMessage.style);break;}case RoomWidgetAvatarExpressionMessage.AVATAR_EXPRESSION:{var expressionMessage=message;this.container.roomSession.sendExpressionMessage(expressionMessage.animation.ordinal);break;}case RoomWidgetChangePostureMessage.CHANGE_POSTURE:{var postureMessage=message;this.container.roomSession.sendPostureMessage(postureMessage.posture);break;}case RoomWidgetUserActionMessage.RELATIONSHIP_NONE:{SendMessageComposer(new SetRelationshipStatusComposer(userId,MessengerFriend.RELATIONSHIP_NONE));break;}case RoomWidgetUserActionMessage.RELATIONSHIP_HEART:{SendMessageComposer(new SetRelationshipStatusComposer(userId,MessengerFriend.RELATIONSHIP_HEART));break;}case RoomWidgetUserActionMessage.RELATIONSHIP_SMILE:{SendMessageComposer(new SetRelationshipStatusComposer(userId,MessengerFriend.RELATIONSHIP_SMILE));break;}case RoomWidgetUserActionMessage.RELATIONSHIP_BOBBA:{SendMessageComposer(new SetRelationshipStatusComposer(userId,MessengerFriend.RELATIONSHIP_BOBBA));break;}}return null;}},{key:\"processOwnCharacterInfo\",value:function processOwnCharacterInfo(){var userId=GetSessionDataManager().userId;var userName=GetSessionDataManager().userName;var allowNameChange=GetSessionDataManager().canChangeName;var userData=this.container.roomSession.userDataManager.getUserData(userId);if(!userData)return;this.container.eventDispatcher.dispatchEvent(new RoomWidgetAvatarInfoEvent(userId,userName,userData.type,userData.roomIndex,allowNameChange));}},{key:\"processUsableRoomObject\",value:function processUsableRoomObject(objectId){var roomId=this.container.roomSession.roomId;var roomObject=GetRoomEngine().getRoomObject(roomId,objectId,RoomObjectCategory.FLOOR);if(!roomObject||!IsOwnerOfFurniture(roomObject))return;var ownerId=roomObject.model.getValue(RoomObjectVariable.FURNITURE_OWNER_ID);var typeId=roomObject.model.getValue(RoomObjectVariable.FURNITURE_TYPE_ID);var furniData=GetSessionDataManager().getFloorItemData(typeId);var parts=furniData.customParams.split(' ');var part=parts.length?parseInt(parts[0]):-1;if(part===-1)return;this.processUseableProduct(roomId,objectId,part,furniData.specialType,ownerId);}},{key:\"processUseableProduct\",value:function processUseableProduct(roomId,objectId,part,specialType,ownerId){var arg6=arguments.length>5&&arguments[5]!==undefined?arguments[5]:-1;var useProductBubbles=[];var roomObjects=GetRoomEngine().getRoomObjects(roomId,RoomObjectCategory.UNIT);var _iterator=_createForOfIteratorHelper(roomObjects),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var roomObject=_step.value;var userData=this.container.roomSession.userDataManager.getUserDataByIndex(roomObject.id);var replace=false;if(!userData||userData.type!==RoomObjectType.PET){}else{if(userData.ownerId===ownerId){if(userData.hasSaddle&&specialType===FurniCategory.PET_SADDLE)replace=true;var figureParts=userData.figure.split(' ');var figurePart=figureParts.length?parseInt(figureParts[0]):-1;if(figurePart===part){if(specialType===FurniCategory.MONSTERPLANT_REVIVAL){if(!userData.canRevive)continue;}if(specialType===FurniCategory.MONSTERPLANT_REBREED){if(userData.petLevel<7||userData.canRevive||userData.canBreed)continue;}if(specialType===FurniCategory.MONSTERPLANT_FERTILIZE){if(userData.petLevel>=7||userData.canRevive)continue;}useProductBubbles.push(new UseProductItem(userData.roomIndex,RoomObjectCategory.UNIT,userData.name,objectId,roomObject.id,arg6,replace));}}}}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(useProductBubbles.length)this.container.eventDispatcher.dispatchEvent(new RoomWidgetUseProductBubbleEvent(RoomWidgetUseProductBubbleEvent.USE_PRODUCT_BUBBLES,useProductBubbles));}},{key:\"processRoomSessionPetStatusUpdateEvent\",value:function processRoomSessionPetStatusUpdateEvent(event){}},{key:\"type\",get:function get(){return RoomWidgetEnum.AVATAR_INFO;}},{key:\"eventTypes\",get:function get(){return[RoomSessionUserDataUpdateEvent.USER_DATA_UPDATED,RoomSessionDanceEvent.RSDE_DANCE,RoomEngineUseProductEvent.USE_PRODUCT_FROM_INVENTORY,RoomEngineUseProductEvent.USE_PRODUCT_FROM_ROOM,RoomSessionPetStatusUpdateEvent.PET_STATUS_UPDATE];}// UserNameUpdateEvent.UNUE_NAME_UPDATED\n// RoomSessionNestBreedingSuccessEvent.RSPFUE_NEST_BREEDING_SUCCESS\n// RoomSessionPetLevelUpdateEvent.RSPLUE_PET_LEVEL_UPDATE\n},{key:\"messageTypes\",get:function get(){return[RoomWidgetRoomObjectMessage.GET_OWN_CHARACTER_INFO,RoomWidgetUserActionMessage.START_NAME_CHANGE,RoomWidgetUserActionMessage.REQUEST_PET_UPDATE,RoomWidgetUseProductMessage.PET_PRODUCT,RoomWidgetUserActionMessage.REQUEST_BREED_PET,RoomWidgetUserActionMessage.HARVEST_PET,RoomWidgetUserActionMessage.REVIVE_PET,RoomWidgetUserActionMessage.COMPOST_PLANT,RoomWidgetDanceMessage.DANCE,RoomWidgetAvatarExpressionMessage.AVATAR_EXPRESSION,RoomWidgetChangePostureMessage.CHANGE_POSTURE,RoomWidgetUserActionMessage.RELATIONSHIP_NONE,RoomWidgetUserActionMessage.RELATIONSHIP_HEART,RoomWidgetUserActionMessage.RELATIONSHIP_SMILE,RoomWidgetUserActionMessage.RELATIONSHIP_BOBBA];}}]);return RoomWidgetAvatarInfoHandler;}(RoomWidgetHandler);","map":null,"metadata":{},"sourceType":"module"}