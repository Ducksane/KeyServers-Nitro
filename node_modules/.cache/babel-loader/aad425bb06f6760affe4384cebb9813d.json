{"ast":null,"code":"import _classCallCheck from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{DesktopViewEvent}from'../../communication/messages/incoming/desktop/DesktopViewEvent';import{RoomDoorbellAcceptedEvent}from'../../communication/messages/incoming/room/access/doorbell/RoomDoorbellAcceptedEvent';import{RoomDoorbellRejectedEvent}from'../../communication/messages/incoming/room/access/doorbell/RoomDoorbellRejectedEvent';import{RoomEnterEvent}from'../../communication/messages/incoming/room/access/RoomEnterEvent';import{RoomReadyMessageEvent}from'../../communication/messages/incoming/room/mapping/RoomReadyMessageEvent';import{YouAreSpectatorMessageEvent}from'../../communication/messages/incoming/room/session/YouAreSpectatorMessageEvent';import{GoToFlatMessageComposer}from'../../communication/messages/outgoing/room/session/GoToFlatMessageComposer';import{RoomSessionDoorbellEvent}from'../events/RoomSessionDoorbellEvent';import{RoomSessionSpectatorModeEvent}from'./../events/RoomSessionSpectatorModeEvent';import{BaseHandler}from'./BaseHandler';export var RoomSessionHandler=/*#__PURE__*/function(_BaseHandler){_inherits(RoomSessionHandler,_BaseHandler);var _super=_createSuper(RoomSessionHandler);function RoomSessionHandler(connection,listener){var _this;_classCallCheck(this,RoomSessionHandler);_this=_super.call(this,connection,listener);connection.addMessageEvent(new RoomEnterEvent(_this.onRoomEnterEvent.bind(_assertThisInitialized(_this))));connection.addMessageEvent(new RoomReadyMessageEvent(_this.onRoomReadyMessageEvent.bind(_assertThisInitialized(_this))));connection.addMessageEvent(new DesktopViewEvent(_this.onDesktopViewEvent.bind(_assertThisInitialized(_this))));connection.addMessageEvent(new RoomDoorbellAcceptedEvent(_this.onRoomDoorbellAcceptedEvent.bind(_assertThisInitialized(_this))));connection.addMessageEvent(new RoomDoorbellRejectedEvent(_this.onRoomDoorbellRejectedEvent.bind(_assertThisInitialized(_this))));connection.addMessageEvent(new YouAreSpectatorMessageEvent(_this.onYouAreSpectatorMessageEvent.bind(_assertThisInitialized(_this))));return _this;}_createClass(RoomSessionHandler,[{key:\"onRoomEnterEvent\",value:function onRoomEnterEvent(event){if(!(event instanceof RoomEnterEvent))return;if(this.listener)this.listener.sessionUpdate(this.roomId,RoomSessionHandler.RS_CONNECTED);}},{key:\"onRoomReadyMessageEvent\",value:function onRoomReadyMessageEvent(event){if(!(event instanceof RoomReadyMessageEvent))return;var fromRoomId=this.roomId;var toRoomId=event.getParser().roomId;if(this.listener){this.listener.sessionReinitialize(fromRoomId,toRoomId);this.listener.sessionUpdate(this.roomId,RoomSessionHandler.RS_READY);}}},{key:\"onDesktopViewEvent\",value:function onDesktopViewEvent(event){if(!(event instanceof DesktopViewEvent))return;if(this.listener)this.listener.sessionUpdate(this.roomId,RoomSessionHandler.RS_DISCONNECTED);}},{key:\"onRoomDoorbellAcceptedEvent\",value:function onRoomDoorbellAcceptedEvent(event){if(!(event instanceof RoomDoorbellAcceptedEvent)||!this.listener)return;var parser=event.getParser();if(!parser)return;var username=parser.userName;if(!username||!username.length){this.connection.send(new GoToFlatMessageComposer(this.roomId));}else{if(this.listener.events){var session=this.listener.getSession(this.roomId);if(!session)return;this.listener.events.dispatchEvent(new RoomSessionDoorbellEvent(RoomSessionDoorbellEvent.RSDE_ACCEPTED,session,username));}}}},{key:\"onRoomDoorbellRejectedEvent\",value:function onRoomDoorbellRejectedEvent(event){if(!(event instanceof RoomDoorbellRejectedEvent)||!this.listener)return;var parser=event.getParser();if(!parser)return;var username=parser.userName;if(!username||!username.length){this.listener.sessionUpdate(this.roomId,RoomSessionHandler.RS_DISCONNECTED);}else{if(this.listener.events){var session=this.listener.getSession(this.roomId);if(!session)return;this.listener.events.dispatchEvent(new RoomSessionDoorbellEvent(RoomSessionDoorbellEvent.RSDE_REJECTED,session,username));}}}},{key:\"onYouAreSpectatorMessageEvent\",value:function onYouAreSpectatorMessageEvent(event){if(this.listener){var session=this.listener.getSession(this.roomId);if(!session)return;session.isSpectator=true;this.listener.events.dispatchEvent(new RoomSessionSpectatorModeEvent(RoomSessionSpectatorModeEvent.SPECTATOR_MODE,session));}}}]);return RoomSessionHandler;}(BaseHandler);RoomSessionHandler.RS_CONNECTED='RS_CONNECTED';RoomSessionHandler.RS_READY='RS_READY';RoomSessionHandler.RS_DISCONNECTED='RS_DISCONNECTED';","map":null,"metadata":{},"sourceType":"module"}