{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Administrator\\\\Desktop\\\\nitro\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{useEffect,useRef,useState}from'react';import{AddEventLinkTracker,CreateLinkEvent,RemoveLinkEventTracker}from'../../api';import\"./UpsideView.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var UpsideView=function UpsideView(props){var isPlayed=false;var firstCheck=false;var radioUrl=\"\";var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),alerts=_useState4[0],setAlerts=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),answer=_useState6[0],setAnswer=_useState6[1];var _useState7=useState(new Audio(radioUrl)),_useState8=_slicedToArray(_useState7,2),audio=_useState8[0],setAudio=_useState8[1];var myRef=useRef();var sso=new URLSearchParams(window.location.search).get('sso');useEffect(function(){var linkTracker={linkReceived:function linkReceived(url){var parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'o':addNewAlert(parts[2],parts[3]);return;}},eventUrlPrefix:'mal/'};AddEventLinkTracker(linkTracker);return function(){return RemoveLinkEventTracker(linkTracker);};},[setIsVisible]);useEffect(function(){var intervalId=setInterval(radioChecker,3000);function radioChecker(){return _radioChecker.apply(this,arguments);}function _radioChecker(){_radioChecker=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(audio.paused)audio.play();new Promise(function(resolve){return setTimeout(resolve,1000);});if(!audio.paused)clearInterval(intervalId);case 3:case\"end\":return _context.stop();}}},_callee);}));return _radioChecker.apply(this,arguments);}},[]);function startRadio(){audio.src=radioUrl;var resp=audio.play();if(resp!==undefined){resp.then(function(_){document.getElementById(\"startRadio\").style.display=\"none\";document.getElementById(\"pauseRadio\").style.display=\"inline-block\";isPlayed=true;}).catch(function(error){});}}function pauseRadio(){document.getElementById(\"startRadio\").style.display=\"inline-block\";document.getElementById(\"pauseRadio\").style.display=\"none\";audio.pause();audio.src=\"\";isPlayed=false;}function volumeUp(){if(isPlayed)if(audio.volume!=1)audio.volume=audio.volume+0.1;}function volumeDown(){if(isPlayed){if(audio.volume<0.1)return;if(audio.volume!=0.1)audio.volume=audio.volume-0.1;}}function getPlayersOnline(){fetch('https://lavvos.eu/api/get/online.php').then(function(response){return response.text();}).then(function(result){document.getElementById(\"usersOnline\").innerHTML=result;});}function getAlert(name,text,identifier){return/*#__PURE__*/_jsxs(\"div\",{className:\"animate__animated animate__fadeInDown\",style:{padding:\"10px\",backgroundColor:\"var(--test-galaxy)\",color:\"var(--test-galaxytext)\",borderRadius:\"5px\",width:\"270px\",marginBottom:\"20px\",wordBreak:\"break-all\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"left\",marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-danger\",children:\"Nueva menci\\xF3n recibida\"}),/*#__PURE__*/_jsx(\"span\",{style:{float:\"right\",cursor:\"pointer\"},children:/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return closeAlert(identifier);},className:\"badge bg-danger\",children:\"x\"})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsxs(\"b\",{children:[name,\":\"]}),\" \\xA0\",text]}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return handleAnswer(e.target.value);},className:\"form-control\",type:\"text\",style:{marginBottom:\"4px\"}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return sendResponse(name,identifier);},className:\"btn btn-success btn-sm w-100\",children:\"Responder\"})]});}var response=\"\";function handleAnswer(a){response=a;}function sendResponse(username,identifier){fetch(\"https://int.lavvos.eu/?type=mentionUser&userToMention=\"+username+\"&message=\"+response+\"&sso=\"+sso);closeAlert(identifier);}function closeAlert(identifier){setAlerts(function(prev){return prev.filter(function(item){return item.id!==identifier;});});}function addNewAlert(_x,_x2){return _addNewAlert.apply(this,arguments);}function _addNewAlert(){_addNewAlert=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(name,text){var identifier,alert,audio;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:identifier=Math.random();alert=getAlert(name,text,identifier);setAlerts(function(oldArray){return[].concat(_toConsumableArray(oldArray),[{id:identifier,alert:alert}]);});audio=new Audio('https://lavvos.eu/swfs/sounds/plin.mp3');audio.play();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _addNewAlert.apply(this,arguments);}getPlayersOnline();setInterval(getPlayersOnline,20000);audio.volume=0.1;audio.autoplay=true;return/*#__PURE__*/_jsx(_Fragment,{children:isVisible&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"nitro-left-side animate__animated animate__backInDown\",children:[/*#__PURE__*/_jsxs(\"a\",{href:\"https://lavvos.eu\",target:\"_blank\",className:\"nitro-left-side-button btn btn-sm rounded-pill border border-light\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://lavvos.eu/swfs/images/casa.png\",style:{marginTop:\"2px\",marginBottom:\"2px\"}}),\" Web\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(event){return CreateLinkEvent('help/show');},style:{backgroundColor:\"var(--test-galaxytwo)\",marginLeft:\"7px\"},className:\"btn btn-sm rounded-pill border border-light nitro-left-side-button\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://lavvos.eu/swfs/images/frank.gif\",style:{marginTop:\"2px\",marginBottom:\"2px\"}}),\" Ayuda\"]}),/*#__PURE__*/_jsxs(\"button\",{style:{backgroundColor:\"var(--test-galaxytwo)\",marginLeft:\"7px\"},className:\"btn btn-sm rounded-pill border border-light nitro-left-side-button\",children:[/*#__PURE__*/_jsx(\"img\",{style:{transform:\"scale(0.9)\"},src:\"https://lavvos.eu/swfs/images/ons.png\"}),/*#__PURE__*/_jsx(\"b\",{id:\"usersOnline\",children:\"0\"}),\" \\xA0\"]}),/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:\"var(--test-galaxytwo)\",marginLeft:\"7px\"},className:\"btn btn-sm rounded-pill border border-light nitro-left-side-button\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"4px\"},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{id:\"startRadio\",style:{display:\"none\",fontSize:\"17px\"},onClick:function onClick(e){return startRadio();},icon:\"play\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{id:\"pauseRadio\",style:{fontSize:\"17px\"},onClick:function onClick(e){return pauseRadio();},icon:\"pause\"}),\"\\xA0\\xA0\",/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{fontSize:\"17px\"},onClick:function onClick(e){return volumeUp();},icon:\"plus\"}),\" \\xA0\",/*#__PURE__*/_jsx(FontAwesomeIcon,{style:{fontSize:\"17px\"},onClick:function onClick(e){return volumeDown();},icon:\"minus\"})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"mentionAlerts\",style:{marginTop:\"20px\"},children:alerts!=null&&/*#__PURE__*/_jsx(_Fragment,{children:alerts.map(function(alert){return/*#__PURE__*/_jsx(_Fragment,{children:alert.alert});})})})]})})});};","map":null,"metadata":{},"sourceType":"module"}