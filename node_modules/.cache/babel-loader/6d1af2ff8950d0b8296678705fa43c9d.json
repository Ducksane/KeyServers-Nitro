{"ast":null,"code":"import _objectSpread from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectWithoutProperties from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";var _excluded=[\"gap\",\"children\"];import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{GetOccupiedTilesMessageComposer,GetRoomEntryTileMessageComposer,NitroPoint,RoomEntryTileMessageEvent,RoomOccupiedTilesMessageEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{SendMessageComposer}from'../../../api';import{Base,Button,Column,Flex,Grid}from'../../../common';import{UseMessageEventHook}from'../../../hooks';import{FloorplanEditor}from'../common/FloorplanEditor';import{useFloorplanEditorContext}from'../FloorplanEditorContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var FloorplanCanvasView=function FloorplanCanvasView(props){var _props$gap=props.gap,gap=_props$gap===void 0?1:_props$gap,_props$children=props.children,children=_props$children===void 0?null:_props$children,rest=_objectWithoutProperties(props,_excluded);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),occupiedTilesReceived=_useState2[0],setOccupiedTilesReceived=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),entryTileReceived=_useState4[0],setEntryTileReceived=_useState4[1];var _useFloorplanEditorCo=useFloorplanEditorContext(),_useFloorplanEditorCo2=_useFloorplanEditorCo.originalFloorplanSettings,originalFloorplanSettings=_useFloorplanEditorCo2===void 0?null:_useFloorplanEditorCo2,_useFloorplanEditorCo3=_useFloorplanEditorCo.setOriginalFloorplanSettings,setOriginalFloorplanSettings=_useFloorplanEditorCo3===void 0?null:_useFloorplanEditorCo3,_useFloorplanEditorCo4=_useFloorplanEditorCo.setVisualizationSettings,setVisualizationSettings=_useFloorplanEditorCo4===void 0?null:_useFloorplanEditorCo4;var elementRef=useRef(null);var onRoomOccupiedTilesMessageEvent=useCallback(function(event){var parser=event.getParser();setOriginalFloorplanSettings(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.reservedTiles=parser.blockedTilesMap;FloorplanEditor.instance.setTilemap(newValue.tilemap,newValue.reservedTiles);return newValue;});setOccupiedTilesReceived(true);elementRef.current.scrollTo(FloorplanEditor.instance.view.width/3,0);},[setOriginalFloorplanSettings]);UseMessageEventHook(RoomOccupiedTilesMessageEvent,onRoomOccupiedTilesMessageEvent);var onRoomEntryTileMessageEvent=useCallback(function(event){var parser=event.getParser();setOriginalFloorplanSettings(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.entryPoint=[parser.x,parser.y];newValue.entryPointDir=parser.direction;return newValue;});setVisualizationSettings(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.entryPointDir=parser.direction;return newValue;});FloorplanEditor.instance.doorLocation=new NitroPoint(parser.x,parser.y);setEntryTileReceived(true);},[setOriginalFloorplanSettings,setVisualizationSettings]);UseMessageEventHook(RoomEntryTileMessageEvent,onRoomEntryTileMessageEvent);var onClickArrowButton=function onClickArrowButton(scrollDirection){var element=elementRef.current;if(!element)return;switch(scrollDirection){case'up':element.scrollBy({top:-10});break;case'down':element.scrollBy({top:10});break;case'left':element.scrollBy({left:-10});break;case'right':element.scrollBy({left:10});break;}};useEffect(function(){return function(){FloorplanEditor.instance.clear();setVisualizationSettings(function(prevValue){return{wallHeight:originalFloorplanSettings.wallHeight,thicknessWall:originalFloorplanSettings.thicknessWall,thicknessFloor:originalFloorplanSettings.thicknessFloor,entryPointDir:prevValue.entryPointDir};});};},[originalFloorplanSettings.thicknessFloor,originalFloorplanSettings.thicknessWall,originalFloorplanSettings.wallHeight,setVisualizationSettings]);useEffect(function(){if(!entryTileReceived||!occupiedTilesReceived)return;FloorplanEditor.instance.renderTiles();},[entryTileReceived,occupiedTilesReceived]);useEffect(function(){SendMessageComposer(new GetRoomEntryTileMessageComposer());SendMessageComposer(new GetOccupiedTilesMessageComposer());FloorplanEditor.instance.tilemapRenderer.interactive=true;if(!elementRef.current)return;elementRef.current.appendChild(FloorplanEditor.instance.renderer.view);},[]);return/*#__PURE__*/_jsxs(Column,_objectSpread(_objectSpread({gap:gap},rest),{},{children:[/*#__PURE__*/_jsxs(Grid,{overflow:\"hidden\",gap:1,children:[/*#__PURE__*/_jsx(Column,{center:true,size:1,children:/*#__PURE__*/_jsx(Button,{className:\"d-md-none\",onClick:function onClick(event){return onClickArrowButton('left');},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"arrow-left\"})})}),/*#__PURE__*/_jsxs(Column,{overflow:\"hidden\",size:10,gap:1,children:[/*#__PURE__*/_jsx(Flex,{justifyContent:\"center\",className:\"d-md-none\",children:/*#__PURE__*/_jsx(Button,{shrink:true,onClick:function onClick(event){return onClickArrowButton('up');},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"arrow-up\"})})}),/*#__PURE__*/_jsx(Base,{overflow:\"auto\",innerRef:elementRef}),/*#__PURE__*/_jsx(Flex,{justifyContent:\"center\",className:\"d-md-none\",children:/*#__PURE__*/_jsx(Button,{shrink:true,onClick:function onClick(event){return onClickArrowButton('down');},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"arrow-down\"})})})]}),/*#__PURE__*/_jsx(Column,{center:true,size:1,children:/*#__PURE__*/_jsx(Button,{className:\"d-md-none\",onClick:function onClick(event){return onClickArrowButton('right');},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"arrow-right\"})})})]}),children]}));};","map":null,"metadata":{},"sourceType":"module"}