{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Luis/Downloads/Habboom/Nitro-Edit/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Disposable}from'../core/common/disposable/Disposable';import{RoomObjectModel}from'./object/RoomObjectModel';export var RoomInstance=/*#__PURE__*/function(_Disposable){_inherits(RoomInstance,_Disposable);var _super=_createSuper(RoomInstance);function RoomInstance(id,container){var _this;_classCallCheck(this,RoomInstance);_this=_super.call(this);_this._id=void 0;_this._container=void 0;_this._renderer=void 0;_this._managers=void 0;_this._updateCategories=void 0;_this._model=void 0;_this._id=id;_this._container=container;_this._renderer=null;_this._managers=new Map();_this._updateCategories=[];_this._model=new RoomObjectModel();return _this;}_createClass(RoomInstance,[{key:\"onDispose\",value:function onDispose(){this.removeAllManagers();this.destroyRenderer();this._container=null;this._model.dispose();}},{key:\"setRenderer\",value:function setRenderer(renderer){if(renderer===this._renderer)return;if(this._renderer)this.destroyRenderer();this._renderer=renderer;if(!this._renderer)return;this._renderer.reset();if(this._managers.size){var _iterator=_createForOfIteratorHelper(this._managers.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var manager=_step.value;if(!manager)continue;var objects=manager.objects;if(!objects.length)continue;var _iterator2=_createForOfIteratorHelper(objects.getValues()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var object=_step2.value;if(!object)continue;this._renderer.addObject(object);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}catch(err){_iterator.e(err);}finally{_iterator.f();}}}},{key:\"destroyRenderer\",value:function destroyRenderer(){if(!this._renderer)return;this._renderer.dispose();this._renderer=null;}},{key:\"getManager\",value:function getManager(category){var manager=this._managers.get(category);if(!manager)return null;return manager;}},{key:\"getManagerOrCreate\",value:function getManagerOrCreate(category){var manager=this.getManager(category);if(manager)return manager;manager=this._container.createRoomObjectManager(category);if(!manager)return null;this._managers.set(category,manager);return manager;}},{key:\"getTotalObjectsForManager\",value:function getTotalObjectsForManager(category){var manager=this.getManager(category);if(!manager)return 0;return manager.totalObjects;}},{key:\"getRoomObject\",value:function getRoomObject(id,category){var manager=this.getManager(category);if(!manager)return null;var object=manager.getObject(id);if(!object)return null;return object;}},{key:\"getRoomObjectsForCategory\",value:function getRoomObjectsForCategory(category){var manager=this.getManager(category);return manager?manager.objects.getValues():[];}},{key:\"getRoomObjectByIndex\",value:function getRoomObjectByIndex(index,category){var manager=this.getManager(category);if(!manager)return null;var object=manager.getObjectByIndex(index);if(!object)return null;return object;}},{key:\"createRoomObject\",value:function createRoomObject(id,stateCount,type,category){var manager=this.getManagerOrCreate(category);if(!manager)return null;var object=manager.createObject(id,stateCount,type);if(!object)return null;if(this._renderer)this._renderer.addObject(object);return object;}},{key:\"createRoomObjectAndInitalize\",value:function createRoomObjectAndInitalize(objectId,type,category){if(!this._container)return null;return this._container.createRoomObjectAndInitalize(this._id,objectId,type,category);}},{key:\"removeRoomObject\",value:function removeRoomObject(id,category){var manager=this.getManager(category);if(!manager)return;var object=manager.getObject(id);if(!object)return;object.tearDown();if(this._renderer)this._renderer.removeObject(object);manager.removeObject(id);}},{key:\"removeAllManagers\",value:function removeAllManagers(){var _iterator3=_createForOfIteratorHelper(this._managers.values()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var manager=_step3.value;if(!manager)continue;if(this._renderer){var objects=manager.objects;if(objects.length){var _iterator4=_createForOfIteratorHelper(objects.getValues()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var object=_step4.value;if(!object)continue;this._renderer.removeObject(object);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}}manager.dispose();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}this._managers.clear();}},{key:\"addUpdateCategory\",value:function addUpdateCategory(category){var index=this._updateCategories.indexOf(category);if(index>=0)return;this._updateCategories.push(category);}},{key:\"removeUpdateCategory\",value:function removeUpdateCategory(category){var index=this._updateCategories.indexOf(category);if(index===-1)return;this._updateCategories.splice(index,1);}},{key:\"update\",value:function update(time){var _update=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var _iterator5=_createForOfIteratorHelper(this._updateCategories),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var category=_step5.value;var manager=this.getManager(category);if(!manager)continue;var objects=manager.objects;if(!objects.length)continue;var _iterator6=_createForOfIteratorHelper(objects.getValues()),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var object=_step6.value;if(!object)continue;var logic=object.logic;logic&&logic.update(time);}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}this._renderer&&this._renderer.update(time,_update);}},{key:\"hasUninitializedObjects\",value:function hasUninitializedObjects(){var _iterator7=_createForOfIteratorHelper(this._managers.values()),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var manager=_step7.value;if(!manager)continue;var _iterator8=_createForOfIteratorHelper(manager.objects.getValues()),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var object=_step8.value;if(!object)continue;if(!object.isReady)return true;}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}return false;}},{key:\"id\",get:function get(){return this._id;}},{key:\"container\",get:function get(){return this._container;}},{key:\"renderer\",get:function get(){return this._renderer;}},{key:\"managers\",get:function get(){return this._managers;}},{key:\"model\",get:function get(){return this._model;}}]);return RoomInstance;}(Disposable);","map":null,"metadata":{},"sourceType":"module"}