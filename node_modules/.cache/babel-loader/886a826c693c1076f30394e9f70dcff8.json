{"ast":null,"code":"import _classCallCheck from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Administrator/Desktop/nitro/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Nitro}from'../../../../Nitro';import{ObjectDataUpdateMessage}from'../../../messages/ObjectDataUpdateMessage';import{RoomObjectVariable}from'../../RoomObjectVariable';import{FurnitureMultiStateLogic}from'./FurnitureMultiStateLogic';export var FurnitureVoteCounterLogic=/*#__PURE__*/function(_FurnitureMultiStateL){_inherits(FurnitureVoteCounterLogic,_FurnitureMultiStateL);var _super=_createSuper(FurnitureVoteCounterLogic);function FurnitureVoteCounterLogic(){var _this;_classCallCheck(this,FurnitureVoteCounterLogic);_this=_super.call(this);_this._total=void 0;_this._lastUpdate=void 0;_this._interval=void 0;_this._total=0;_this._lastUpdate=0;_this._interval=33;return _this;}_createClass(FurnitureVoteCounterLogic,[{key:\"processUpdateMessage\",value:function processUpdateMessage(message){_get(_getPrototypeOf(FurnitureVoteCounterLogic.prototype),\"processUpdateMessage\",this).call(this,message);if(message instanceof ObjectDataUpdateMessage){var stuffData=message.data;if(!stuffData)return;this.updateTotal(stuffData.result);}}},{key:\"updateTotal\",value:function updateTotal(k){this._total=k;if(!this._lastUpdate){this.object.model.setValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT,k);this._lastUpdate=Nitro.instance.time;return;}if(this._total!==this.currentTotal){var difference=Math.abs(this._total-this.currentTotal);if(difference*FurnitureVoteCounterLogic.UPDATE_INTERVAL>FurnitureVoteCounterLogic.MAX_UPDATE_TIME){this._interval=FurnitureVoteCounterLogic.MAX_UPDATE_TIME/difference;}else{this._interval=FurnitureVoteCounterLogic.UPDATE_INTERVAL;}this._lastUpdate=Nitro.instance.time;}}},{key:\"update\",value:function update(time){_get(_getPrototypeOf(FurnitureVoteCounterLogic.prototype),\"update\",this).call(this,time);if(this.object){if(this.currentTotal!==this._total&&time>=this._lastUpdate+this._interval){var _local_2=time-this._lastUpdate;var _local_3=_local_2/this._interval;var _local_4=1;if(this._total<this.currentTotal)_local_4=-1;if(_local_3>_local_4*(this._total-this.currentTotal))_local_3=_local_4*(this._total-this.currentTotal);this.object.model.setValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+_local_4*_local_3);this._lastUpdate=time-(_local_2-_local_3*this._interval);}}}},{key:\"currentTotal\",get:function get(){return this.object.model.getValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT);}}]);return FurnitureVoteCounterLogic;}(FurnitureMultiStateLogic);FurnitureVoteCounterLogic.UPDATE_INTERVAL=33;FurnitureVoteCounterLogic.MAX_UPDATE_TIME=1000;","map":null,"metadata":{},"sourceType":"module"}