{"ast":null,"code":"import _objectSpread from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{GetMarketplaceConfigurationMessageComposer,MakeOfferMessageComposer,MarketplaceConfigurationEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{LocalizeText,NotificationUtilities,ProductTypeEnum,SendMessageComposer}from'../../../../../../api';import{Base,Button,Column,Grid,LayoutFurniImageView,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../../../common';import{CatalogPostMarketplaceOfferEvent}from'../../../../../../events';import{useCatalog,UseMessageEventHook,UseUiEvent}from'../../../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var MarketplacePostOfferView=function MarketplacePostOfferView(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),item=_useState2[0],setItem=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),askingPrice=_useState4[0],setAskingPrice=_useState4[1];var _useCatalog=useCatalog(),_useCatalog$catalogOp=_useCatalog.catalogOptions,catalogOptions=_useCatalog$catalogOp===void 0?null:_useCatalog$catalogOp,_useCatalog$setCatalo=_useCatalog.setCatalogOptions,setCatalogOptions=_useCatalog$setCatalo===void 0?null:_useCatalog$setCatalo;var _catalogOptions$marke=catalogOptions.marketplaceConfiguration,marketplaceConfiguration=_catalogOptions$marke===void 0?null:_catalogOptions$marke;var onMarketplaceConfigurationEvent=useCallback(function(event){var parser=event.getParser();setCatalogOptions(function(prevValue){var newValue=_objectSpread({},prevValue);newValue.marketplaceConfiguration=parser;return newValue;});},[setCatalogOptions]);UseMessageEventHook(MarketplaceConfigurationEvent,onMarketplaceConfigurationEvent);var onCatalogPostMarketplaceOfferEvent=useCallback(function(event){setItem(event.item);},[]);UseUiEvent(CatalogPostMarketplaceOfferEvent.POST_MARKETPLACE,onCatalogPostMarketplaceOfferEvent);useEffect(function(){if(!item||marketplaceConfiguration)return;SendMessageComposer(new GetMarketplaceConfigurationMessageComposer());},[item,marketplaceConfiguration]);useEffect(function(){if(!item)return;return function(){return setAskingPrice(0);};},[item]);if(!marketplaceConfiguration||!item)return null;var getFurniTitle=item?LocalizeText(item.isWallItem?'wallItem.name.'+item.type:'roomItem.name.'+item.type):'';var getFurniDescription=item?LocalizeText(item.isWallItem?'wallItem.desc.'+item.type:'roomItem.desc.'+item.type):'';var postItem=function postItem(){if(!item||askingPrice<=marketplaceConfiguration.minimumPrice)return;NotificationUtilities.confirm(LocalizeText('inventory.marketplace.confirm_offer.info',['furniname','price'],[getFurniTitle,askingPrice.toString()]),function(){SendMessageComposer(new MakeOfferMessageComposer(askingPrice,item.isWallItem?2:1,item.id));setItem(null);},function(){setItem(null);},null,null,LocalizeText('inventory.marketplace.confirm_offer.title'));};return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-catalog-layout-marketplace-post-offer\",theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('inventory.marketplace.make_offer.title'),onCloseClick:function onCloseClick(event){return setItem(null);}}),/*#__PURE__*/_jsx(NitroCardContentView,{overflow:\"hidden\",children:/*#__PURE__*/_jsxs(Grid,{fullHeight:true,children:[/*#__PURE__*/_jsx(Column,{center:true,className:\"bg-muted rounded p-2\",size:4,overflow:\"hidden\",children:/*#__PURE__*/_jsx(LayoutFurniImageView,{productType:item.isWallItem?ProductTypeEnum.WALL:ProductTypeEnum.FLOOR,productClassId:item.type,extraData:item.extra.toString()})}),/*#__PURE__*/_jsxs(Column,{size:8,justifyContent:\"between\",overflow:\"hidden\",children:[/*#__PURE__*/_jsxs(Column,{grow:true,gap:1,children:[/*#__PURE__*/_jsx(Text,{fontWeight:\"bold\",children:getFurniTitle}),/*#__PURE__*/_jsx(Text,{truncate:true,shrink:true,children:getFurniDescription})]}),/*#__PURE__*/_jsxs(Column,{overflow:\"auto\",children:[/*#__PURE__*/_jsx(Text,{italics:true,children:LocalizeText('inventory.marketplace.make_offer.expiration_info',['time'],[marketplaceConfiguration.offerTime.toString()])}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group has-validation\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control form-control-sm\",type:\"number\",min:0,value:askingPrice,onChange:function onChange(event){return setAskingPrice(parseInt(event.target.value));},placeholder:LocalizeText('inventory.marketplace.make_offer.price_request')}),(askingPrice<marketplaceConfiguration.minimumPrice||isNaN(askingPrice))&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.min_price',['minprice'],[marketplaceConfiguration.minimumPrice.toString()])}),askingPrice>marketplaceConfiguration.maximumPrice&&!isNaN(askingPrice)&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.max_price',['maxprice'],[marketplaceConfiguration.maximumPrice.toString()])}),!(askingPrice<marketplaceConfiguration.minimumPrice||askingPrice>marketplaceConfiguration.maximumPrice||isNaN(askingPrice))&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.final_price',['commission','finalprice'],[marketplaceConfiguration.commission.toString(),(askingPrice+marketplaceConfiguration.commission).toString()])})]}),/*#__PURE__*/_jsx(Button,{disabled:askingPrice<marketplaceConfiguration.minimumPrice||askingPrice>marketplaceConfiguration.maximumPrice||isNaN(askingPrice),onClick:postItem,children:LocalizeText('inventory.marketplace.make_offer.post')})]})]})]})})]});};","map":null,"metadata":{},"sourceType":"module"}