{"ast":null,"code":"import _slicedToArray from\"/home/muphy/Documents/habboom/Nitro-Edit-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{CampaignCalendarDataMessageEvent,CampaignCalendarDoorOpenedMessageEvent,OpenCampaignCalendarDoorAsStaffComposer,OpenCampaignCalendarDoorComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{AddEventLinkTracker,CalendarItem,RemoveLinkEventTracker,SendMessageComposer}from'../../api';import{UseMessageEventHook}from'../../hooks';import{CalendarView}from'./CalendarView';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var CampaignView=function CampaignView(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),calendarData=_useState2[0],setCalendarData=_useState2[1];var _useState3=useState(-1),_useState4=_slicedToArray(_useState3,2),lastOpenAttempt=_useState4[0],setLastOpenAttempt=_useState4[1];var _useState5=useState(new Map()),_useState6=_slicedToArray(_useState5,2),receivedProducts=_useState6[0],setReceivedProducts=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isCalendarOpen=_useState8[0],setCalendarOpen=_useState8[1];var onCampaignCalendarDataMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;setCalendarData(parser.calendarData);},[]);UseMessageEventHook(CampaignCalendarDataMessageEvent,onCampaignCalendarDataMessageEvent);var onCampaignCalendarDoorOpenedMessageEvent=useCallback(function(event){var parser=event.getParser();if(!parser)return;var lastAttempt=lastOpenAttempt;if(parser.doorOpened){setCalendarData(function(prev){var copy=prev.clone();copy.openedDays.push(lastOpenAttempt);return copy;});setReceivedProducts(function(prev){var copy=new Map(prev);copy.set(lastAttempt,new CalendarItem(parser.productName,parser.customImage,parser.furnitureClassName));return copy;});}setLastOpenAttempt(-1);},[lastOpenAttempt]);UseMessageEventHook(CampaignCalendarDoorOpenedMessageEvent,onCampaignCalendarDoorOpenedMessageEvent);var openPackage=useCallback(function(id){var asStaff=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!calendarData)return;setLastOpenAttempt(id);if(asStaff){SendMessageComposer(new OpenCampaignCalendarDoorAsStaffComposer(calendarData.campaignName,id));}else{SendMessageComposer(new OpenCampaignCalendarDoorComposer(calendarData.campaignName,id));}},[calendarData]);var onCalendarClose=useCallback(function(){setCalendarOpen(false);},[]);var onLinkReceived=useCallback(function(link){var value=link.split('/');if(value.length<2)return;switch(value[1]){case'calendar':setCalendarOpen(true);break;}},[]);useEffect(function(){var linkTracker={linkReceived:onLinkReceived,eventUrlPrefix:'openView/'};AddEventLinkTracker(linkTracker);return function(){RemoveLinkEventTracker(linkTracker);};},[onLinkReceived]);return/*#__PURE__*/_jsx(_Fragment,{children:calendarData&&isCalendarOpen&&/*#__PURE__*/_jsx(CalendarView,{close:onCalendarClose,campaignName:calendarData.campaignName,currentDay:calendarData.currentDay,numDays:calendarData.campaignDays,openedDays:calendarData.openedDays,missedDays:calendarData.missedDays,openPackage:openPackage,receivedProducts:receivedProducts})});};","map":null,"metadata":{},"sourceType":"module"}